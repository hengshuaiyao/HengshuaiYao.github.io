<!DOCTYPE html>
<!-- saved from url=(0080)http://docplayer.net/docview/55/37218908/#file=/storage/55/37218908/37218908.pdf -->
<html dir="ltr" mozdisallowselectionprint="" moznomarginboxes=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="google" content="notranslate">
    <title>DocPlayer</title>
    <link rel="stylesheet" href="./total(1).css"><link rel="stylesheet" href="./font-awesome.min.css">
    <link rel="resource" type="application/l10n" href="http://docplayer.net/static/player/locale/locale.properties">
    <script src="./ca-pub-8693394182295906.js"></script><script src="./total(2).js"></script>
</head>

  <body tabindex="1" class="loadingInProgress">
    <div id="outerContainer">

      <div id="sidebarContainer">
        <div id="toolbarSidebar">
          <div class="splitToolbarButton toggled">
            <button id="viewThumbnail" class="toolbarButton group toggled" title="Show Thumbnails" tabindex="2" data-l10n-id="thumbs">
               <span data-l10n-id="thumbs_label">Thumbnails</span>
            </button>
            <button id="viewOutline" class="toolbarButton group" title="Show Document Outline" tabindex="3" data-l10n-id="outline" disabled="">
               <span data-l10n-id="outline_label">Document Outline</span>
            </button>
            <button id="viewAttachments" class="toolbarButton group" title="Show Attachments" tabindex="4" data-l10n-id="attachments" disabled="">
               <span data-l10n-id="attachments_label">Attachments</span>
            </button>
          </div>
        </div>
        <div id="sidebarContent">
          <div id="thumbnailView">
          <a href="http://docplayer.net/docview/55/37218908/#page=1" title="Page 1"><div id="thumbnailContainer1" class="thumbnail selected"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=2" title="Page 2"><div id="thumbnailContainer2" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=3" title="Page 3"><div id="thumbnailContainer3" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=4" title="Page 4"><div id="thumbnailContainer4" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=5" title="Page 5"><div id="thumbnailContainer5" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=6" title="Page 6"><div id="thumbnailContainer6" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=7" title="Page 7"><div id="thumbnailContainer7" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=8" title="Page 8"><div id="thumbnailContainer8" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a><a href="http://docplayer.net/docview/55/37218908/#page=9" title="Page 9"><div id="thumbnailContainer9" class="thumbnail"><div class="thumbnailSelectionRing" style="width: 100px; height: 128px;"></div></div></a></div>
          <div id="outlineView" class="hidden"></div>
          <div id="attachmentsView" class="hidden"></div>
        </div>
      </div>  <!-- sidebarContainer -->

      <div id="mainContainer">
        <div class="findbar hidden doorHanger hiddenSmallView" id="findbar">
          <label for="findInput" class="toolbarLabel" data-l10n-id="find_label">Find:</label>
          <input id="findInput" class="toolbarField" tabindex="91">
          <div class="splitToolbarButton">
            <button class="toolbarButton findPrevious" title="Find the previous occurrence of the phrase" id="findPrevious" tabindex="92" data-l10n-id="find_previous">
              <span data-l10n-id="find_previous_label">Previous</span>
            </button>
            <div class="splitToolbarButtonSeparator"></div>
            <button class="toolbarButton findNext" title="Find the next occurrence of the phrase" id="findNext" tabindex="93" data-l10n-id="find_next">
              <span data-l10n-id="find_next_label">Next</span>
            </button>
          </div>
          <input type="checkbox" id="findHighlightAll" class="toolbarField">
          <label for="findHighlightAll" class="toolbarLabel" tabindex="94" data-l10n-id="find_highlight">Highlight all</label>
          <input type="checkbox" id="findMatchCase" class="toolbarField">
          <label for="findMatchCase" class="toolbarLabel" tabindex="95" data-l10n-id="find_match_case_label">Match case</label>
          <span id="findMsg" class="toolbarLabel"></span>
        </div>  <!-- findbar -->

        <div id="secondaryToolbar" class="secondaryToolbar doorHangerRight hidden">
          <div id="secondaryToolbarButtonContainer" style="max-height: 646px;">
            <button id="secondaryPresentationMode" class="secondaryToolbarButton presentationMode visibleLargeView" title="Switch to Presentation Mode" tabindex="51" data-l10n-id="presentation_mode">
              <span data-l10n-id="presentation_mode_label">Presentation Mode</span>
            </button>

            <button id="secondaryOpenFile" class="secondaryToolbarButton openFile visibleLargeView" title="Open File" tabindex="52" data-l10n-id="open_file">
              <span data-l10n-id="open_file_label">Open</span>
            </button>

            <button id="secondaryPrint" class="secondaryToolbarButton print visibleMediumView" title="Print" tabindex="53" data-l10n-id="print">
              <span data-l10n-id="print_label">Print</span>
            </button>

            <button id="secondaryDownload" class="secondaryToolbarButton download visibleMediumView" title="Download" tabindex="54" data-l10n-id="download">
              <span data-l10n-id="download_label">Download</span>
            </button>

            <a href="http://docplayer.net/docview/55/37218908/#page=6&amp;zoom=page-width,-7,761" id="secondaryViewBookmark" class="secondaryToolbarButton bookmark visibleSmallView" title="Current view (copy or open in new window)" tabindex="55" data-l10n-id="bookmark">
              <span data-l10n-id="bookmark_label">Current View</span>
            </a>

            <div class="horizontalToolbarSeparator visibleLargeView"></div>

            <button id="firstPage" class="secondaryToolbarButton firstPage" title="Go to First Page" tabindex="56" data-l10n-id="first_page">
              <span data-l10n-id="first_page_label">Go to First Page</span>
            </button>
            <button id="lastPage" class="secondaryToolbarButton lastPage" title="Go to Last Page" tabindex="57" data-l10n-id="last_page">
              <span data-l10n-id="last_page_label">Go to Last Page</span>
            </button>

            <div class="horizontalToolbarSeparator"></div>

            <button id="pageRotateCw" class="secondaryToolbarButton rotateCw" title="Rotate Clockwise" tabindex="58" data-l10n-id="page_rotate_cw">
              <span data-l10n-id="page_rotate_cw_label">Rotate Clockwise</span>
            </button>
            <button id="pageRotateCcw" class="secondaryToolbarButton rotateCcw" title="Rotate Counterclockwise" tabindex="59" data-l10n-id="page_rotate_ccw">
              <span data-l10n-id="page_rotate_ccw_label">Rotate Counterclockwise</span>
            </button>

            <div class="horizontalToolbarSeparator"></div>

            <button id="toggleHandTool" class="secondaryToolbarButton handTool" title="Enable hand tool" tabindex="60" data-l10n-id="hand_tool_enable">
              <span data-l10n-id="hand_tool_enable_label">Enable hand tool</span>
            </button>

            <div class="horizontalToolbarSeparator"></div>

            <button id="documentProperties" class="secondaryToolbarButton documentProperties" title="Document Properties…" tabindex="61" data-l10n-id="document_properties">
              <span data-l10n-id="document_properties_label">Document Properties…</span>
            </button>
          </div>
        </div>  <!-- secondaryToolbar -->

        <div class="toolbar">
          <div id="toolbarContainer">
            <div id="toolbarViewer">
              <div id="toolbarViewerLeft">
                <button id="sidebarToggle" class="toolbarButton" title="Toggle Sidebar" tabindex="11" data-l10n-id="toggle_sidebar">
                  <span data-l10n-id="toggle_sidebar_label">Toggle Sidebar</span>
                </button>
                <div class="toolbarButtonSpacer"></div>
                <button id="viewFind" class="toolbarButton group hiddenSmallView" title="Find in Document" tabindex="12" data-l10n-id="findbar">
                   <span data-l10n-id="findbar_label">Find</span>
                </button>
                <div class="splitToolbarButton">
                  <button class="toolbarButton pageUp" title="Previous Page" id="previous" tabindex="13" data-l10n-id="previous">
                    <span data-l10n-id="previous_label">Previous</span>
                  </button>
                  <div class="splitToolbarButtonSeparator"></div>
                  <button class="toolbarButton pageDown" title="Next Page" id="next" tabindex="14" data-l10n-id="next">
                    <span data-l10n-id="next_label">Next</span>
                  </button>
                </div>
                <label id="pageNumberLabel" class="toolbarLabel" for="pageNumber" data-l10n-id="page_label">Page:</label>
                <input type="number" id="pageNumber" class="toolbarField pageNumber" value="1" size="4" min="1" tabindex="15" max="9">
                <span id="numPages" class="toolbarLabel">of 9</span>
              </div>
              <div id="toolbarViewerRight">
                <button id="presentationMode" class="toolbarButton presentationMode hiddenLargeView" title="Switch to Presentation Mode" tabindex="31" data-l10n-id="presentation_mode">
                  <span data-l10n-id="presentation_mode_label">Presentation Mode</span>
                </button>

                <button id="openFile" class="toolbarButton openFile hiddenLargeView" title="Open File" tabindex="32" data-l10n-id="open_file">
                  <span data-l10n-id="open_file_label">Open</span>
                </button>

                <button id="print" class="toolbarButton print hiddenMediumView" title="Print" tabindex="33" data-l10n-id="print">
                  <span data-l10n-id="print_label">Print</span>
                </button>

                <button id="download" class="toolbarButton download hiddenMediumView" title="Download" tabindex="34" data-l10n-id="download">
                  <span data-l10n-id="download_label">Download</span>
                </button>
                <a href="http://docplayer.net/docview/55/37218908/#page=6&amp;zoom=page-width,-7,761" id="viewBookmark" class="toolbarButton bookmark hiddenSmallView" title="Current view (copy or open in new window)" tabindex="35" data-l10n-id="bookmark">
                  <span data-l10n-id="bookmark_label">Current View</span>
                </a>

                <div class="verticalToolbarSeparator hiddenSmallView"></div>

                <button id="secondaryToolbarToggle" class="toolbarButton" title="Tools" tabindex="36" data-l10n-id="tools">
                  <span data-l10n-id="tools_label">Tools</span>
                </button>
              </div>
              <div class="outerCenter">
                <div class="innerCenter" id="toolbarViewerMiddle">
                  <div class="splitToolbarButton">
                    <button id="zoomOut" class="toolbarButton zoomOut" title="Zoom Out" tabindex="21" data-l10n-id="zoom_out">
                      <span data-l10n-id="zoom_out_label">Zoom Out</span>
                    </button>
                    <div class="splitToolbarButtonSeparator"></div>
                    <button id="zoomIn" class="toolbarButton zoomIn" title="Zoom In" tabindex="22" data-l10n-id="zoom_in">
                      <span data-l10n-id="zoom_in_label">Zoom In</span>
                     </button>
                  </div>
                  <span id="scaleSelectContainer" class="dropdownToolbarButton" style="min-width: 124px; max-width: 124px;">
                     <select id="scaleSelect" title="Zoom" tabindex="23" data-l10n-id="zoom" style="min-width: 146px;">
                      <option id="pageAutoOption" title="" value="auto" selected="selected" data-l10n-id="page_scale_auto">Automatic Zoom</option>
                      <option id="pageActualOption" title="" value="page-actual" data-l10n-id="page_scale_actual">Actual Size</option>
                      <option id="pageFitOption" title="" value="page-fit" data-l10n-id="page_scale_fit">Page Fit</option>
                      <option id="pageWidthOption" title="" value="page-width" data-l10n-id="page_scale_width">Page Width</option>
                      <option id="customScaleOption" title="" value="custom"></option>
                      <option title="" value="0.5" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 50 }">50%</option>
                      <option title="" value="0.75" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 75 }">75%</option>
                      <option title="" value="1" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 100 }">100%</option>
                      <option title="" value="1.25" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 125 }">125%</option>
                      <option title="" value="1.5" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 150 }">150%</option>
                      <option title="" value="2" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 200 }">200%</option>
                      <option title="" value="3" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 300 }">300%</option>
                      <option title="" value="4" data-l10n-id="page_scale_percent" data-l10n-args="{ &quot;scale&quot;: 400 }">400%</option>
                    </select>
                  </span>
                </div>
              </div>
            </div>
            <div id="loadingBar" class="">
              <div class="progress" style="height: 100%; width: 80%;">
                <div class="glimmer">
                </div>
              </div>
            </div>
          </div>
        </div>

        <menu type="context" id="viewerContextMenu">
          <menuitem id="contextFirstPage" label="First Page" data-l10n-id="first_page" title="Go to First Page"></menuitem>
          <menuitem id="contextLastPage" label="Last Page" data-l10n-id="last_page" title="Go to Last Page"></menuitem>
          <menuitem id="contextPageRotateCw" label="Rotate Clockwise" data-l10n-id="page_rotate_cw" title="Rotate Clockwise"></menuitem>
          <menuitem id="contextPageRotateCcw" label="Rotate Counter-Clockwise" data-l10n-id="page_rotate_ccw" title="Rotate Counterclockwise"></menuitem>
        </menu>

        <div id="viewerContainer" tabindex="0">
          <div id="viewer" class="pdfViewer"><div id="pageContainer1" class="page" data-page-number="1" data-loaded="true" style="width: 843px; height: 1090px;"><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page1" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"><div data-canvas-width="464.1109787683482" style="left: 179.014px; top: 125.345px; font-size: 19.7612px; font-family: serif; transform: scaleX(1.20763);">Off-policy Learning with Linear Action Models:</div><div data-canvas-width="455.0464879876707" style="left: 183.641px; top: 149.974px; font-size: 19.7612px; font-family: serif; transform: scaleX(1.2012);">An Efficient “One-Collection-For-All” Solution</div><div data-canvas-width="102.97474210535867" style="left: 76.3656px; top: 216.682px; font-size: 13.723px; font-family: serif; transform: scaleX(1.23176);">Hengshuai Yao</div><div data-canvas-width="178.45782998792674" style="left: 548.941px; top: 216.613px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.11805);">hengshua@cs.ualberta.ca</div><div data-canvas-width="207.2966140061977" style="left: 76.3656px; top: 235.5px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08596);">Department of Computing Science</div><div data-canvas-width="127.46985028450347" style="left: 76.3656px; top: 251.864px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08624);">University of Alberta</div><div data-canvas-width="150.11701755018134" style="left: 76.3656px; top: 268.393px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0942);">Edmonton, AB, T6G2E8</div><div data-canvas-width="70.93360239904753" style="left: 202.155px; top: 323.193px; font-size: 16.4677px; font-family: serif; transform: scaleX(1.27209);">Abstract</div><div data-canvas-width="267.6107840599067" style="left: 103.805px; top: 351.537px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10889);">We propose a model-based off-policy learn-</div><div data-canvas-width="267.6458718357871" style="left: 103.805px; top: 367.9px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1151);">ing method that can be used to evaluate any</div><div data-canvas-width="267.64413875202536" style="left: 103.805px; top: 384.43px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11274);">target policy using data collected from arbi-</div><div data-canvas-width="267.45764354201333" style="left: 103.805px; top: 400.959px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17978);">trary sources. The key of this method is a</div><div data-canvas-width="267.6301630624721" style="left: 103.805px; top: 417.323px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15541);">set of linear action models (LAM) learned</div><div data-canvas-width="267.4536086913712" style="left: 103.805px; top: 433.853px; font-size: 13.723px; font-family: serif; transform: scaleX(1.2102);">from data.  The method is simple to use.</div><div data-canvas-width="267.6284590029575" style="left: 103.805px; top: 450.382px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16807);">First, a target policy tells what actions are</div><div data-canvas-width="267.62399990427906" style="left: 103.805px; top: 466.747px; font-size: 13.723px; font-family: serif; transform: scaleX(1.21119);">taken at some features and LAM project</div><div data-canvas-width="267.50431838739433" style="left: 103.805px; top: 483.276px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07191);">what would happen for the actions. Second, a</div><div data-canvas-width="267.48038038235933" style="left: 103.805px; top: 499.64px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05936);">convergent off-policy learning algorithm such</div><div data-canvas-width="267.63907028139033" style="left: 103.805px; top: 516.17px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13665);">as LSTD and gradient TD algorithms eval-</div><div data-canvas-width="267.44257187493577" style="left: 103.805px; top: 532.699px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17777);">uates the projected experience.  We focus</div><div data-canvas-width="267.4827583121576" style="left: 103.805px; top: 549.063px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14262);">on two off-policy learning algorithms with</div><div data-canvas-width="267.46683051899265" style="left: 103.805px; top: 565.593px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15641);">LAM, i.e., the stochastic LAM-LSTD and</div><div data-canvas-width="267.6295765393906" style="left: 103.805px; top: 582.122px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09586);">the deterministic LAM-LSTD. Empirical re-</div><div data-canvas-width="267.7848702584442" style="left: 103.805px; top: 598.486px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16342);">sults show that the two LAM-LSTD algo-</div><div data-canvas-width="267.6301741918643" style="left: 103.805px; top: 615.016px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06235);">rithms give more accurate predictions for var-</div><div data-canvas-width="267.47863342459596" style="left: 103.805px; top: 631.379px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09452);">ious target policies than the on-policy LSTD</div><div data-canvas-width="267.6511669013948" style="left: 103.805px; top: 647.909px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10921);">learning. LAM based off-policy learning al-</div><div data-canvas-width="267.4645750262308" style="left: 103.805px; top: 664.438px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10369);">gorithms are also exclusively useful in diffi-</div><div data-canvas-width="267.45411427591426" style="left: 103.805px; top: 680.803px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07503);">cult control tasks where one could not collect</div><div data-canvas-width="267.6239864556919" style="left: 103.805px; top: 697.332px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10441);">sufficient “on-policy samples” for on-policy</div><div data-canvas-width="267.4632388816395" style="left: 103.805px; top: 713.861px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10723);">learning. This work leads us to advocate us-</div><div data-canvas-width="267.4878201957296" style="left: 103.805px; top: 730.226px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06803);">ing off-policy learning to evaluate many poli-</div><div data-canvas-width="267.6604811733697" style="left: 103.805px; top: 746.755px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06604);">cies in place of on-policy learning, improving</div><div data-canvas-width="164.8091175329212" style="left: 103.805px; top: 763.119px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08419);">the efficiency of using data.</div><div data-canvas-width="122.69845117683012" style="left: 76.3656px; top: 815.605px; font-size: 16.4677px; font-family: serif; transform: scaleX(1.25423);">1. Introduction</div><div data-canvas-width="114.07850232292212" style="left: 76.3656px; top: 843.452px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.999452);">Off-policy  learning</div><div data-canvas-width="208.28031160825736" style="left: 190.419px; top: 843.452px; font-size: 13.723px; font-family: serif; transform: scaleX(1.23965);">, which aims to evaluate a pol-</div><div data-canvas-width="322.5017959955521" style="left: 76.3656px; top: 859.982px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16775);">icy based on the data generated/collected from an-</div><div data-canvas-width="322.7031326685075" style="left: 76.3656px; top: 876.346px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1545);">other policy, is an interesting problem in reinforce-</div><div data-canvas-width="128.94672745274943" style="left: 76.3656px; top: 892.875px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13197);">ment learning (RL) (</div><div data-canvas-width="49.268627886675425" style="left: 205.295px; top: 892.875px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10393);">Watkins</div><div style="left: 254.718px; top: 892.875px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769407507327777" style="left: 263.809px; top: 892.875px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">1989</div><div style="left: 291.248px; top: 892.875px; font-size: 13.723px; font-family: serif;">;</div><div data-canvas-width="94.573886979932" style="left: 300.505px; top: 892.875px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12793);">Sutton &amp; Barto</div><div style="left: 394.888px; top: 892.875px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769424386677105" style="left: 76.3656px; top: 909.404px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">1998</div><div style="left: 103.805px; top: 909.404px; font-size: 13.723px; font-family: serif;">;</div><div data-canvas-width="114.57949284780749" style="left: 113.723px; top: 909.404px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0975);">Lagoudakis &amp; Parr</div><div style="left: 227.941px; top: 909.404px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76939076520893" style="left: 237.858px; top: 909.404px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2003</div><div data-canvas-width="133.58214095265558" style="left: 265.297px; top: 909.404px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10483);">).  Off-policy learning</div><div data-canvas-width="73.38440741981358" style="left: 76.3656px; top: 941.343px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.13214);">Appearing in</div><div data-canvas-width="246.7749513214199" style="left: 154.715px; top: 941.763px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.12946);">Planning and Acting with Uncertain Models</div><div data-canvas-width="113.08527750276586" style="left: 76.3656px; top: 955.483px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.0735);">Workshop  at  the  28</div><div data-canvas-width="9.921431587087211" style="left: 191.08px; top: 953.479px; font-size: 8.23382px; font-family: sans-serif; transform: scaleX(1.4455);">th</div><div data-canvas-width="33.39597564016831" style="left: 207.774px; top: 955.483px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.08165);">ICML</div><div data-canvas-width="160.1336894858933" style="left: 241.164px; top: 955.063px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.14511);">, Bellevue, WA, USA, 2011.</div><div data-canvas-width="237.69265525321333" style="left: 76.3653px; top: 968.782px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.13665);">Copyright 2011 by the author(s)/owner(s).</div><div data-canvas-width="322.53358075722963" style="left: 423.483px; top: 324.428px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11388);">is a very important way of increasing our knowledge</div><div data-canvas-width="322.52592193773256" style="left: 423.483px; top: 340.958px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14351);">about the world.  The amazing feature of off-policy</div><div data-canvas-width="322.71530901942236" style="left: 423.483px; top: 357.322px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11605);">learning is that a single stream of data from arbitrary</div><div data-canvas-width="322.357469722925" style="left: 423.483px; top: 373.851px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12958);">sources can provide us knowledge about many poli-</div><div data-canvas-width="322.5159198803033" style="left: 423.483px; top: 390.381px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07248);">cies. Therefore off-policy learning is an important way</div><div data-canvas-width="259.8652233431836" style="left: 423.483px; top: 406.744px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06731);">of improving the efficiency of using sample.</div><div data-canvas-width="322.40504313978136" style="left: 423.483px; top: 431.539px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07513);">Though charming in definition, learning many policies</div><div data-canvas-width="322.5060594447316" style="left: 423.483px; top: 447.903px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09384);">from a single-stream of data has rarely been practiced</div><div data-canvas-width="322.3676294170095" style="left: 423.483px; top: 464.432px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09974);">in RL, mainly because off-policy learning has pitfalls</div><div data-canvas-width="322.39738264607234" style="left: 423.483px; top: 480.962px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14343);">and is inherently hard. The difficulty lies in that the</div><div data-canvas-width="322.5578605347809" style="left: 423.483px; top: 497.326px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16445);">distribution of the data is from the policy that gen-</div><div data-canvas-width="322.46235441794227" style="left: 423.483px; top: 513.855px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16591);">erates/collects the data, which causes many RL al-</div><div data-canvas-width="130.42930794728798" style="left: 423.483px; top: 530.22px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13207);">gorithms to diverge (</div><div data-canvas-width="94.73982676534561" style="left: 553.901px; top: 530.219px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12991);">Sutton &amp; Barto</div><div style="left: 648.449px; top: 530.219px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76954185597" style="left: 658.036px; top: 530.219px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">1998</div><div data-canvas-width="60.502111041744676" style="left: 685.475px; top: 530.219px; font-size: 13.723px; font-family: serif; transform: scaleX(1.22824);">). Impor-</div><div data-canvas-width="322.32846988921017" style="left: 423.484px; top: 546.749px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12796);">tance sampling was first proposed to correct the dis-</div><div data-canvas-width="241.2392618104482" style="left: 423.484px; top: 563.278px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08543);">tribution of data for off-policy learning (</div><div data-canvas-width="77.37004396148376" style="left: 664.648px; top: 563.278px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13461);">Precup et al.</div><div style="left: 742.005px; top: 563.278px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769407370097298" style="left: 423.484px; top: 579.642px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2001</div><div data-canvas-width="295.0682861538516" style="left: 450.922px; top: 579.642px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19972);">).  However, it has a high variance in estima-</div><div data-canvas-width="322.5225223269932" style="left: 423.483px; top: 596.172px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15385);">tion.  Recently, several proposed gradient temporal</div><div data-canvas-width="322.70068851127854" style="left: 423.483px; top: 612.701px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09812);">difference (TD) methods with linear function approx-</div><div data-canvas-width="322.5348589219423" style="left: 423.483px; top: 629.065px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0858);">imation are proved to converge for off-policy learning</div><div style="left: 423.483px; top: 645.595px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="75.56199475533161" style="left: 428.773px; top: 645.595px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14615);">Sutton et al.</div><div style="left: 504.312px; top: 645.595px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769407370097298" style="left: 512.742px; top: 645.595px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2009</div><div data-canvas-width="9.095767288233107" style="left: 540.181px; top: 645.595px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">).</div><div data-canvas-width="322.3795229770693" style="left: 423.483px; top: 670.223px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07382);">In this paper, we study off-policy learning in an offline</div><div data-canvas-width="322.3196015202417" style="left: 423.483px; top: 686.753px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1464);">setting, in which a data set of samples are collected</div><div data-canvas-width="322.40353263013895" style="left: 423.483px; top: 703.282px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13778);">before hand using an arbitrary policy. We propose a</div><div data-canvas-width="322.38085227385955" style="left: 423.483px; top: 719.646px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08162);">general approach for off-policy learning, which stands</div><div data-canvas-width="322.3849131845704" style="left: 423.483px; top: 736.176px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10396);">out from existing off-policy learning solutions in that</div><div data-canvas-width="322.493774448444" style="left: 423.483px; top: 752.54px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12111);">it is model-based. The key component of this frame-</div><div data-canvas-width="322.5154104670296" style="left: 423.483px; top: 769.069px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08107);">work is a set of approximate action models with linear</div><div data-canvas-width="243.37254819294412" style="left: 423.483px; top: 785.599px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07726);">function approximation, which are called</div><div data-canvas-width="74.8850038505688" style="left: 670.763px; top: 785.599px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.01224);">linear action</div><div data-canvas-width="82.15933184673379" style="left: 423.483px; top: 801.963px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.00715);">models(LAM)</div><div data-canvas-width="233.60924973623432" style="left: 512.246px; top: 801.963px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15674);">for short.  LAM belong to the family</div><div data-canvas-width="322.5171629002893" style="left: 423.483px; top: 818.492px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09221);">of linear models. Boyan built a compressed model for</div><div data-canvas-width="322.5383176790195" style="left: 423.483px; top: 835.022px; font-size: 13.723px; font-family: serif; transform: scaleX(1.163);">the prediction problem, and gave a new interpreta-</div><div data-canvas-width="175.25141006146777" style="left: 423.483px; top: 851.386px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11362);">tion for the previous LSTD (</div><div data-canvas-width="102.16183708792181" style="left: 598.695px; top: 851.386px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11721);">Bradtke &amp; Barto</div><div style="left: 700.516px; top: 851.386px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76954185597" style="left: 709.277px; top: 851.386px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">1996</div><div data-canvas-width="9.09583453116946" style="left: 736.716px; top: 851.386px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">),</div><div data-canvas-width="222.35706050199283" style="left: 423.484px; top: 867.915px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12236);">and extended it to eligibility traces (</div><div data-canvas-width="37.85692288663722" style="left: 645.804px; top: 867.915px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05685);">Boyan</div><div style="left: 683.326px; top: 867.915px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76954185597" style="left: 692.086px; top: 867.915px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2002</div><div data-canvas-width="26.286268004419323" style="left: 719.525px; top: 867.915px; font-size: 13.723px; font-family: serif; transform: scaleX(1.32695);">). It</div><div data-canvas-width="322.3601368110725" style="left: 423.484px; top: 884.28px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17504);">was shown that the fixed points of model-free and</div><div data-canvas-width="322.5445458707381" style="left: 423.484px; top: 900.809px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07305);">model-based value function approximation are equiva-</div><div data-canvas-width="215.53684564137413" style="left: 423.484px; top: 917.338px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10718);">lent given the same set of features (</div><div data-canvas-width="61.83695928542255" style="left: 639.027px; top: 917.338px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16783);">Parr et al.</div><div style="left: 700.682px; top: 917.338px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76954185597" style="left: 709.277px; top: 917.338px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2008</div><div data-canvas-width="9.09583453116946" style="left: 736.716px; top: 917.338px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">).</div><div data-canvas-width="322.3303910061787" style="left: 423.484px; top: 933.703px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12436);">LAM differs from these models in that it models the</div><div data-canvas-width="322.70486112760193" style="left: 423.484px; top: 950.232px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10524);">effects of actions with linear function approximation.</div><div data-canvas-width="322.54655344291047" style="left: 423.484px; top: 966.761px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1533);">LAM was first explored in a linear Dyna algorithm</div></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="13" style="width: 36.756px; height: 10.959px; left: 148.044px; top: 645.717px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -148.044px -645.717px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.watkinsthesis" class="internalLink"></a></section><section class="annotLink" data-annotation-id="14" style="width: 21.156px; height: 10.959px; left: 190.524px; top: 645.717px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -190.524px -645.717px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.watkinsthesis" class="internalLink"></a></section><section class="annotLink" data-annotation-id="15" style="width: 69.636px; height: 10.959px; left: 217.164px; top: 645.717px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -217.164px -645.717px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.sutton98book" class="internalLink"></a></section><section class="annotLink" data-annotation-id="16" style="width: 21.1563px; height: 10.959px; left: 54.4437px; top: 657.717px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -54.4437px -657.717px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.sutton98book" class="internalLink"></a></section><section class="annotLink" data-annotation-id="17" style="width: 84.1563px; height: 10.959px; left: 81.5637px; top: 657.717px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -81.5637px -657.717px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lspi03" class="internalLink"></a></section><section class="annotLink" data-annotation-id="18" style="width: 21.156px; height: 10.959px; left: 171.684px; top: 657.717px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -171.684px -657.717px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lspi03" class="internalLink"></a></section><section class="annotLink" data-annotation-id="19" style="width: 69.756px; height: 10.959px; left: 401.124px; top: 382.437px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -401.124px -382.437px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.sutton98book" class="internalLink"></a></section><section class="annotLink" data-annotation-id="20" style="width: 21.156px; height: 10.959px; left: 476.724px; top: 382.437px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -476.724px -382.437px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.sutton98book" class="internalLink"></a></section><section class="annotLink" data-annotation-id="21" style="width: 57.156px; height: 10.959px; left: 481.524px; top: 406.437px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -481.524px -406.437px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.off01" class="internalLink"></a></section><section class="annotLink" data-annotation-id="22" style="width: 21.156px; height: 10.959px; left: 306.444px; top: 418.317px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -306.444px -418.317px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.off01" class="internalLink"></a></section><section class="annotLink" data-annotation-id="23" style="width: 55.836px; height: 10.959px; left: 310.284px; top: 466.197px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -310.284px -466.197px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.gtdc" class="internalLink"></a></section><section class="annotLink" data-annotation-id="24" style="width: 21.156px; height: 10.959px; left: 371.244px; top: 466.197px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -371.244px -466.197px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.gtdc" class="internalLink"></a></section><section class="annotLink" data-annotation-id="25" style="width: 75.156px; height: 10.959px; left: 433.644px; top: 615.597px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -433.644px -615.597px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.bradtke96" class="internalLink"></a></section><section class="annotLink" data-annotation-id="26" style="width: 21.156px; height: 10.959px; left: 513.924px; top: 615.597px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -513.924px -615.597px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.bradtke96" class="internalLink"></a></section><section class="annotLink" data-annotation-id="27" style="width: 28.476px; height: 10.959px; left: 467.844px; top: 627.597px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -467.844px -627.597px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.boyan02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="28" style="width: 21.156px; height: 10.959px; left: 501.444px; top: 627.597px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -501.444px -627.597px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.boyan02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="29" style="width: 45.876px; height: 10.959px; left: 462.924px; top: 663.477px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -462.924px -663.477px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.equivalence" class="internalLink"></a></section><section class="annotLink" data-annotation-id="30" style="width: 21.156px; height: 10.959px; left: 513.924px; top: 663.477px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -513.924px -663.477px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.equivalence" class="internalLink"></a></section></div></div><div style="vertical-align: top; text-align: center; width: 100%; margin-top: 10px; z-index: 1000;"><script type="text/javascript" src="./adsbygoogle.js"></script><ins class="adsbygoogle" data-ad-client="ca-pub-8693394182295906" data-ad-slot="9574338674" data-ad-format="auto" data-adsbygoogle-status="done" style="display: block; height: 90px;"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><iframe width="863" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" src="./saved_resource(12).html"></iframe></ins></ins></ins><script type="text/javascript">(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div id="pageContainer2" class="page" data-page-number="2" data-loaded="true" style="width: 843px; height: 1090px;"><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page2" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"><div data-canvas-width="195.55732606144917" style="left: 313.398px; top: 65.9021px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.24041);">Off-policy Learning with LAM</div><div data-canvas-width="200.909192139664" style="left: 76.3656px; top: 95.8265px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12432);">for online planning and control (</div><div data-canvas-width="75.56199475533161" style="left: 277.198px; top: 95.8265px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14615);">Sutton et al.</div><div style="left: 352.738px; top: 95.8265px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769407370097298" style="left: 362.159px; top: 95.8265px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2008</div><div data-canvas-width="9.095767288233107" style="left: 389.598px; top: 95.8265px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">).</div><div data-canvas-width="322.42459694653513" style="left: 76.3659px; top: 112.191px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14353);">In their algorithm, learning, modeling and planning</div><div data-canvas-width="322.5202071252486" style="left: 76.3659px; top: 128.72px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12021);">proceed simultaneously. Action selection in learning</div><div data-canvas-width="322.5491540977815" style="left: 76.3659px; top: 145.25px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11978);">and planning is performed according to LAM. How-</div><div data-canvas-width="322.5369349584024" style="left: 76.3659px; top: 161.614px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09161);">ever, their paper focused mainly on the on-policy pre-</div><div data-canvas-width="322.39908320620964" style="left: 76.3659px; top: 178.143px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10602);">diction problem, and LAM were only briefly studied.</div><div data-canvas-width="322.5145874546579" style="left: 76.3659px; top: 194.673px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12571);">They also used a gradient descent algorithm to learn</div><div data-canvas-width="322.51082744922576" style="left: 76.3659px; top: 211.037px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12554);">LAM, which is slow and requires tuning a step-size.</div><div data-canvas-width="322.33950124387246" style="left: 76.3659px; top: 227.566px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15108);">The gradient descent method is problematic also in</div><div data-canvas-width="322.3533065068896" style="left: 76.3659px; top: 243.931px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1481);">that the induced LAM can be biased because of the</div><div data-canvas-width="200.14940528183072" style="left: 76.3659px; top: 260.46px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09234);">choice of the step-size parameter.</div><div data-canvas-width="322.386484981346" style="left: 76.3659px; top: 285.254px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14639);">Apparently LAM is policy-indepdent. It is this pol-</div><div data-canvas-width="322.53737229822667" style="left: 76.3659px; top: 301.618px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13335);">icy independence property that makes it suitable for</div><div data-canvas-width="322.18342017864927" style="left: 76.3659px; top: 318.147px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09638);">off-policy learning.  Because of policy independence,</div><div data-canvas-width="322.3343908630478" style="left: 76.3659px; top: 334.512px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04013);">LAM-based off-policy learning does not have to use im-</div><div data-canvas-width="322.84552196032223" style="left: 76.3659px; top: 351.041px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12843);">portance sampling to correct the behavior/collection</div><div data-canvas-width="322.3890419420315" style="left: 76.3659px; top: 367.57px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07237);">policy for the target policy. So LAM is free of the high</div><div data-canvas-width="322.3302577416572" style="left: 76.3659px; top: 383.935px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10892);">variance caused by importance sampling. Because of</div><div data-canvas-width="322.5272282346942" style="left: 76.3659px; top: 400.464px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1018);">policy independence, LAM-based off-policy learning</div><div data-canvas-width="322.34000866730406" style="left: 76.3659px; top: 416.993px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1777);">considers the target policy not at the time of mod-</div><div data-canvas-width="322.53813895003924" style="left: 76.3659px; top: 433.358px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10805);">eling, but only when learning is requested. This clear</div><div data-canvas-width="322.37132098559994" style="left: 76.3659px; top: 449.887px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09175);">separation of modeling from learning is the key to the</div><div data-canvas-width="322.4920328975616" style="left: 76.3659px; top: 466.251px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0759);">simplicity and effectiveness of the proposed off-policy</div><div data-canvas-width="322.3720133133836" style="left: 76.3659px; top: 482.78px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1186);">learning solution.  LAM-based off-policy learning is</div><div data-canvas-width="322.5152192226295" style="left: 76.3659px; top: 499.31px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1548);">simple to use. First, LAM are learned from a given</div><div data-canvas-width="322.3095502794074" style="left: 76.3659px; top: 515.674px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15403);">set of samples with some chosen features, using an</div><div data-canvas-width="322.3153689616436" style="left: 76.3659px; top: 532.203px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12213);">efficient least-squares method that can guarantee the</div><div data-canvas-width="322.5330805795677" style="left: 76.3659px; top: 548.733px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09039);">quality of LAM. Second, a target policy tells what ac-</div><div data-canvas-width="322.3517590136323" style="left: 76.3659px; top: 565.097px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08874);">tions are taken on some features. We then apply LAM</div><div data-canvas-width="322.51622447708183" style="left: 76.3659px; top: 581.626px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1052);">to project what would happen from these features ac-</div><div data-canvas-width="322.3798942266933" style="left: 76.3659px; top: 597.991px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14234);">cording to the policy. Third, we use an algorithm to</div><div data-canvas-width="322.5055395058802" style="left: 76.3659px; top: 614.52px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09247);">evaluate the projected experience. Notice the learning</div><div data-canvas-width="322.49485707344246" style="left: 76.3659px; top: 631.049px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05843);">is off-policy, so we need convergent off-policy learning</div><div data-canvas-width="322.35584542176684" style="left: 76.3659px; top: 647.414px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12348);">algorithms such as gradient TD algorithms or LSTD</div><div data-canvas-width="322.338018550849" style="left: 76.3659px; top: 663.943px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08582);">algorithm. We focus on the use of LSTD since it is ef-</div><div data-canvas-width="322.38193408919796" style="left: 76.3659px; top: 680.473px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09027);">ficient in using samples, and does not require tuning a</div><div data-canvas-width="322.48813236811566" style="left: 76.3659px; top: 696.836px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09845);">step-size. However, other learning algorithms such as</div><div data-canvas-width="322.5108976014482" style="left: 76.3659px; top: 713.366px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08398);">gradient TD can also be used to evaluate the projected</div><div data-canvas-width="322.34846362944444" style="left: 76.3659px; top: 729.73px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07913);">experience by LAM. The emphasis of this paper is not</div><div data-canvas-width="322.35162205761094" style="left: 76.3659px; top: 746.259px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12357);">on the comparisons between LSTD and gradient TD</div><div data-canvas-width="322.3214078576347" style="left: 76.3659px; top: 762.789px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08461);">since it is already well known that least-squares meth-</div><div data-canvas-width="178.83807529364006" style="left: 76.3659px; top: 779.153px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16493);">ods are more data efficient (</div><div data-canvas-width="102.16111841188572" style="left: 255.214px; top: 779.152px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1172);">Bradtke &amp; Barto</div><div style="left: 357.201px; top: 779.152px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769407370097298" style="left: 367.449px; top: 779.152px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">1996</div><div style="left: 394.888px; top: 779.152px; font-size: 13.723px; font-family: serif;">;</div><div data-canvas-width="37.856865112604154" style="left: 76.3656px; top: 795.682px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05684);">Boyan</div><div style="left: 113.888px; top: 795.682px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769416015617683" style="left: 122.318px; top: 795.682px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2002</div><div style="left: 149.756px; top: 795.682px; font-size: 13.723px; font-family: serif;">;</div><div data-canvas-width="53.06679025437837" style="left: 158.186px; top: 795.682px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13243);">Xu et al.</div><div style="left: 211.081px; top: 795.682px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76939076520893" style="left: 219.511px; top: 795.682px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2002</div><div data-canvas-width="9.095784167582435" style="left: 246.949px; top: 795.682px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">).</div><div data-canvas-width="322.34470263595273" style="left: 76.3659px; top: 820.311px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10535);">We demonstrate that off-policy learning can be much</div><div data-canvas-width="322.35966130745123" style="left: 76.3659px; top: 836.84px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13221);">more accurate than on-policy learning. Our two off-</div><div data-canvas-width="322.54578591282274" style="left: 76.3659px; top: 853.37px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07846);">policy learning algorithms perform very well in evalu-</div><div data-canvas-width="322.3843167260018" style="left: 76.3659px; top: 869.734px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14824);">ating various target policies. In particular, for those</div><div data-canvas-width="102.48746622196927" style="left: 76.3659px; top: 886.263px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17998);">policies that are</div><div data-canvas-width="81.51801579808873" style="left: 186.121px; top: 886.263px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.0181);">ill  distributed</div><div data-canvas-width="131.09690295538508" style="left: 267.611px; top: 886.263px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1704);">, according to which</div><div data-canvas-width="322.6292394743646" style="left: 76.3657px; top: 902.793px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08722);">some actions are rarely taken or some states are rarely</div><div data-canvas-width="322.53675861723264" style="left: 76.3657px; top: 919.156px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08397);">visited, the advantages of our algorithms are very pro-</div><div data-canvas-width="322.5527846674227" style="left: 76.3657px; top: 935.686px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14097);">nounced. Notice that the problem is inherently hard</div><div data-canvas-width="322.3231529216174" style="left: 76.3657px; top: 952.05px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1148);">because of the rareness caused by the nature of these</div><div data-canvas-width="322.35238280851286" style="left: 76.3657px; top: 968.579px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18337);">policies.  In a related rareness problem studied by</div><div data-canvas-width="85.93414790607254" style="left: 423.484px; top: 104.447px; font-size: 13.723px; font-family: serif; transform: scaleX(1.27396);">Algorithm 1</div><div data-canvas-width="230.4264816851377" style="left: 515.552px; top: 103.761px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12833);">Learning LAM from a set of samples</div><div data-canvas-width="170.25166690823218" style="left: 423.484px; top: 120.125px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09514);">using a least-squres method.</div><div data-canvas-width="42.805449345832635" style="left: 423.484px; top: 139.82px; font-size: 13.723px; font-family: serif; transform: scaleX(1.30614);">Input:</div><div data-canvas-width="62.97759531386675" style="left: 472.245px; top: 139.134px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15616);">a data set,</div><div style="left: 539.52px; top: 139.765px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 553.24px; top: 139.134px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 567.786px; top: 139.134px; font-size: 13.723px; font-family: sans-serif;">{</div><div data-canvas-width="22.48507195105825" style="left: 574.728px; top: 139.134px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.03464);">&lt; φ</div><div style="left: 597.208px; top: 144.646px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397330587585554" style="left: 601.836px; top: 139.134px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 615.225px; top: 144.646px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="14.220393597448835" style="left: 619.853px; top: 139.134px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.03647);">,φ</div><div style="left: 634.068px; top: 144.646px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880586416219911" style="left: 637.87px; top: 144.935px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div data-canvas-width="12.232434817240518" style="left: 652.582px; top: 139.134px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.4596);">,r</div><div style="left: 664.813px; top: 144.646px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 673.243px; top: 139.134px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div style="left: 683.987px; top: 139.134px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="20.504301852437507" style="left: 690.93px; top: 139.134px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12114);">, or</div><div style="left: 715.559px; top: 139.765px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 725.476px; top: 144.646px; font-size: 9.60614px; font-family: sans-serif;">s</div><div style="left: 735.063px; top: 139.134px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 423.484px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">{</div><div style="left: 430.426px; top: 155.663px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 435.715px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">s</div><div style="left: 442.162px; top: 161.176px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397336762957261" style="left: 446.625px; top: 155.663px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 460.014px; top: 161.176px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="12.568606820325215" style="left: 464.642px; top: 155.663px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17774);">,s</div><div style="left: 477.204px; top: 161.176px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 481.006px; top: 161.464px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div data-canvas-width="12.232440992612222" style="left: 495.552px; top: 155.663px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.4596);">,r</div><div style="left: 507.784px; top: 161.176px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 516.214px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div style="left: 526.958px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">}</div><div style="left: 533.9px; top: 155.663px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="54.872034949777934" style="left: 423.484px; top: 172.713px; font-size: 13.723px; font-family: serif; transform: scaleX(1.30886);">Output:</div><div data-canvas-width="83.64224508402293" style="left: 484.477px; top: 172.027px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08673);">a set of LAM,</div><div style="left: 572.744px; top: 172.027px; font-size: 13.723px; font-family: sans-serif;">{</div><div data-canvas-width="23.143237852712858" style="left: 579.687px; top: 172.027px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.14543);">&lt; F</div><div style="left: 604.812px; top: 170.598px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="12.901545124323741" style="left: 611.423px; top: 172.027px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.6923);">,f</div><div style="left: 625.804px; top: 170.598px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 636.217px; top: 172.027px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div style="left: 646.961px; top: 172.027px; font-size: 13.723px; font-family: sans-serif;">}</div><div style="left: 653.904px; top: 172.027px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="52.23913597915919" style="left: 423.484px; top: 188.557px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07142);">Initialize</div><div style="left: 480.345px; top: 188.557px; font-size: 13.723px; font-family: sans-serif;">H</div><div style="left: 492.907px; top: 187.127px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 499.519px; top: 188.557px; font-size: 13.723px; font-family: serif;">,</div><div style="left: 507.784px; top: 188.557px; font-size: 13.723px; font-family: sans-serif;">E</div><div style="left: 518.693px; top: 187.127px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="22.16163973980279" style="left: 529.933px; top: 188.557px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11874);">and</div><div style="left: 556.711px; top: 188.557px; font-size: 13.723px; font-family: sans-serif;">e</div><div style="left: 563.157px; top: 187.127px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="35.55495702193193" style="left: 574.232px; top: 188.557px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07284);">for all</div><div style="left: 614.233px; top: 188.557px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="19.174266487621484" style="left: 423.484px; top: 205.772px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19857);">for</div><div style="left: 447.286px; top: 205.086px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="21.325777517311415" style="left: 455.881px; top: 205.086px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18295);">= 1</div><div style="left: 477.204px; top: 205.086px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 483.319px; top: 205.086px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="37.52937266306732" style="left: 490.261px; top: 205.086px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.40614);">,...,d</div><div data-canvas-width="16.696268153062714" style="left: 532.41px; top: 205.772px; font-size: 13.723px; font-family: serif; transform: scaleX(1.21693);">do</div><div data-canvas-width="120.85358185009231" style="left: 437.203px; top: 221.45px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12476);">Read the transition:</div><div data-canvas-width="22.48507195105825" style="left: 564.149px; top: 221.45px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.03464);">&lt; φ</div><div style="left: 586.629px; top: 226.963px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397330587585554" style="left: 591.257px; top: 221.45px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 604.646px; top: 226.963px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="14.220393597448835" style="left: 609.274px; top: 221.45px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.03647);">,φ</div><div style="left: 623.489px; top: 226.963px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880586416219911" style="left: 627.291px; top: 227.251px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div data-canvas-width="12.232434817240518" style="left: 642.003px; top: 221.45px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.4596);">,r</div><div style="left: 654.235px; top: 226.963px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 662.665px; top: 221.45px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div data-canvas-width="9.245155019017695" style="left: 437.203px; top: 238.665px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10315);">if</div><div data-canvas-width="31.415072350562486" style="left: 450.923px; top: 237.979px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05664);">using</div><div style="left: 486.957px; top: 238.61px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 496.874px; top: 243.493px; font-size: 9.60614px; font-family: sans-serif;">s</div><div data-canvas-width="19.01043305288153" style="left: 450.923px; top: 254.509px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08434);">Set</div><div style="left: 474.56px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 482.659px; top: 260.022px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 491.089px; top: 254.509px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 505.635px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 513.735px; top: 254.509px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 519.024px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">s</div><div style="left: 525.471px; top: 260.022px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="9.095767288233107" style="left: 530.099px; top: 254.509px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">),</div><div style="left: 543.818px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 551.918px; top: 260.022px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880552785135956" style="left: 555.72px; top: 260.31px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 574.232px; top: 254.509px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 588.779px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 596.878px; top: 254.509px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 602.167px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">s</div><div style="left: 608.613px; top: 260.022px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880586416219911" style="left: 612.415px; top: 260.31px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 627.127px; top: 254.509px; font-size: 13.723px; font-family: serif;">)</div><div data-canvas-width="24.796164603453388" style="left: 437.204px; top: 271.559px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25173);">end</div><div data-canvas-width="16.54012394809472" style="left: 437.204px; top: 287.402px; font-size: 13.723px; font-family: serif; transform: scaleX(1.03391);">for</div><div style="left: 458.196px; top: 287.402px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 469.27px; top: 287.402px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 483.816px; top: 287.402px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 491.089px; top: 292.915px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="101.68372855755287" style="left: 495.553px; top: 287.402px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10277);">, update LAM of</div><div style="left: 601.672px; top: 287.402px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="14.555095862067532" style="left: 613.573px; top: 287.402px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06087);">by</div><div style="left: 437.204px; top: 303.767px; font-size: 13.723px; font-family: sans-serif;">H</div><div style="left: 449.766px; top: 302.337px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 460.18px; top: 303.767px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 474.726px; top: 303.767px; font-size: 13.723px; font-family: sans-serif;">H</div><div style="left: 487.288px; top: 302.337px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 496.875px; top: 303.767px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 510.595px; top: 303.767px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 518.694px; top: 309.279px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 523.322px; top: 303.767px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 531.422px; top: 302.337px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 531.422px; top: 310.932px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 437.204px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">E</div><div style="left: 448.113px; top: 318.867px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 458.527px; top: 320.296px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 473.073px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">E</div><div style="left: 483.982px; top: 318.867px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 493.734px; top: 320.296px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 507.454px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 515.554px; top: 325.809px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 519.356px; top: 326.097px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 534.066px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 542.166px; top: 318.867px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 542.166px; top: 327.462px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 437.204px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">e</div><div style="left: 443.651px; top: 335.396px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 454.064px; top: 336.825px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 468.61px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">e</div><div style="left: 475.057px; top: 335.396px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 484.643px; top: 336.825px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 498.363px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 506.463px; top: 342.338px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 511.09px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 517.207px; top: 342.338px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="24.796164603453388" style="left: 423.485px; top: 353.876px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25173);">end</div><div data-canvas-width="35.554822536059234" style="left: 423.485px; top: 369.719px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07284);">for all</div><div style="left: 463.485px; top: 369.719px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="177.52346558193088" style="left: 470.759px; top: 369.719px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07598);">, solve LAM by least-squares:</div><div style="left: 437.204px; top: 386.248px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 447.948px; top: 384.653px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 445.965px; top: 393.579px; font-size: 9.60614px; font-family: sans-serif;">d</div><div style="left: 458.362px; top: 386.248px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 472.908px; top: 386.248px; font-size: 13.723px; font-family: sans-serif;">E</div><div style="left: 483.817px; top: 384.653px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 490.429px; top: 386.248px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 495.718px; top: 386.248px; font-size: 13.723px; font-family: sans-serif;">H</div><div style="left: 508.281px; top: 384.653px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 514.892px; top: 386.248px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 520.182px; top: 386.44px; font-size: 9.60614px; font-family: sans-serif;">−</div><div style="left: 528.777px; top: 384.942px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 437.204px; top: 402.612px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 445.469px; top: 401.183px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 443.981px; top: 410.109px; font-size: 9.60614px; font-family: sans-serif;">d</div><div data-canvas-width="19.67439200211819" style="left: 455.883px; top: 402.612px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25025);">= (</div><div style="left: 475.552px; top: 402.612px; font-size: 13.723px; font-family: sans-serif;">H</div><div style="left: 488.115px; top: 401.183px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 494.892px; top: 402.612px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 500.181px; top: 402.97px; font-size: 9.60614px; font-family: sans-serif;">−</div><div style="left: 508.776px; top: 401.471px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 514.892px; top: 402.612px; font-size: 13.723px; font-family: sans-serif;">e</div><div style="left: 521.339px; top: 401.183px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 423.484px; top: 468.565px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="70.10246115915656" style="left: 428.773px; top: 468.565px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12884);">Frank et al.</div><div style="left: 498.858px; top: 468.565px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769407370097298" style="left: 508.445px; top: 468.565px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2008</div><div data-canvas-width="209.78595869426798" style="left: 535.884px; top: 468.565px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1262);">), rare events occur independently</div><div data-canvas-width="322.34320311847216" style="left: 423.484px; top: 485.094px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19325);">of actions.  The rareness we study in this paper is</div><div data-canvas-width="322.4772794954186" style="left: 423.484px; top: 501.624px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11219);">caused by the policies themselves, and is much more</div><div data-canvas-width="93.39232235809443" style="left: 423.484px; top: 517.988px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07959);">common in RL.</div><div data-canvas-width="140.5300578970634" style="left: 423.484px; top: 556.093px; font-size: 16.4677px; font-family: serif; transform: scaleX(1.20562);">2. Learning LAM</div><div data-canvas-width="227.94771892189993" style="left: 423.484px; top: 584.105px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10787);">Suppose the state space is denoted by</div><div style="left: 655.887px; top: 584.737px; font-size: 13.723px; font-family: sans-serif;">S</div><div data-canvas-width="82.49076139764018" style="left: 663.49px; top: 584.105px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09366);">, and we have</div><div style="left: 423.483px; top: 600.47px; font-size: 13.723px; font-family: sans-serif;">N</div><div data-canvas-width="278.33800371035676" style="left: 439.517px; top: 600.47px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08551);">states. First we are given a data set of samples,</div><div style="left: 721.343px; top: 601.101px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 735.063px; top: 600.47px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 423.483px; top: 616.999px; font-size: 13.723px; font-family: sans-serif;">{</div><div data-canvas-width="25.13029791049225" style="left: 430.425px; top: 616.999px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.15636);">&lt; φ</div><div style="left: 455.55px; top: 622.512px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397336762957261" style="left: 460.344px; top: 616.999px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 473.733px; top: 622.512px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="14.220433394288717" style="left: 478.196px; top: 616.999px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.03648);">,φ</div><div style="left: 492.411px; top: 622.512px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 496.213px; top: 622.8px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div data-canvas-width="12.232440992612222" style="left: 510.924px; top: 616.999px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.4596);">,r</div><div style="left: 523.156px; top: 622.512px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 534.23px; top: 616.999px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div style="left: 544.974px; top: 616.999px; font-size: 13.723px; font-family: sans-serif;">}</div><div style="left: 551.917px; top: 616.999px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 561.835px; top: 615.858px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="35.203166954881134" style="left: 574.232px; top: 616.999px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05034);">where</div><div style="left: 615.555px; top: 616.999px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 623.655px; top: 622.512px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="111.39688851267628" style="left: 634.399px; top: 616.999px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15579);">is some feature at</div><div data-canvas-width="76.04632847207158" style="left: 423.484px; top: 633.528px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07894);">which action</div><div style="left: 503.982px; top: 633.528px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 511.255px; top: 639.041px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="50.419503093099415" style="left: 520.346px; top: 633.528px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10274);">is taken,</div><div style="left: 575.224px; top: 633.528px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 583.323px; top: 639.041px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880586416219911" style="left: 587.125px; top: 639.329px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div data-canvas-width="139.36340798394508" style="left: 606.464px; top: 633.528px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10849);">is the resulting feature,</div><div data-canvas-width="22.16163973980279" style="left: 423.484px; top: 649.893px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11874);">and</div><div style="left: 452.245px; top: 649.893px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 458.361px; top: 655.405px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="145.3137416932499" style="left: 469.766px; top: 649.893px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15575);">is the resulting reward,</div><div style="left: 622.002px; top: 649.893px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="24.962569874663117" style="left: 634.069px; top: 649.893px; font-size: 13.723px; font-family: serif; transform: scaleX(1.38469);">= 1</div><div style="left: 659.028px; top: 649.893px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 665.144px; top: 649.893px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="37.52950989354968" style="left: 672.086px; top: 649.893px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.40615);">,...,d</div><div style="left: 709.607px; top: 649.893px; font-size: 13.723px; font-family: serif;">,</div><div style="left: 720.681px; top: 649.893px; font-size: 13.723px; font-family: sans-serif;">d</div><div style="left: 735.062px; top: 649.893px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 423.484px; top: 666.422px; font-size: 13.723px; font-family: sans-serif;">|</div><div style="left: 427.286px; top: 667.053px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 437.203px; top: 666.422px; font-size: 13.723px; font-family: sans-serif;">|</div><div data-canvas-width="304.79463369759134" style="left: 441.005px; top: 666.422px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08407);">. The samples can be collected from a single policy</div><div data-canvas-width="322.52389120105465" style="left: 423.484px; top: 682.951px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11186);">or many different policies, by a single agent or many</div><div data-canvas-width="322.5128101140657" style="left: 423.484px; top: 699.315px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16547);">different agents. There is no restriction on the data</div><div data-canvas-width="322.3556390820134" style="left: 423.484px; top: 715.844px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0617);">set. However, to guarantee the quality of LAM and off-</div><div data-canvas-width="322.37217809974663" style="left: 423.484px; top: 732.209px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11327);">policy learning, the data set should contain sufficient</div><div data-canvas-width="50.56941408371322" style="left: 423.484px; top: 748.738px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06168);">samples.</div><div data-canvas-width="322.7400707504276" style="left: 423.484px; top: 773.367px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08188);">LAM are learned using linear function approximation.</div><div data-canvas-width="35.217671530713424" style="left: 423.484px; top: 789.897px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05035);">Given</div><div style="left: 464.807px; top: 789.897px; font-size: 13.723px; font-family: sans-serif;">n</div><div style="left: 479.353px; top: 789.897px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 484.643px; top: 789.897px; font-size: 13.723px; font-family: sans-serif;">n</div><div style="left: 499.354px; top: 789.897px; font-size: 13.723px; font-family: sans-serif;">≤</div><div style="left: 516.545px; top: 789.897px; font-size: 13.723px; font-family: sans-serif;">N</div><div data-canvas-width="113.91240008955273" style="left: 529.107px; top: 789.897px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13269);">) feature functions</div><div style="left: 649.276px; top: 789.897px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 658.201px; top: 795.409px; font-size: 9.60614px; font-family: sans-serif;">j</div><div style="left: 666.301px; top: 789.897px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="15.70740004950427" style="left: 675.392px; top: 789.897px; font-size: 13.723px; font-family: serif; transform: scaleX(1.32993);">) :</div><div style="left: 697.707px; top: 790.528px; font-size: 13.723px; font-family: sans-serif;">S</div><div data-canvas-width="13.719416279625117" style="left: 711.757px; top: 789.897px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.642584);">7→</div><div style="left: 732.088px; top: 790.528px; font-size: 13.723px; font-family: sans-serif;">R</div><div style="left: 742.006px; top: 789.897px; font-size: 13.723px; font-family: serif;">,</div><div style="left: 423.484px; top: 806.426px; font-size: 13.723px; font-family: sans-serif;">j</div><div data-canvas-width="25.789048002310235" style="left: 438.195px; top: 806.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.43053);">= 1</div><div data-canvas-width="38.85508554215019" style="left: 463.981px; top: 806.426px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.45581);">,...,n</div><div data-canvas-width="135.88134354436824" style="left: 502.824px; top: 806.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.22594);">, the feature vector (</div><div data-canvas-width="40.17600770509412" style="left: 638.696px; top: 806.426px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.940579);">feature</div><div data-canvas-width="59.855157899726926" style="left: 686.135px; top: 806.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16367);">for short)</div><div data-canvas-width="46.27951729658752" style="left: 423.484px; top: 822.79px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15696);">of state</div><div style="left: 475.882px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="9.253432624482741" style="left: 486.792px; top: 822.79px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01118);">is</div><div style="left: 502.164px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 510.264px; top: 822.79px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 515.553px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="32.73589901481374" style="left: 520.347px; top: 822.79px; font-size: 13.723px; font-family: serif; transform: scaleX(1.37921);">) = [</div><div style="left: 553.075px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 562.001px; top: 828.591px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 568.282px; top: 822.79px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 573.571px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">i</div><div style="left: 578.365px; top: 822.79px; font-size: 13.723px; font-family: serif;">)</div><div data-canvas-width="15.042359312375225" style="left: 583.654px; top: 822.79px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.09638);">,φ</div><div style="left: 598.696px; top: 828.591px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 604.812px; top: 822.79px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 610.101px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">i</div><div style="left: 614.895px; top: 822.79px; font-size: 13.723px; font-family: serif;">)</div><div data-canvas-width="39.5173060556364" style="left: 620.184px; top: 822.79px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.3642);">,...,φ</div><div style="left: 659.689px; top: 828.303px; font-size: 9.60614px; font-family: sans-serif;">n</div><div style="left: 667.293px; top: 822.79px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 672.582px; top: 822.79px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="9.09583453116946" style="left: 677.376px; top: 822.79px; font-size: 13.723px; font-family: serif; transform: scaleX(0.995419);">)]</div><div style="left: 686.467px; top: 821.361px; font-size: 9.60614px; font-family: sans-serif;">T</div><div data-canvas-width="50.74115885576082" style="left: 695.062px; top: 822.79px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16796);">.  Let Φ</div><div data-canvas-width="254.8830538294568" style="left: 423.484px; top: 839.32px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1207);">be the feature matrix whose entries are Φ</div><div data-canvas-width="11.568807770438687" style="left: 678.368px; top: 844.832px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.66871);">i,j</div><div style="left: 696.219px; top: 839.32px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 711.757px; top: 839.32px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 720.683px; top: 844.832px; font-size: 9.60614px; font-family: sans-serif;">j</div><div style="left: 726.633px; top: 839.32px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 731.923px; top: 839.32px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="9.09583453116946" style="left: 736.716px; top: 839.32px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13714);">),</div><div style="left: 423.484px; top: 855.849px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="21.491497047800827" style="left: 432.245px; top: 855.849px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19215);">= 1</div><div data-canvas-width="41.66181531165572" style="left: 453.733px; top: 855.849px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.43823);">,...,N</div><div style="left: 496.873px; top: 855.849px; font-size: 13.723px; font-family: serif;">;</div><div style="left: 505.303px; top: 855.849px; font-size: 13.723px; font-family: sans-serif;">j</div><div data-canvas-width="21.65668137940906" style="left: 515.717px; top: 855.849px; font-size: 13.723px; font-family: serif; transform: scaleX(1.20131);">= 1</div><div data-canvas-width="38.68992865663843" style="left: 537.371px; top: 855.849px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.44962);">,...,n</div><div data-canvas-width="169.74719121489102" style="left: 576.048px; top: 855.849px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10513);">. We assume the columns of</div><div data-canvas-width="322.5247266327851" style="left: 423.483px; top: 872.213px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1227);">Φ are linearly independent. Each LAM is composed</div><div data-canvas-width="153.584908605972" style="left: 423.483px; top: 888.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15003);">of a matrix and a vector,</div><div data-canvas-width="24.300612294781093" style="left: 582px; top: 888.743px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20271);">&lt; F</div><div style="left: 608.282px; top: 887.313px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 606.298px; top: 895.578px; font-size: 9.60614px; font-family: sans-serif;">n</div><div style="left: 613.075px; top: 897.365px; font-size: 9.60614px; font-family: sans-serif;">×</div><div style="left: 621.67px; top: 895.578px; font-size: 9.60614px; font-family: sans-serif;">n</div><div data-canvas-width="12.901545124323741" style="left: 629.274px; top: 888.743px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.6923);">,f</div><div style="left: 643.655px; top: 887.313px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 642.167px; top: 895.578px; font-size: 9.60614px; font-family: sans-serif;">n</div><div style="left: 648.944px; top: 897.365px; font-size: 9.60614px; font-family: sans-serif;">×</div><div style="left: 657.539px; top: 895.866px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 668.284px; top: 888.743px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div data-canvas-width="44.29741729736231" style="left: 679.028px; top: 888.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09712);">, where</div><div style="left: 728.451px; top: 888.743px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 739.194px; top: 887.313px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="253.10822670960823" style="left: 423.483px; top: 905.106px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10716);">approximates the transition dynamics and</div><div style="left: 680.846px; top: 905.106px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 689.11px; top: 903.677px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="46.13218665073342" style="left: 700.02px; top: 905.106px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08121);">approx-</div><div data-canvas-width="219.35963139803314" style="left: 423.482px; top: 921.636px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14016);">imates the rewards of taking action</div><div style="left: 648.778px; top: 921.636px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="83.98625857409975" style="left: 661.837px; top: 921.636px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16049);">in the feature</div><div style="left: 440.674px; top: 946.702px; font-size: 8.23382px; font-family: sans-serif;">1</div><div data-canvas-width="294.0580920173173" style="left: 451.749px; top: 948.286px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.19607);">Notice that the data set can also be the experience</div><div data-canvas-width="167.25830136350442" style="left: 423.483px; top: 962.005px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.14467);">of transitioning among states,</div><div style="left: 595.885px; top: 962.573px; font-size: 12.3507px; font-family: sans-serif;">D</div><div style="left: 604.812px; top: 966.868px; font-size: 8.23382px; font-family: sans-serif;">s</div><div style="left: 614.895px; top: 962.005px; font-size: 12.3507px; font-family: serif;">=</div><div style="left: 629.441px; top: 962.005px; font-size: 12.3507px; font-family: sans-serif;">{</div><div data-canvas-width="20.32910250694206" style="left: 635.722px; top: 962.833px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.20874);">&lt; s</div><div style="left: 656.053px; top: 966.868px; font-size: 8.23382px; font-family: sans-serif;">i</div><div data-canvas-width="12.550438176774842" style="left: 660.351px; top: 962.833px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(0.914029);">, a</div><div style="left: 672.913px; top: 966.868px; font-size: 8.23382px; font-family: sans-serif;">i</div><div data-canvas-width="11.567394766738825" style="left: 677.21px; top: 962.833px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(0.887246);">, s</div><div style="left: 688.781px; top: 966.868px; font-size: 8.23382px; font-family: sans-serif;">i</div><div data-canvas-width="12.72525381702594" style="left: 692.417px; top: 967.033px; font-size: 8.23382px; font-family: sans-serif; transform: scaleX(1.35616);">+1</div><div data-canvas-width="11.40271457390322" style="left: 705.806px; top: 962.833px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.03897);">, r</div><div style="left: 717.212px; top: 966.868px; font-size: 8.23382px; font-family: sans-serif;">i</div><div style="left: 726.138px; top: 962.833px; font-size: 12.3507px; font-family: sans-serif;">&gt;</div><div style="left: 736.055px; top: 962.005px; font-size: 12.3507px; font-family: sans-serif;">}</div><div style="left: 742.337px; top: 962.005px; font-size: 12.3507px; font-family: serif;">,</div><div data-canvas-width="32.390350565431056" style="left: 423.485px; top: 975.725px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.07362);">where</div><div style="left: 460.18px; top: 976.552px; font-size: 12.3507px; font-family: sans-serif;">s</div><div style="left: 466.131px; top: 980.587px; font-size: 8.23382px; font-family: sans-serif;">i</div><div data-canvas-width="11.567419468236668" style="left: 470.428px; top: 976.552px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(0.887248);">, s</div><div style="left: 481.999px; top: 980.587px; font-size: 8.23382px; font-family: sans-serif;">i</div><div data-canvas-width="12.725321005025142" style="left: 485.635px; top: 980.752px; font-size: 8.23382px; font-family: sans-serif; transform: scaleX(1.35617);">+1</div><div style="left: 502.66px; top: 975.725px; font-size: 12.3507px; font-family: sans-serif;">∈</div><div style="left: 514.561px; top: 976.293px; font-size: 12.3507px; font-family: sans-serif;">S</div><div style="left: 521.504px; top: 975.725px; font-size: 12.3507px; font-family: serif;">.</div></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="64" style="width: 55.836px; height: 10.959px; left: 200.244px; top: 67.077px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -200.244px -67.077px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lindyna2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="65" style="width: 21.156px; height: 10.959px; left: 261.924px; top: 67.077px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -261.924px -67.077px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lindyna2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="66" style="width: 75.156px; height: 10.959px; left: 184.284px; top: 563.157px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -184.284px -563.157px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.bradtke96" class="internalLink"></a></section><section class="annotLink" data-annotation-id="67" style="width: 21.156px; height: 10.959px; left: 265.764px; top: 563.157px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -265.764px -563.157px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.bradtke96" class="internalLink"></a></section><section class="annotLink" data-annotation-id="68" style="width: 28.4763px; height: 10.959px; left: 54.4437px; top: 575.157px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -54.4437px -575.157px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.boyan02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="69" style="width: 21.1563px; height: 10.959px; left: 87.8037px; top: 575.157px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -87.8037px -575.157px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.boyan02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="70" style="width: 39.516px; height: 10.959px; left: 113.844px; top: 575.157px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -113.844px -575.157px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.xu02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="71" style="width: 21.156px; height: 10.959px; left: 158.364px; top: 575.157px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -158.364px -575.157px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.xu02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="72" style="width: 51.876px; height: 10.959px; left: 310.284px; top: 337.677px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -310.284px -337.677px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.rarerl" class="internalLink"></a></section><section class="annotLink" data-annotation-id="73" style="width: 21.156px; height: 10.959px; left: 368.124px; top: 337.677px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -368.124px -337.677px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.rarerl" class="internalLink"></a></section><section class="annotLink" data-annotation-id="74" style="width: 5.436px; height: 10.959px; left: 406.884px; top: 445.437px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -406.884px -445.437px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#Hfootnote.1" class="internalLink"></a></section></div></div><div style="vertical-align: top; text-align: center; width: 100%; margin-top: 10px; z-index: 1000;"><script type="text/javascript" src="./adsbygoogle.js"></script><ins class="adsbygoogle" data-ad-client="ca-pub-8693394182295906" data-ad-slot="6481271478" data-ad-format="auto" data-adsbygoogle-status="done" style="display: block; height: 90px;"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><iframe width="863" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;" src="./saved_resource(13).html"></iframe></ins></ins></ins><script type="text/javascript">(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div id="pageContainer3" class="page" data-page-number="3" style="width: 843px; height: 1090px;" data-loaded="true"><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page3" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"><div data-canvas-width="195.55732606144917" style="left: 313.398px; top: 65.9021px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.24041);">Off-policy Learning with LAM</div><div data-canvas-width="84.9424321053287" style="left: 76.3656px; top: 104.447px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25926);">Algorithm 2</div><div data-canvas-width="232.57575923383527" style="left: 166.286px; top: 103.761px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09583);">The stochastic LAM-LSTD algorithm:</div><div data-canvas-width="322.53099029858345" style="left: 76.3656px; top: 120.125px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1222);">a simulation-based-projection on/off-policy learning</div><div data-canvas-width="310.97251201429515" style="left: 76.3656px; top: 136.654px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10152);">with the pre-learned LAM. No iteration is required.</div><div data-canvas-width="42.805399133199145" style="left: 76.3656px; top: 156.349px; font-size: 13.723px; font-family: serif; transform: scaleX(1.30614);">Input:</div><div data-canvas-width="137.5313061166899" style="left: 128.764px; top: 155.663px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1838);">a data set of features,</div><div style="left: 273.065px; top: 156.294px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 282.983px; top: 161.176px; font-size: 9.60614px; font-family: sans-serif;">φ</div><div style="left: 296.868px; top: 155.663px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 314.224px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">{</div><div style="left: 321.166px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 329.265px; top: 161.176px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 333.894px; top: 155.663px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="57.851698799306355" style="left: 340.836px; top: 155.663px; font-size: 13.723px; font-family: serif; transform: scaleX(1.24468);">, a set of</div><div data-canvas-width="35.21531843963252" style="left: 76.3654px; top: 172.027px; font-size: 13.723px; font-family: serif; transform: scaleX(1.03825);">LAM,</div><div style="left: 118.35px; top: 172.027px; font-size: 13.723px; font-family: sans-serif;">{</div><div data-canvas-width="26.945238831468178" style="left: 125.292px; top: 172.027px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.33361);">&lt; F</div><div style="left: 154.219px; top: 170.598px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="12.901514521926178" style="left: 160.831px; top: 172.027px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.69229);">,f</div><div style="left: 175.211px; top: 170.598px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 189.261px; top: 172.027px; font-size: 13.723px; font-family: sans-serif;">&gt;</div><div style="left: 200.005px; top: 172.027px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="78.19818422473315" style="left: 213.725px; top: 172.027px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10968);">learned from</div><div style="left: 298.686px; top: 172.659px; font-size: 13.723px; font-family: sans-serif;">D</div><div data-canvas-width="90.26769228903062" style="left: 308.604px; top: 172.027px; font-size: 13.723px; font-family: serif; transform: scaleX(1.27153);">; and a target</div><div data-canvas-width="35.87826600021423" style="left: 76.3654px; top: 188.557px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04622);">policy</div><div style="left: 116.697px; top: 188.557px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 124.962px; top: 188.557px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="54.87203510073146" style="left: 76.3654px; top: 205.772px; font-size: 13.723px; font-family: serif; transform: scaleX(1.30886);">Output:</div><div data-canvas-width="113.88465827511575" style="left: 144.301px; top: 205.086px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11576);">a parameter vector</div><div style="left: 262.652px; top: 205.086px; font-size: 13.723px; font-family: sans-serif;">θ</div><div data-canvas-width="56.881101081861715" style="left: 274.057px; top: 205.086px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05883);">for policy</div><div style="left: 335.381px; top: 205.086px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 343.646px; top: 205.086px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="19.17427499591139" style="left: 76.3651px; top: 222.136px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19857);">for</div><div style="left: 100.168px; top: 221.45px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="21.325789044671932" style="left: 108.763px; top: 221.45px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18295);">= 1</div><div style="left: 130.085px; top: 221.45px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 136.201px; top: 221.45px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="37.529424398959165" style="left: 143.143px; top: 221.45px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.40614);">,...,d</div><div data-canvas-width="16.696251410943866" style="left: 185.292px; top: 222.136px; font-size: 13.723px; font-family: serif; transform: scaleX(1.21693);">do</div><div data-canvas-width="30.7432590283914" style="left: 90.0846px; top: 237.979px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09056);">Read</div><div style="left: 125.293px; top: 237.979px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 133.392px; top: 243.493px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="95.37803663770254" style="left: 90.0848px; top: 254.509px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09813);">Select an action</div><div style="left: 189.923px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="74.06120405024576" style="left: 201.823px; top: 254.509px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08608);">according to</div><div style="left: 280.338px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">π</div><div data-canvas-width="12.233318169855425" style="left: 293.231px; top: 254.509px; font-size: 13.723px; font-family: serif; transform: scaleX(1.23551);">at</div><div style="left: 310.091px; top: 254.509px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 318.191px; top: 260.022px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="150.9546634258671" style="left: 131.243px; top: 270.873px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09448);">/* for on-policy learning,</div><div style="left: 286.454px; top: 270.873px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 297.529px; top: 270.873px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 312.075px; top: 270.873px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 319.348px; top: 276.386px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.884703685048647" style="left: 323.811px; top: 270.873px; font-size: 13.723px; font-family: serif; transform: scaleX(1.30106);">*/</div><div data-canvas-width="6.9423602821989885" style="left: 91.9034px; top: 283.766px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831031);"> ̃</div><div style="left: 90.0853px; top: 287.402px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 98.1848px; top: 292.915px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880620085728411" style="left: 101.987px; top: 293.203px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 120.499px; top: 287.402px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 135.046px; top: 287.402px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 145.789px; top: 285.973px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 152.401px; top: 287.402px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 160.501px; top: 292.915px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="6.9423602821989885" style="left: 90.7467px; top: 303.766px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831031);"> ̃</div><div style="left: 90.0854px; top: 303.766px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 96.2011px; top: 309.279px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 104.631px; top: 303.766px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 119.178px; top: 303.766px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 127.277px; top: 302.337px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 127.277px; top: 310.932px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 136.037px; top: 303.766px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 144.302px; top: 302.337px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 90.0854px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">A</div><div style="left: 104.135px; top: 320.296px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 118.682px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">A</div><div style="left: 132.07px; top: 320.296px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 145.79px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 153.889px; top: 325.809px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 158.517px; top: 320.296px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 163.807px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">γ</div><div data-canvas-width="6.942351911139566" style="left: 173.559px; top: 316.659px; font-size: 13.723px; font-family: serif; transform: scaleX(0.83103);"> ̃</div><div style="left: 171.741px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 179.84px; top: 325.809px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.880636848436637" style="left: 183.642px; top: 326.097px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 201.329px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 215.048px; top: 320.296px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 223.147px; top: 325.809px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 227.776px; top: 320.296px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 233.065px; top: 318.867px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 90.0854px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">b</div><div style="left: 99.8379px; top: 336.825px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 114.218px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">b</div><div style="left: 123.144px; top: 336.825px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 136.864px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 144.963px; top: 342.338px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="6.942351911139566" style="left: 150.253px; top: 336.825px; font-size: 13.723px; font-family: serif; transform: scaleX(0.83103);"> ̃</div><div style="left: 149.756px; top: 336.825px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 155.873px; top: 342.338px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="24.79615620494787" style="left: 76.3658px; top: 353.876px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25173);">end</div><div style="left: 76.3658px; top: 369.719px; font-size: 13.723px; font-family: sans-serif;">θ</div><div style="left: 86.9447px; top: 369.719px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 101.491px; top: 369.719px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 112.235px; top: 369.719px; font-size: 13.723px; font-family: sans-serif;">A</div><div style="left: 122.483px; top: 370.076px; font-size: 9.60614px; font-family: sans-serif;">−</div><div style="left: 131.078px; top: 368.578px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 137.194px; top: 369.719px; font-size: 13.723px; font-family: sans-serif;">b</div><div data-canvas-width="110.09082692888197" style="left: 76.3656px; top: 417.489px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12427);">space.  Algorithm</div><div style="left: 193.229px; top: 417.489px; font-size: 13.723px; font-family: serif;">1</div><div data-canvas-width="192.20616459047704" style="left: 206.783px; top: 417.489px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10874);">shows an efficient least-squares</div><div data-canvas-width="153.42730503716245" style="left: 76.3657px; top: 433.853px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08244);">method of learning LAM.</div><div data-canvas-width="316.33580898304166" style="left: 76.3657px; top: 471.958px; font-size: 16.4677px; font-family: serif; transform: scaleX(1.20901);">3. Off-policy Learning Algorithms with</div><div data-canvas-width="42.65275376147074" style="left: 97.0275px; top: 491.132px; font-size: 16.4677px; font-family: serif; transform: scaleX(1.16611);">LAM</div><div data-canvas-width="224.4363585601197" style="left: 76.3657px; top: 529.749px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25045);">3.1. A Simulation-based Method</div><div data-canvas-width="322.3553319601939" style="left: 76.3657px; top: 554.684px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17822);">The first algorithm, a simulation-based method, is</div><div data-canvas-width="118.04647133461354" style="left: 76.3657px; top: 571.213px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06807);">shown in Algorithm</div><div style="left: 198.353px; top: 571.212px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="193.60046761128123" style="left: 205.295px; top: 571.212px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12417);">. The algorithm is run on a data</div><div data-canvas-width="91.73686879620539" style="left: 76.3659px; top: 587.742px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14133);">set of features,</div><div style="left: 174.881px; top: 588.373px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 184.799px; top: 593.255px; font-size: 9.60614px; font-family: sans-serif;">φ</div><div style="left: 199.014px; top: 587.742px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 216.701px; top: 587.742px; font-size: 13.723px; font-family: sans-serif;">{</div><div style="left: 223.643px; top: 587.742px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 231.742px; top: 593.255px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 236.205px; top: 587.742px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="155.54561663730132" style="left: 243.148px; top: 587.742px; font-size: 13.723px; font-family: serif; transform: scaleX(1.23326);">.  Thus at this stage the</div><div data-canvas-width="322.34920762450446" style="left: 76.3659px; top: 604.106px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09363);">transitioning experience is no longer necessary. In the</div><div data-canvas-width="116.84264897149" style="left: 76.3659px; top: 620.635px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07609);">experiments, we set</div><div style="left: 197.196px; top: 621.266px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 207.114px; top: 626.148px; font-size: 9.60614px; font-family: sans-serif;">φ</div><div data-canvas-width="180.33043826311317" style="left: 218.519px; top: 620.635px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0958);">to be the set of features where</div><div data-canvas-width="322.33407821084" style="left: 76.3658px; top: 636.999px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08049);">the transitioning samples were collected from. That is,</div><div style="left: 76.3658px; top: 654.16px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 86.2835px; top: 659.041px; font-size: 9.60614px; font-family: sans-serif;">φ</div><div style="left: 97.6889px; top: 653.529px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 112.4px; top: 653.529px; font-size: 13.723px; font-family: sans-serif;">{</div><div style="left: 119.342px; top: 653.529px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 127.442px; top: 659.041px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 131.905px; top: 653.529px; font-size: 13.723px; font-family: sans-serif;">|</div><div style="left: 135.707px; top: 653.529px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 143.806px; top: 659.041px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 152.567px; top: 653.529px; font-size: 13.723px; font-family: sans-serif;">∈</div><div style="left: 165.79px; top: 654.16px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 175.708px; top: 653.529px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="216.23140978767745" style="left: 182.65px; top: 653.529px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12468);">. This, however, is not a constraint,</div><div data-canvas-width="164.62978171951178" style="left: 76.3658px; top: 670.058px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07242);">as one can choose freely for</div><div style="left: 245.46px; top: 670.689px; font-size: 13.723px; font-family: sans-serif;">D</div><div style="left: 255.379px; top: 675.571px; font-size: 9.60614px; font-family: sans-serif;">φ</div><div style="left: 262.652px; top: 670.058px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="70.912684912537" style="left: 76.3656px; top: 694.687px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17068);">Notice that</div><div style="left: 154.384px; top: 694.687px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 165.129px; top: 693.258px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 171.906px; top: 694.687px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="211.42912835771324" style="left: 187.278px; top: 694.687px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19619);">is the expected next feature, and</div><div style="left: 76.3656px; top: 711.216px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 84.4652px; top: 709.787px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 93.226px; top: 711.216px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 101.491px; top: 709.787px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="204.32122734262023" style="left: 114.714px; top: 711.216px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16343);">is the expected reward of taking</div><div style="left: 325.629px; top: 711.216px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="12.233318169855425" style="left: 339.679px; top: 711.216px; font-size: 13.723px; font-family: serif; transform: scaleX(1.23551);">at</div><div style="left: 358.523px; top: 711.216px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="32.067383739102" style="left: 366.623px; top: 711.216px; font-size: 13.723px; font-family: serif; transform: scaleX(1.305);">.  To</div><div data-canvas-width="322.36712630261513" style="left: 76.3648px; top: 727.581px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12559);">evaluate a policy with LAM, one follows the policy,</div><div data-canvas-width="122.66834025452674" style="left: 76.3648px; top: 744.11px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1028);">generating an action</div><div style="left: 203.311px; top: 744.11px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="69.59673979728095" style="left: 214.882px; top: 744.11px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14226);">at a feature</div><div style="left: 288.934px; top: 744.11px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="101.85010336359548" style="left: 297.033px; top: 744.11px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12793);">, and do the pro-</div><div data-canvas-width="322.54919430631304" style="left: 76.3655px; top: 760.639px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07568);">jection operation, which gives the imaginary transition</div><div data-canvas-width="66.44407050787878" style="left: 76.3655px; top: 777.003px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05738);">experience,</div><div data-canvas-width="36.87141562620685" style="left: 147.442px; top: 777.003px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.04003);">&lt; φ,φ</div><div style="left: 184.303px; top: 775.574px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 193.064px; top: 777.003px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 201.328px; top: 775.574px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="14.87856251817406" style="left: 207.94px; top: 777.003px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.2203);">,F</div><div style="left: 224.8px; top: 775.574px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="22.81616505399106" style="left: 231.412px; top: 777.003px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.04988);">φ &gt;</div><div data-canvas-width="144.6535051482931" style="left: 254.222px; top: 777.003px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13003);">. Notice that evaluating</div><div data-canvas-width="322.5306739823217" style="left: 76.366px; top: 793.533px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04993);">the imaginary experience is an off-policy learning prob-</div><div data-canvas-width="322.3101628076653" style="left: 76.366px; top: 810.062px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07445);">lem. To guarantee convergence and data efficiency, we</div><div data-canvas-width="269.8184692210887" style="left: 76.366px; top: 826.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08605);">use LSTD for policy evaluation in Algorithm</div><div style="left: 350.589px; top: 826.427px; font-size: 13.723px; font-family: serif;">2</div><div style="left: 357.531px; top: 826.427px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="132.91178228732053" style="left: 76.3659px; top: 851.221px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09692);">Notice that Algorithm</div><div style="left: 213.064px; top: 851.221px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="175.23084924371125" style="left: 223.643px; top: 851.221px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06221);">can also be used for on-policy</div><div data-canvas-width="214.26933669729397" style="left: 76.3659px; top: 867.585px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11728);">learning, in which the target policy</div><div style="left: 295.711px; top: 867.585px; font-size: 13.723px; font-family: sans-serif;">π</div><div data-canvas-width="89.75484578328077" style="left: 308.935px; top: 867.585px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1163);">is also the pol-</div><div data-canvas-width="244.61506743874182" style="left: 76.3659px; top: 884.114px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14446);">icy we used to collect the samples, i.e.,</div><div style="left: 327.613px; top: 884.114px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 335.878px; top: 884.114px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 341.167px; top: 884.114px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 349.266px; top: 889.627px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="22.484509580541562" style="left: 354.059px; top: 884.114px; font-size: 13.723px; font-family: serif; transform: scaleX(1.42882);">) =</div><div style="left: 382.986px; top: 884.114px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 390.259px; top: 889.627px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 394.887px; top: 884.114px; font-size: 13.723px; font-family: serif;">,</div><div style="left: 76.3657px; top: 900.644px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="22.483163486740164" style="left: 85.953px; top: 900.644px; font-size: 13.723px; font-family: serif; transform: scaleX(1.24716);">= 1</div><div style="left: 108.433px; top: 900.644px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 114.548px; top: 900.644px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="37.529424398959165" style="left: 121.491px; top: 900.644px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.40614);">,...,d</div><div data-canvas-width="239.88380067004576" style="left: 159.012px; top: 900.644px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13452);">. On-policy learning can then be based</div><div data-canvas-width="322.3335282322357" style="left: 76.3657px; top: 917.008px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10903);">on the projected experience under the action selected</div><div data-canvas-width="140.68874896842075" style="left: 76.3657px; top: 933.537px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09362);">according to the policy.</div><div data-canvas-width="208.97309822184565" style="left: 76.3657px; top: 958.166px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10268);">For off-policy learning, Algorithm</div><div style="left: 291.909px; top: 958.166px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="93.3928316341375" style="left: 305.298px; top: 958.166px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19582);">can be used to</div><div data-canvas-width="322.5462553096876" style="left: 76.3659px; top: 974.695px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0915);">evaluate a target policy known beforehand, or a target</div><div data-canvas-width="87.91799292811136" style="left: 423.484px; top: 104.447px; font-size: 13.723px; font-family: serif; transform: scaleX(1.30337);">Algorithm 3</div><div data-canvas-width="226.94936782148872" style="left: 519.189px; top: 103.761px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13025);">The deterministic LAM-LSTD algo-</div><div data-canvas-width="322.5370084727717" style="left: 423.484px; top: 120.125px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09335);">rithm: an analytical-projection based off-policy learn-</div><div data-canvas-width="322.53577287695475" style="left: 423.484px; top: 136.654px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12123);">ing with the pre-learned LAM. No iteration or simu-</div><div data-canvas-width="105.98280095897401" style="left: 423.484px; top: 153.019px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09947);">lation is required.</div><div data-canvas-width="102.96678663472791" style="left: 423.484px; top: 172.052px; font-size: 13.723px; font-family: serif; transform: scaleX(1.32443);">Input, Output:</div><div data-canvas-width="136.3606506457701" style="left: 532.412px; top: 171.366px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10115);">the same as Algorithm</div><div style="left: 673.243px; top: 171.366px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="19.174266487621484" style="left: 423.484px; top: 188.416px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19857);">for</div><div style="left: 447.286px; top: 187.73px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="21.325777517311415" style="left: 455.881px; top: 187.73px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18295);">= 1</div><div style="left: 477.204px; top: 187.73px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 483.319px; top: 187.73px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="37.52937266306732" style="left: 490.261px; top: 187.73px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.40614);">,...,d</div><div data-canvas-width="16.696268153062714" style="left: 532.41px; top: 188.416px; font-size: 13.723px; font-family: serif; transform: scaleX(1.21693);">do</div><div data-canvas-width="30.743250657331973" style="left: 437.203px; top: 204.259px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09056);">Read</div><div style="left: 472.411px; top: 204.259px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 480.51px; top: 209.772px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="19.01043305288153" style="left: 437.203px; top: 220.789px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08434);">Set</div><div data-canvas-width="6.942335031790236" style="left: 462.659px; top: 217.152px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 460.841px; top: 220.789px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 468.94px; top: 219.36px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 468.94px; top: 227.79px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 472.742px; top: 228.078px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div data-canvas-width="21.491497047800827" style="left: 491.254px; top: 220.789px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19215);">= 0</div><div style="left: 512.742px; top: 220.789px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="6.942335031790236" style="left: 519.354px; top: 220.789px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 518.858px; top: 220.789px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 525.305px; top: 219.36px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 524.974px; top: 227.79px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="21.491497047800827" style="left: 536.545px; top: 220.789px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19215);">= 0</div><div data-canvas-width="19.174266487621484" style="left: 437.203px; top: 237.839px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19857);">for</div><div data-canvas-width="67.60424170717738" style="left: 461.006px; top: 237.153px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08896);">each action</div><div style="left: 533.074px; top: 237.153px; font-size: 13.723px; font-family: sans-serif;">a</div><div data-canvas-width="6.942335031790236" style="left: 452.741px; top: 250.046px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 450.923px; top: 253.682px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 459.022px; top: 252.253px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 459.022px; top: 260.848px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 462.824px; top: 261.137px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 481.337px; top: 253.682px; font-size: 13.723px; font-family: serif;">=</div><div data-canvas-width="6.942335031790236" style="left: 497.701px; top: 250.046px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 495.883px; top: 253.682px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 503.982px; top: 252.253px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 503.982px; top: 260.848px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 507.784px; top: 261.137px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 525.636px; top: 253.682px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 539.355px; top: 253.682px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 547.62px; top: 253.682px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 552.909px; top: 253.682px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 561.009px; top: 259.195px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397330587585554" style="left: 565.637px; top: 253.682px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 579.025px; top: 253.682px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 584.315px; top: 253.682px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 595.059px; top: 252.253px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 601.671px; top: 253.682px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 609.77px; top: 259.195px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="6.942335031790236" style="left: 451.584px; top: 270.212px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 450.923px; top: 270.212px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 457.369px; top: 268.617px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 457.039px; top: 277.213px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="21.987063765673764" style="left: 468.775px; top: 270.212px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1263);">=  ̃</div><div style="left: 483.32px; top: 270.212px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 489.767px; top: 268.617px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 489.437px; top: 277.213px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 500.346px; top: 270.212px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 514.065px; top: 270.212px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 522.33px; top: 270.212px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 527.619px; top: 270.212px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 535.719px; top: 275.725px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397336762957261" style="left: 540.513px; top: 270.212px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 553.901px; top: 270.212px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 559.19px; top: 270.212px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 567.29px; top: 268.617px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 567.29px; top: 277.213px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 575.886px; top: 270.212px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 584.15px; top: 268.617px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="24.796164603453388" style="left: 437.204px; top: 287.262px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25173);">end</div><div style="left: 437.204px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">A</div><div style="left: 451.254px; top: 303.105px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 465.8px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">A</div><div style="left: 479.189px; top: 303.105px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 492.908px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 501.007px; top: 308.618px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 505.636px; top: 303.105px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 510.925px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">γ</div><div data-canvas-width="6.942335031790236" style="left: 520.677px; top: 299.469px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 518.859px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 526.959px; top: 301.676px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 526.959px; top: 310.106px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 530.761px; top: 310.394px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 548.447px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 562.167px; top: 303.105px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 570.266px; top: 308.618px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 574.894px; top: 303.105px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 580.183px; top: 301.676px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 437.204px; top: 319.469px; font-size: 13.723px; font-family: sans-serif;">b</div><div style="left: 446.956px; top: 319.469px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 461.337px; top: 319.469px; font-size: 13.723px; font-family: sans-serif;">b</div><div style="left: 470.263px; top: 319.469px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 483.982px; top: 319.469px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 492.081px; top: 324.982px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="6.942335031790236" style="left: 497.371px; top: 319.469px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 496.875px; top: 319.469px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 503.321px; top: 318.04px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 502.991px; top: 326.635px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="24.796164603453388" style="left: 423.484px; top: 336.685px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25173);">end</div><div style="left: 423.484px; top: 352.528px; font-size: 13.723px; font-family: sans-serif;">θ</div><div style="left: 434.063px; top: 352.528px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 448.609px; top: 352.528px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 459.353px; top: 352.528px; font-size: 13.723px; font-family: sans-serif;">A</div><div style="left: 469.601px; top: 352.886px; font-size: 9.60614px; font-family: sans-serif;">−</div><div style="left: 478.196px; top: 351.387px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 484.313px; top: 352.528px; font-size: 13.723px; font-family: sans-serif;">b</div><div data-canvas-width="322.5055632330306" style="left: 423.484px; top: 393.852px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10203);">policy only known when processing samples, such as</div><div data-canvas-width="229.11095578155914" style="left: 423.484px; top: 410.381px; font-size: 13.723px; font-family: serif; transform: scaleX(1.184);">greedy policies.  In a recent paper (</div><div data-canvas-width="22.97592329232706" style="left: 652.581px; top: 410.381px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06909);">Yao</div><div style="left: 675.557px; top: 410.381px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.76954185597" style="left: 686.136px; top: 410.381px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2010</div><div data-canvas-width="32.228110687412936" style="left: 713.575px; top: 410.381px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17507);">), we</div><div data-canvas-width="322.3930146821574" style="left: 423.484px; top: 426.911px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09458);">proposed approximate policy iteration using LAM. In</div><div data-canvas-width="322.3534436687567" style="left: 423.484px; top: 443.275px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15261);">that case, learning is still off-policy, and the goal is</div><div data-canvas-width="322.354390833546" style="left: 423.484px; top: 459.804px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1393);">to evaluate the greedy/optimal policy.  The focus of</div><div data-canvas-width="322.5467175568443" style="left: 423.484px; top: 476.334px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10088);">this paper is on evaluation of various policies that are</div><div data-canvas-width="193.09782369786467" style="left: 423.484px; top: 492.697px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09468);">generally not greedy or optimal.</div><div data-canvas-width="200.30321263008395" style="left: 423.484px; top: 528.096px; font-size: 13.723px; font-family: serif; transform: scaleX(1.26666);">3.2. A Deterministic Method</div><div data-canvas-width="234.76058762895263" style="left: 423.484px; top: 553.03px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07267);">If the target policy is known, Algorithm</div><div style="left: 661.672px; top: 553.03px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="73.71693133178778" style="left: 672.086px; top: 553.03px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07522);">can be made</div><div data-canvas-width="322.3307671274847" style="left: 423.484px; top: 569.559px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09586);">more efficient in projection. We can generate the next</div><div data-canvas-width="322.5570639255538" style="left: 423.484px; top: 585.923px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08796);">feature and reward for a given feature under the target</div><div data-canvas-width="322.4002113917282" style="left: 423.484px; top: 602.453px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1466);">policy, by taking advantage of the target policy and</div><div data-canvas-width="35.215267925091965" style="left: 423.484px; top: 618.982px; font-size: 13.723px; font-family: serif; transform: scaleX(1.03824);">LAM.</div><div data-canvas-width="322.35066433979756" style="left: 423.484px; top: 643.611px; font-size: 13.723px; font-family: serif; transform: scaleX(1.115);">Given a feature, we can project the experience under</div><div data-canvas-width="322.36791309986245" style="left: 423.484px; top: 660.14px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13355);">the target policy at once, without simulating step by</div><div data-canvas-width="191.1259792619387" style="left: 423.484px; top: 676.505px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1261);">step. In particular, for a feature</div><div style="left: 618.696px; top: 676.505px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 626.796px; top: 682.018px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="114.38543933962667" style="left: 631.424px; top: 676.505px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11213);">, the expected next</div><div data-canvas-width="160.69087110327115" style="left: 423.484px; top: 693.034px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09);">feature according to policy</div><div style="left: 588.613px; top: 693.034px; font-size: 13.723px; font-family: sans-serif;">π</div><div data-canvas-width="9.253499867419096" style="left: 601.506px; top: 693.034px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01119);">is</div><div data-canvas-width="6.942335031790236" style="left: 513.404px; top: 716.34px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 511.586px; top: 719.977px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 519.686px; top: 717.887px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 519.686px; top: 726.978px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.88062002809159" style="left: 523.488px; top: 727.266px; font-size: 9.60614px; font-family: sans-serif; transform: scaleX(1.26818);">+1</div><div style="left: 542px; top: 719.977px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 556.546px; top: 716.662px; font-size: 13.723px; font-family: sans-serif;">X</div><div style="left: 563.489px; top: 739.375px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 578.695px; top: 719.977px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 586.96px; top: 719.977px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 592.249px; top: 719.977px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 600.349px; top: 725.49px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397330587585554" style="left: 605.143px; top: 719.977px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 618.531px; top: 719.977px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 623.82px; top: 719.977px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 634.565px; top: 717.887px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 641.177px; top: 719.977px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 649.276px; top: 725.49px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 653.904px; top: 719.977px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="104.97895589109386" style="left: 423.484px; top: 756.672px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11565);">and the reward is</div><div data-canvas-width="6.942335031790236" style="left: 517.702px; top: 781.631px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 517.206px; top: 781.631px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 523.653px; top: 779.541px; font-size: 9.60614px; font-family: sans-serif;">π</div><div style="left: 523.322px; top: 788.467px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 535.058px; top: 781.631px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 549.439px; top: 778.317px; font-size: 13.723px; font-family: sans-serif;">X</div><div style="left: 556.381px; top: 800.864px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 571.588px; top: 781.632px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 579.853px; top: 781.632px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 585.142px; top: 781.632px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 593.242px; top: 787.144px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="13.397330587585554" style="left: 598.035px; top: 781.632px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.17087);">,a</div><div style="left: 611.424px; top: 781.632px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 616.713px; top: 781.632px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 624.813px; top: 779.541px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 624.813px; top: 788.467px; font-size: 9.60614px; font-family: sans-serif;">i</div><div style="left: 633.573px; top: 781.632px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 641.838px; top: 779.541px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 648.284px; top: 781.632px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="61.503190599775316" style="left: 423.484px; top: 826.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0759);">Algorithm</div><div style="left: 488.775px; top: 826.427px; font-size: 13.723px; font-family: serif;">3</div><div data-canvas-width="246.43297186570717" style="left: 499.519px; top: 826.427px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07973);">shows this more efficient method. The al-</div><div data-canvas-width="322.3519710347276" style="left: 423.484px; top: 842.956px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08462);">gorithm is deterministic and does not require any sim-</div><div data-canvas-width="322.54143102697253" style="left: 423.484px; top: 859.32px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10661);">ulation. The algorithm can also be used for on-policy</div><div data-canvas-width="243.51873861816642" style="left: 423.484px; top: 875.85px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07603);">learning if the collection policy (which is</div><div style="left: 671.259px; top: 875.85px; font-size: 13.723px; font-family: sans-serif;">π</div><div data-canvas-width="66.46229923081813" style="left: 679.524px; top: 875.85px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08319);">) is known.</div><div data-canvas-width="322.497479534237" style="left: 423.484px; top: 892.379px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06534);">However, in practice, the samples may be from various</div><div data-canvas-width="322.34280674194684" style="left: 423.484px; top: 908.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09309);">sources (e.g., collected by many agents following dif-</div><div data-canvas-width="322.34770934209814" style="left: 423.484px; top: 925.273px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07795);">ferent policies), and hence the collection policy can be</div><div data-canvas-width="205.82692534113983" style="left: 423.484px; top: 941.802px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12062);">unknown. In this case, Algorithm</div><div style="left: 634.234px; top: 941.802px; font-size: 13.723px; font-family: serif;">3</div><div data-canvas-width="99.69207018077078" style="left: 646.3px; top: 941.802px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10872);">is not applicable</div><div data-canvas-width="322.38676652340365" style="left: 423.484px; top: 958.166px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11771);">for on-policy learning, and one has to use Algorithm</div><div style="left: 423.484px; top: 974.695px; font-size: 13.723px; font-family: serif;">2</div><div style="left: 430.426px; top: 974.695px; font-size: 13.723px; font-family: serif;">.</div></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="116" style="width: 6.912px; height: 8.472px; left: 139.284px; top: 303.084px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -139.284px -303.084px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.1" class="internalLink"></a></section><section class="annotLink" data-annotation-id="117" style="width: 7.032px; height: 8.472px; left: 143.004px; top: 414.684px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -143.004px -414.684px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="118" style="width: 7.032px; height: 8.352px; left: 253.524px; top: 600.084px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -253.524px -600.084px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="119" style="width: 6.912px; height: 8.472px; left: 153.684px; top: 617.964px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -153.684px -617.964px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="120" style="width: 6.912px; height: 8.3525px; left: 210.924px; top: 695.724px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -210.924px -695.724px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="121" style="width: 7.032px; height: 8.472px; left: 487.764px; top: 124.404px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -487.764px -124.404px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="122" style="width: 17.676px; height: 10.959px; left: 472.764px; top: 295.437px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -472.764px -295.437px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lamapi" class="internalLink"></a></section><section class="annotLink" data-annotation-id="123" style="width: 21.156px; height: 10.959px; left: 497.124px; top: 295.437px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -497.124px -295.437px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lamapi" class="internalLink"></a></section><section class="annotLink" data-annotation-id="124" style="width: 6.912px; height: 8.352px; left: 479.364px; top: 401.604px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -479.364px -401.604px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="125" style="width: 7.032px; height: 8.352px; left: 353.844px; top: 600.084px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -353.844px -600.084px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.3" class="internalLink"></a></section><section class="annotLink" data-annotation-id="126" style="width: 7.032px; height: 8.4722px; left: 459.444px; top: 683.724px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -459.444px -683.724px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.3" class="internalLink"></a></section><section class="annotLink" data-annotation-id="127" style="width: 7.032px; height: 8.4725px; left: 306.444px; top: 707.604px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -306.444px -707.604px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section></div></div><div style="vertical-align: top; text-align: center; width: 100%; margin-top: 10px; z-index: 1000;"><script type="text/javascript" src="./adsbygoogle.js"></script><ins class="adsbygoogle" data-ad-client="ca-pub-8693394182295906" data-ad-slot="4864937476" data-ad-format="auto" data-adsbygoogle-status="done" style="display: block; height: 90px;"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><iframe width="863" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;" src="./saved_resource(14).html"></iframe></ins></ins></ins><script type="text/javascript">(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div id="pageContainer4" class="page" data-page-number="4" style="width: 843px; height: 1090px;" data-loaded="true"><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page4" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"><div data-canvas-width="195.55732606144917" style="left: 313.398px; top: 65.9021px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.24041);">Off-policy Learning with LAM</div><div data-canvas-width="164.5223108505216" style="left: 76.3656px; top: 94.5914px; font-size: 16.4677px; font-family: serif; transform: scaleX(1.22827);">4. Empirical Results</div><div data-canvas-width="115.86444374502562" style="left: 76.3656px; top: 123.125px; font-size: 13.723px; font-family: serif; transform: scaleX(1.24588);">4.1. Boyan MDP</div><div data-canvas-width="322.5368255308157" style="left: 76.3656px; top: 148.225px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14227);">The problem is slightly modified from Boyan chain</div><div style="left: 76.3656px; top: 164.589px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="37.856865112604154" style="left: 81.6554px; top: 164.589px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05684);">Boyan</div><div style="left: 119.177px; top: 164.589px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769399136268355" style="left: 129.26px; top: 164.589px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2002</div><div data-canvas-width="242.19598855892067" style="left: 156.699px; top: 164.589px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18787);">).  We interpret it as a MDP problem.</div><div data-canvas-width="322.33019943242545" style="left: 76.3655px; top: 181.118px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11627);">At each state, there are two actions available. Action</div><div style="left: 76.3655px; top: 197.648px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 83.6385px; top: 203.449px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="101.64564517747314" style="left: 93.2258px; top: 197.648px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09354);">“walks” the state</div><div style="left: 198.353px; top: 197.648px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="44.787229529418745" style="left: 206.617px; top: 197.648px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14125);">to state</div><div style="left: 254.718px; top: 197.648px; font-size: 13.723px; font-family: sans-serif;">i</div><div style="left: 260.338px; top: 197.648px; font-size: 13.723px; font-family: sans-serif;">−</div><div data-canvas-width="56.37309057830996" style="left: 271.909px; top: 197.648px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10403);">1. Action</div><div style="left: 331.745px; top: 197.648px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 339.018px; top: 203.449px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="50.091771039140404" style="left: 348.605px; top: 197.648px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09557);">“jumps”</div><div data-canvas-width="29.082755919950646" style="left: 76.3657px; top: 214.011px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15674);">state</div><div style="left: 109.59px; top: 214.011px; font-size: 13.723px; font-family: sans-serif;">i</div><div data-canvas-width="45.448419716443446" style="left: 118.516px; top: 214.011px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1581);">to state</div><div style="left: 168.104px; top: 214.011px; font-size: 13.723px; font-family: sans-serif;">i</div><div style="left: 175.212px; top: 214.011px; font-size: 13.723px; font-family: sans-serif;">−</div><div data-canvas-width="210.41225954068972" style="left: 188.27px; top: 214.011px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13643);">2 except that at state 1 it takes the</div><div data-canvas-width="322.49017242274317" style="left: 76.3657px; top: 230.541px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1423);">agent to state 0. Both actions are deterministic: tak-</div><div data-canvas-width="322.5412037870169" style="left: 76.3657px; top: 246.905px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13325);">ing an action leads to the intended state without any</div><div data-canvas-width="52.74116611552047" style="left: 76.3657px; top: 263.434px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07302);">problem.</div><div data-canvas-width="322.3697607161849" style="left: 76.3657px; top: 288.229px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0745);">We consider evaluating the following three target poli-</div><div data-canvas-width="25.27794638214349" style="left: 76.3657px; top: 304.593px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0054);">cies:</div><div data-canvas-width="33.73416527934089" style="left: 90.0854px; top: 329.387px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.961717);">policy</div><div data-canvas-width="271.0112719764792" style="left: 127.773px; top: 329.387px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06624);">1: walking with probability 50%, and jumping</div><div data-canvas-width="322.3538917948971" style="left: 76.3658px; top: 345.751px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14022);">with 50% at each state (this is the original policy of</div><div data-canvas-width="109.62077613329923" style="left: 76.3658px; top: 362.281px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08987);">Boyan chain); and</div><div data-canvas-width="33.73416527934089" style="left: 90.0854px; top: 386.909px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.961717);">policy</div><div data-canvas-width="271.0112719764792" style="left: 127.773px; top: 386.909px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06624);">2: walking with probability 90%, and jumping</div><div data-canvas-width="141.48483747436606" style="left: 76.3659px; top: 403.438px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11191);">with 10% at each state;</div><div data-canvas-width="33.73416527934089" style="left: 90.0855px; top: 428.067px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.961717);">policy</div><div data-canvas-width="185.35454048567263" style="left: 130.913px; top: 428.067px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1581);">3: walking with probability 0</div><div style="left: 316.208px; top: 428.067px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="78.69045494088095" style="left: 320.01px; top: 428.067px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08691);">00001%, and</div><div data-canvas-width="98.87666774695475" style="left: 76.3666px; top: 444.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09006);">jumping with 99</div><div style="left: 175.213px; top: 444.597px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="130.73283473984762" style="left: 179.015px; top: 444.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09289);">99999% at each state.</div><div data-canvas-width="322.3599758397168" style="left: 76.3667px; top: 469.226px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09397);">We compared on/off-policy learning of the three poli-</div><div data-canvas-width="322.5069544893837" style="left: 76.3667px; top: 485.755px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09696);">cies. For on-policy learning of a policy, samples were</div><div data-canvas-width="322.3547450528672" style="left: 76.3667px; top: 502.285px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06558);">collected from a number of episodes following the pol-</div><div data-canvas-width="322.3288693808673" style="left: 76.3667px; top: 518.649px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08743);">icy. For off-policy learning, samples were collected in</div><div data-canvas-width="322.3918073420966" style="left: 76.3667px; top: 535.178px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05767);">a number of episodes following a purely random policy</div><div data-canvas-width="322.54125620906126" style="left: 76.3667px; top: 551.708px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12876);">(taking uniformly random actions at each state). For</div><div data-canvas-width="322.37763258600575" style="left: 76.3667px; top: 568.072px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04022);">both on-policy and off-policy learning, 1000 episodes of</div><div data-canvas-width="322.2888603963824" style="left: 76.3667px; top: 584.601px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11896);">samples were collected. All episodes start from state</div><div data-canvas-width="322.3814950202698" style="left: 76.3667px; top: 600.966px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17679);">12 and terminate in state 0.  In both on-policy and</div><div data-canvas-width="322.5151326713643" style="left: 76.3667px; top: 617.495px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09824);">off-policy evaluation, LSTD was used. For off-policy</div><div data-canvas-width="322.50980287272154" style="left: 76.3667px; top: 634.024px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06475);">learning, two LAM were first learned from the samples</div><div data-canvas-width="98.04236974611645" style="left: 76.3667px; top: 650.388px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08544);">using Algorithm</div><div style="left: 179.509px; top: 650.388px; font-size: 13.723px; font-family: serif;">1</div><div data-canvas-width="177.6948791619323" style="left: 186.452px; top: 650.388px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14056);">. Then we projected features</div><div style="left: 369.267px; top: 650.388px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 377.367px; top: 655.902px; font-size: 9.60614px; font-family: sans-serif;">i</div><div data-canvas-width="11.414453314908283" style="left: 387.284px; top: 650.388px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06959);">in</div><div data-canvas-width="322.5235062695518" style="left: 76.366px; top: 666.918px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15646);">the samples and applied LSTD to evaluate the pro-</div><div data-canvas-width="322.310536225531" style="left: 76.366px; top: 683.447px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09579);">jected experience. We also compared the two ways of</div><div data-canvas-width="322.3401830460779" style="left: 76.366px; top: 699.811px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10599);">projecting experience: the stochastic way (Algorithm</div><div style="left: 76.3656px; top: 716.341px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="248.3031182082003" style="left: 83.3084px; top: 716.341px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15754);">) and the deterministic way (Algorithm</div><div style="left: 331.58px; top: 716.341px; font-size: 13.723px; font-family: serif;">3</div><div data-canvas-width="60.32919836967701" style="left: 338.357px; top: 716.341px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17304);">).  Notice</div><div data-canvas-width="322.54423848818055" style="left: 76.3659px; top: 732.705px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09666);">that the original features by Boyan can only represent</div><div data-canvas-width="322.39276672039875" style="left: 76.3659px; top: 749.234px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08351);">the value function of policy 1. In order to represent all</div><div data-canvas-width="322.5004017338513" style="left: 76.3659px; top: 765.764px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10999);">the policies exactly, we also used the tabular features</div><div data-canvas-width="322.600622102004" style="left: 76.3659px; top: 782.128px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08277);">in addition to the original linear interpolation features.</div><div data-canvas-width="38.85489108655669" style="left: 76.3659px; top: 806.922px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div style="left: 120.83px; top: 806.922px; font-size: 13.723px; font-family: serif;">1</div><div data-canvas-width="265.47987076297295" style="left: 133.227px; top: 806.922px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11831);">shows the results of evaluating policy 1 us-</div><div data-canvas-width="322.55960144067996" style="left: 76.3656px; top: 823.286px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15233);">ing the original linear features.  For this policy, on-</div><div data-canvas-width="322.52469921413467" style="left: 76.3656px; top: 839.815px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12868);">policy learning and the stochastic LAM-LSTD have</div><div data-canvas-width="322.3338394984159" style="left: 76.3656px; top: 856.344px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17449);">a similar convergence rate, for two reasons.  First,</div><div data-canvas-width="322.54887325559935" style="left: 76.3656px; top: 872.709px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18394);">the state/action distribution under policy 1 is very</div><div data-canvas-width="322.538736629959" style="left: 76.3656px; top: 889.238px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14391);">smooth, and the learned LAM do not provide a sig-</div><div data-canvas-width="322.6678828920427" style="left: 76.3656px; top: 905.767px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10291);">nificant advantage in the coverage of state space over</div><div data-canvas-width="322.40203904101514" style="left: 76.3656px; top: 922.132px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12372);">on-policy learning. Second, they both depend on the</div><div data-canvas-width="322.7138800658556" style="left: 76.3656px; top: 938.661px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09206);">sampling of the policy in policy evaluation. However,</div><div data-canvas-width="322.4869246712556" style="left: 76.3656px; top: 955.025px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10345);">the deterministic LAM-LSTD wins on the second as-</div><div data-canvas-width="322.17349333724724" style="left: 76.3656px; top: 971.555px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10532);">pect. The deterministic LAM-LSTD does not depend</div><div data-canvas-width="10.088970334509805" style="left: 482.536px; top: 279.047px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div style="left: 492.604px; top: 276.461px; font-size: 6.04854px; font-family: sans-serif;">0</div><div data-canvas-width="10.088970334509805" style="left: 549.15px; top: 279.047px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div style="left: 559.218px; top: 276.461px; font-size: 6.04854px; font-family: sans-serif;">1</div><div data-canvas-width="10.088970334509805" style="left: 615.763px; top: 279.047px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div style="left: 625.831px; top: 276.461px; font-size: 6.04854px; font-family: sans-serif;">2</div><div data-canvas-width="10.088970334509805" style="left: 682.377px; top: 279.047px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div style="left: 692.445px; top: 276.461px; font-size: 6.04854px; font-family: sans-serif;">3</div><div data-canvas-width="10.088970334509805" style="left: 470.876px; top: 269.816px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div data-canvas-width="6.895334202941178" style="left: 480.944px; top: 267.229px; font-size: 6.04854px; font-family: sans-serif; transform: scaleX(1.0013);">−3</div><div data-canvas-width="10.088970334509805" style="left: 470.876px; top: 227.912px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div data-canvas-width="6.895334202941178" style="left: 480.944px; top: 225.326px; font-size: 6.04854px; font-family: sans-serif; transform: scaleX(1.0013);">−2</div><div data-canvas-width="10.088970334509805" style="left: 470.876px; top: 186.011px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div data-canvas-width="6.895334202941178" style="left: 480.944px; top: 183.425px; font-size: 6.04854px; font-family: sans-serif; transform: scaleX(1.0013);">−1</div><div data-canvas-width="10.088970334509805" style="left: 470.876px; top: 144.109px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div style="left: 480.944px; top: 141.523px; font-size: 6.04854px; font-family: sans-serif;">0</div><div data-canvas-width="10.088970334509805" style="left: 470.876px; top: 102.207px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.00004);">10</div><div style="left: 480.944px; top: 99.6206px; font-size: 6.04854px; font-family: sans-serif;">1</div><div data-angle="-90" data-canvas-width="49.909555584656864" style="left: 457.586px; top: 216.731px; font-size: 9.07282px; font-family: sans-serif; transform: rotate(-90deg) scaleX(1.00023);">RMSE (Log)</div><div data-canvas-width="105.88882443710784" style="left: 536.178px; top: 287.921px; font-size: 9.07282px; font-family: sans-serif; transform: scaleX(1.0002);">Number of Episodes (Log)</div><div data-canvas-width="65.60696439455883" style="left: 533.59px; top: 215.817px; font-size: 7.64027px; font-family: sans-serif; transform: scaleX(1.00198);">Off−policy learning:</div><div data-canvas-width="86.82398315823531" style="left: 523.005px; top: 224.611px; font-size: 7.64027px; font-family: sans-serif; transform: scaleX(0.999971);">deterministic LAM−LSTD </div><div data-canvas-width="65.60696439455883" style="left: 516.639px; top: 113.03px; font-size: 7.64027px; font-family: sans-serif; transform: scaleX(0.999877);">On−policy learning </div><div data-canvas-width="39.91274973764706" style="left: 529.572px; top: 121.825px; font-size: 7.64027px; font-family: sans-serif; transform: scaleX(0.99992);">using LSTD</div><div data-canvas-width="65.60696439455883" style="left: 598.493px; top: 123.496px; font-size: 7.64027px; font-family: sans-serif; transform: scaleX(1.00198);">Off−policy learning:</div><div data-canvas-width="77.91543296794119" style="left: 592.444px; top: 132.29px; font-size: 7.64027px; font-family: sans-serif; transform: scaleX(1.00001);">stochastic LAM−LSTD </div><div data-canvas-width="49.744495944180194" style="left: 423.484px; top: 319.545px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.02068);">Figure 1.</div><div data-canvas-width="268.0578609284241" style="left: 477.7px; top: 318.68px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.12608);">The Boyan MDP: learning policy 1 with the lin-</div><div data-canvas-width="67.9255316206927" style="left: 423.484px; top: 333.722px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.12585);">ear features.</div><div data-canvas-width="322.53847973449604" style="left: 423.484px; top: 398.314px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08814);">on the sampling of the policy in projecting experience</div><div data-canvas-width="322.36944363143215" style="left: 423.484px; top: 414.844px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08436);">for policy evaluation, and the convergence is very fast</div><div data-canvas-width="322.33620352676627" style="left: 423.484px; top: 431.208px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14651);">seen from the figure. The case of tabular features is</div><div data-canvas-width="286.01887886310374" style="left: 423.484px; top: 447.737px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10877);">similar and thus the figure is not included here.</div><div data-canvas-width="38.854874193484314" style="left: 423.484px; top: 472.366px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div style="left: 467.948px; top: 472.367px; font-size: 13.723px; font-family: serif;">2</div><div data-canvas-width="265.4799730134053" style="left: 480.345px; top: 472.367px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11831);">shows the results of evaluating policy 2 us-</div><div data-canvas-width="322.39544729830277" style="left: 423.483px; top: 488.896px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19008);">ing the linear interpolation features.  For this pol-</div><div data-canvas-width="322.3832813906277" style="left: 423.483px; top: 505.26px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16275);">icy, the state/action distribution under the policy is</div><div data-canvas-width="322.37769735879345" style="left: 423.483px; top: 521.79px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14619);">not very smooth. Typically, the “jumping” action is</div><div data-canvas-width="322.52416387802305" style="left: 423.483px; top: 538.319px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09952);">more frequently taken, and half of the states are more</div><div data-canvas-width="322.51977070486856" style="left: 423.483px; top: 554.683px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13184);">frequently visited.  Hence the accuracy of on-policy</div><div data-canvas-width="322.3804325132602" style="left: 423.483px; top: 571.213px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10748);">learning is bottlenecked by those infrequently visited</div><div data-canvas-width="322.3118436203362" style="left: 423.483px; top: 587.742px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10026);">states. The LAM have a much finer accuracy because</div><div data-canvas-width="322.52280131656386" style="left: 423.483px; top: 604.106px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11541);">it is learned from the data collected from the random</div><div data-canvas-width="322.4069278632259" style="left: 423.483px; top: 620.635px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12655);">policy which is almost uniformly distributed in both</div><div data-canvas-width="322.3370955386244" style="left: 423.483px; top: 636.999px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15101);">states and actions. Thus both the stochastic and de-</div><div data-canvas-width="322.51427325174546" style="left: 423.483px; top: 653.529px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06831);">terministic LAM-LSTD converge faster than on-policy</div><div data-canvas-width="322.3308183419007" style="left: 423.483px; top: 670.058px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09272);">learning. The two have a similar convergence rate be-</div><div data-canvas-width="322.36397321271403" style="left: 423.483px; top: 686.423px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14639);">cause the RMSE quickly achieves the bound that is</div><div data-canvas-width="191.27523493583013" style="left: 423.483px; top: 702.952px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0939);">enforced by the features. Figure</div><div style="left: 618.696px; top: 702.952px; font-size: 13.723px; font-family: serif;">3</div><div data-canvas-width="116.19742541385655" style="left: 629.605px; top: 702.952px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06988);">shows the results of</div><div data-canvas-width="322.3544161800161" style="left: 423.484px; top: 719.481px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10166);">using the tabular features. This time the deterministic</div><div data-canvas-width="322.3302355240421" style="left: 423.484px; top: 735.845px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10007);">LAM-LSTD is much faster than the stochastic LAM-</div><div data-canvas-width="322.35000025404736" style="left: 423.484px; top: 752.375px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12228);">LSTD, since the tabular features can represent value</div><div data-canvas-width="104.6497092243011" style="left: 423.484px; top: 768.904px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08285);">functions exactly.</div><div data-canvas-width="322.3735255521299" style="left: 423.484px; top: 793.533px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13402);">We continue to learning policy 3. Notice that policy</div><div data-canvas-width="322.34498281942865" style="left: 423.484px; top: 810.062px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14846);">3 is an extremely ill distributed policy. Because the</div><div data-canvas-width="322.50696476794684" style="left: 423.484px; top: 826.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08117);">“walking” action is rarely taken, it requires more sam-</div><div data-canvas-width="322.3645052552942" style="left: 423.484px; top: 842.956px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11624);">ples for on-policy learning to reflect the dynamics of</div><div data-canvas-width="322.3823859068381" style="left: 423.484px; top: 859.32px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10703);">policy 3 than off-policy learning. If one learns policy</div><div data-canvas-width="322.36240576614483" style="left: 423.484px; top: 875.849px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0819);">3 using samples from itself (on-policy evaluation), the</div><div data-canvas-width="322.48321470005754" style="left: 423.484px; top: 892.379px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06556);">convergence is very slow since it can almost only learn</div><div data-canvas-width="195.88969100816286" style="left: 423.484px; top: 908.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15017);">the value functions of states 12</div><div style="left: 619.357px; top: 908.743px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="13.884737306516824" style="left: 625.473px; top: 908.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">10</div><div style="left: 639.358px; top: 908.743px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 645.473px; top: 908.743px; font-size: 13.723px; font-family: serif;">8</div><div style="left: 652.415px; top: 908.743px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 658.531px; top: 908.743px; font-size: 13.723px; font-family: serif;">6</div><div style="left: 665.473px; top: 908.743px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 671.589px; top: 908.743px; font-size: 13.723px; font-family: serif;">4</div><div style="left: 678.531px; top: 908.743px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 684.647px; top: 908.743px; font-size: 13.723px; font-family: serif;">2</div><div style="left: 691.589px; top: 908.743px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="48.1038545121976" style="left: 697.704px; top: 908.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15796);">0.  This</div><div data-canvas-width="322.35031602138747" style="left: 423.483px; top: 925.273px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13716);">kind of policies does exist in practice. For example,</div><div data-canvas-width="108.80022814648605" style="left: 423.483px; top: 941.802px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17525);">Koller and Parr (</div><div data-canvas-width="27.769407370097298" style="left: 532.247px; top: 941.802px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2000</div><div data-canvas-width="185.97353929812851" style="left: 559.851px; top: 941.802px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1539);">) showed that the uneven dis-</div><div data-canvas-width="322.52487706483987" style="left: 423.484px; top: 958.166px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16444);">tribution of states/actions under a policy can cause</div><div data-canvas-width="254.60676562715543" style="left: 423.484px; top: 974.695px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09372);">problems for approximate policy iteration.</div></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="135" style="width: 28.4763px; height: 10.959px; left: 58.2837px; top: 116.997px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -58.2837px -116.997px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.boyan02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="136" style="width: 21.1563px; height: 10.959px; left: 92.8437px; top: 116.997px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -92.8437px -116.997px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.boyan02" class="internalLink"></a></section><section class="annotLink" data-annotation-id="137" style="width: 7.032px; height: 8.352px; left: 129.324px; top: 472.284px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -129.324px -472.284px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.1" class="internalLink"></a></section><section class="annotLink" data-annotation-id="138" style="width: 7.0326px; height: 8.472px; left: 54.4437px; top: 520.044px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -54.4437px -520.044px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="139" style="width: 6.912px; height: 8.472px; left: 239.724px; top: 520.044px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -239.724px -520.044px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#algorithm.3" class="internalLink"></a></section><section class="annotLink" data-annotation-id="140" style="width: 6.9126px; height: 8.472px; left: 86.7237px; top: 585.804px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -86.7237px -585.804px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.1" class="internalLink"></a></section><section class="annotLink" data-annotation-id="141" style="width: 6.912px; height: 8.352px; left: 338.724px; top: 343.044px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -338.724px -343.044px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="142" style="width: 7.032px; height: 8.352px; left: 448.164px; top: 510.444px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -448.164px -510.444px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.3" class="internalLink"></a></section><section class="annotLink" data-annotation-id="143" style="width: 21.156px; height: 10.9592px; left: 385.404px; top: 681.237px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -385.404px -681.237px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.kollerpolicy" class="internalLink"></a></section></div></div><div style="vertical-align: top; text-align: center; width: 100%; margin-top: 10px; z-index: 1000;"><script type="text/javascript" src="./adsbygoogle.js"></script><ins class="adsbygoogle" data-ad-client="ca-pub-8693394182295906" data-ad-slot="9295137074" data-ad-format="auto" data-adsbygoogle-status="done" style="display: block; height: 90px;"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><iframe width="863" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;" src="./saved_resource(15).html"></iframe></ins></ins></ins><script type="text/javascript">(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div id="pageContainer5" class="page" data-page-number="5" style="width: 843px; height: 1090px;" data-loaded="true"><div class="loadingIcon"></div><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page5" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="152" style="width: 7.032px; height: 8.352px; left: 283.404px; top: 510.444px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -283.404px -510.444px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.4" class="internalLink"></a></section><section class="annotLink" data-annotation-id="153" style="width: 7.032px; height: 8.352px; left: 427.644px; top: 532.404px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -427.644px -532.404px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.4" class="internalLink"></a></section><section class="annotLink" data-annotation-id="154" style="width: 6.912px; height: 8.472px; left: 487.524px; top: 568.164px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -487.524px -568.164px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.5" class="internalLink"></a></section><section class="annotLink" data-annotation-id="155" style="width: 7.032px; height: 8.472px; left: 532.644px; top: 647.844px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -532.644px -647.844px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.6" class="internalLink"></a></section></div></div><div style="vertical-align: top; text-align: center; width: 100%; margin-top: 10px; z-index: 1000;"><script type="text/javascript" src="./adsbygoogle.js"></script><ins class="adsbygoogle" data-ad-client="ca-pub-8693394182295906" data-ad-slot="3248603470" data-ad-format="auto" data-adsbygoogle-status="done" style="display: block; height: 90px;"><ins id="aswift_4_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><ins id="aswift_4_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:863px;background-color:transparent"><iframe width="863" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_4" name="aswift_4" style="left:0;position:absolute;top:0;" src="./saved_resource(16).html"></iframe></ins></ins></ins><script type="text/javascript">(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div id="pageContainer6" class="page" data-page-number="6" style="width: 843px; height: 1090px;" data-loaded="true"><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page6" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"><div data-canvas-width="195.55732606144917" style="left: 313.398px; top: 65.9021px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.24041);">Off-policy Learning with LAM</div><div style="left: 117.834px; top: 96.4146px; font-size: 8.39324px; font-family: sans-serif;">1</div><div data-canvas-width="2.793654974181667" style="left: 300.476px; top: 97.3471px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.374483);">-1</div><div data-canvas-width="2.793671760653333" style="left: 111.861px; top: 282.078px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.374485);">-1</div><div style="left: 302.616px; top: 280.33px; font-size: 8.39324px; font-family: sans-serif;">1</div><div data-canvas-width="9.331943722169166" style="left: 322.27px; top: 157.925px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">40%</div><div data-canvas-width="9.331943722169166" style="left: 322.27px; top: 122.02px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">10%</div><div data-canvas-width="9.331943722169166" style="left: 342.787px; top: 140.224px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">25%</div><div data-canvas-width="9.331943722169166" style="left: 299.655px; top: 140.322px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">25%</div><div data-canvas-width="49.44435924974249" style="left: 308.749px; top: 171.913px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.914002);">Target policy 1</div><div data-canvas-width="9.331943722169166" style="left: 323.552px; top: 240.44px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">49%</div><div data-canvas-width="4.665304598835832" style="left: 324.38px; top: 203.603px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.384731);">1%</div><div data-canvas-width="9.331943722169166" style="left: 344.069px; top: 222.738px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">25%</div><div data-canvas-width="9.331943722169166" style="left: 300.937px; top: 222.837px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.555729);">25%</div><div data-canvas-width="49.44435924974249" style="left: 310.031px; top: 254.428px; font-size: 8.39324px; font-family: sans-serif; transform: scaleX(0.914002);">Target policy 2</div><div style="left: 210.132px; top: 188.448px; font-size: 8.39324px; font-family: sans-serif;">S</div><div data-canvas-width="49.744512889407716" style="left: 76.3656px; top: 312.768px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.02068);">Figure 6.</div><div data-canvas-width="267.87564089361194" style="left: 130.582px; top: 311.903px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.16413);">A Grid-world example. The darker is a region,</div><div data-canvas-width="292.5263019586768" style="left: 76.3656px; top: 327.111px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.12926);">the more the region is covered by the target policies.</div><div data-canvas-width="286.6486408955823" style="left: 76.3656px; top: 439.473px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07191);">left-down and right-up corners receives a reward</div><div style="left: 366.622px; top: 439.473px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 377.366px; top: 439.473px; font-size: 13.723px; font-family: serif;">1</div><div style="left: 384.308px; top: 439.473px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="10.74715280342633" style="left: 388.11px; top: 439.473px; font-size: 13.723px; font-family: serif; transform: scaleX(1.00706);">0;</div><div data-canvas-width="322.5060156270387" style="left: 76.3656px; top: 456.003px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1581);">and the other rewards are 0. The task is to evaluate</div><div data-canvas-width="322.3666258230458" style="left: 76.3656px; top: 472.367px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14741);">two target policies as shown in the figure. Each run</div><div data-canvas-width="322.3324596870849" style="left: 76.3656px; top: 488.896px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12933);">consists of 100 episodes of data up to 1000 steps. In</div><div data-canvas-width="322.51657080565025" style="left: 76.3656px; top: 505.26px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11827);">each episode, the agent started from the position “S”</div><div data-canvas-width="322.5429671987152" style="left: 76.3656px; top: 521.79px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18186);">in the figure, and behaved according to the target-</div><div data-canvas-width="322.38872931726974" style="left: 76.3656px; top: 538.319px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08347);">policy (for on-policy learning) or the collection policy</div><div data-canvas-width="322.55075475412775" style="left: 76.3656px; top: 554.684px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12679);">(for off-policy learning).  For on-policy learning ex-</div><div data-canvas-width="322.51556013059377" style="left: 76.3656px; top: 571.213px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11338);">periments, we used LSTD for evaluating the two tar-</div><div data-canvas-width="322.34420352868847" style="left: 76.3656px; top: 587.742px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11415);">get policies. For off-policy learning experiments, the</div><div data-canvas-width="322.38897539897073" style="left: 76.3656px; top: 604.106px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05775);">agent followed a purely random policy for collection of</div><div data-canvas-width="322.507883471134" style="left: 76.3656px; top: 620.635px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12406);">samples, and used the deterministic LAM-LSTD for</div><div data-canvas-width="322.5202010733841" style="left: 76.3656px; top: 637px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07847);">evaluating the projected experience by LAM. Features</div><div data-canvas-width="322.5762104871284" style="left: 76.3656px; top: 653.529px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09485);">are tabular for both on-policy and off-policy learning.</div><div data-canvas-width="322.3811021980141" style="left: 76.3656px; top: 678.323px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10022);">The on-policy learning result for policy 1 is shown in</div><div data-canvas-width="38.85489108655669" style="left: 76.3656px; top: 694.688px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div style="left: 119.177px; top: 694.687px; font-size: 13.723px; font-family: serif;">7</div><div data-canvas-width="272.61663901968865" style="left: 126.12px; top: 694.687px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07693);">, and the off-policy learning result is shown in</div><div data-canvas-width="38.85489108655669" style="left: 76.3657px; top: 711.217px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div style="left: 120.995px; top: 711.217px; font-size: 13.723px; font-family: serif;">8</div><div data-canvas-width="270.94103172054605" style="left: 127.938px; top: 711.217px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16008);">. The RMS errors of the two learning were</div><div data-canvas-width="117.21378469409903" style="left: 76.3657px; top: 727.581px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09095);">compared in Figure</div><div style="left: 197.857px; top: 727.581px; font-size: 13.723px; font-family: serif;">9</div><div data-canvas-width="194.0708000449828" style="left: 204.799px; top: 727.581px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1269);">. The results in all the three fig-</div><div data-canvas-width="322.4912610721596" style="left: 76.3656px; top: 744.11px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09944);">ures were averaged over 30 runs. The results are very</div><div data-canvas-width="322.5517395475151" style="left: 76.3656px; top: 760.639px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07391);">intuitive. For on-policy learning, the agent was explor-</div><div data-canvas-width="322.37167830632995" style="left: 76.3656px; top: 777.003px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11626);">ing the lower part of the world much more often; the</div><div data-canvas-width="322.3232318291447" style="left: 76.3656px; top: 793.533px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16332);">upper part was not well covered. The effect can be</div><div data-canvas-width="194.08776450465746" style="left: 76.3656px; top: 810.062px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12055);">clearly seen from the boundary,</div><div style="left: 276.206px; top: 810.062px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="108.91395351736057" style="left: 289.76px; top: 810.062px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19966);">= 6. Because the</div><div data-canvas-width="322.546199649004" style="left: 76.3654px; top: 826.426px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07565);">policy goes to the left and right equally often, so along</div><div style="left: 76.3654px; top: 842.956px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="308.28940691490845" style="left: 90.4154px; top: 842.956px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1756);">= 6 the values of the states are 0 (resulting from</div><div data-canvas-width="322.3853559175526" style="left: 76.3654px; top: 859.32px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15764);">the fact that the rewards on the left and right of the</div><div data-canvas-width="322.35441626235433" style="left: 76.3654px; top: 875.849px; font-size: 13.723px; font-family: serif; transform: scaleX(1.131);">world have the same magnitude but opposite signs).</div><div data-canvas-width="90.57685349073476" style="left: 76.3654px; top: 892.379px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11602);">For the states (</div><div style="left: 166.946px; top: 892.379px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="21.491500204101918" style="left: 178.682px; top: 892.379px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19215);">= 6</div><div data-canvas-width="12.89196382927634" style="left: 200.17px; top: 892.379px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20804);">,y</div><div style="left: 217.195px; top: 892.379px; font-size: 13.723px; font-family: sans-serif;">≤</div><div data-canvas-width="167.12390511605366" style="left: 231.741px; top: 892.379px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07271);">6), their values were learned</div><div data-canvas-width="322.37176026037395" style="left: 76.365px; top: 908.743px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15028);">accurately, reflected in that the 0-value boundary is</div><div data-canvas-width="39.82988333573774" style="left: 76.365px; top: 925.272px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08871);">almost</div><div style="left: 120.994px; top: 925.272px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="182.4855425357531" style="left: 133.226px; top: 925.272px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14348);">= 6. However, for the states (</div><div style="left: 315.711px; top: 925.272px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="21.987063765673764" style="left: 327.943px; top: 925.272px; font-size: 13.723px; font-family: serif; transform: scaleX(1.21964);">= 6</div><div data-canvas-width="28.432696222888627" style="left: 349.927px; top: 925.272px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.2639);">,y &gt;</div><div data-canvas-width="16.038102306300296" style="left: 382.655px; top: 925.272px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07937);">6),</div><div data-canvas-width="322.36531877131677" style="left: 76.3647px; top: 941.802px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11834);">their values were learned poorly, reflected in that the</div><div data-canvas-width="198.38745108110243" style="left: 76.3647px; top: 958.166px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08926);">0-value boundary is twisted from</div><div style="left: 279.181px; top: 958.166px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="107.95092172809947" style="left: 290.916px; top: 958.166px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14089);">= 6. This, in gen-</div><div data-canvas-width="322.55960086431213" style="left: 76.3646px; top: 974.695px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12732);">eral, is an inherent problem with on-policy learning,</div><div data-angle="54.0000118840185" data-canvas-width="15.601935715271646" style="left: 497.224px; top: 209.578px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(54deg) scaleX(1.00041);">−0.8</div><div data-angle="78.99999773441138" data-canvas-width="15.601935162151653" style="left: 531.438px; top: 214.98px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(79deg) scaleX(1.00041);">−0.6</div><div data-angle="-4.999996052434918" data-canvas-width="15.601942592242551" style="left: 492.282px; top: 175.6px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-5deg) scaleX(1.00041);">−0.6</div><div data-angle="88.00000015707386" data-canvas-width="15.601940656929942" style="left: 554.878px; top: 220.823px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(88deg) scaleX(1.00041);">−0.4</div><div data-angle="80.0000124822697" data-canvas-width="15.601941271542813" style="left: 544.554px; top: 166.006px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(80deg) scaleX(1.00041);">−0.4</div><div data-angle="-35.99998811598151" data-canvas-width="15.601935715271646" style="left: 486.513px; top: 159.995px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-36deg) scaleX(1.00041);">−0.4</div><div data-angle="87.0000046131635" data-canvas-width="15.60194516079892" style="left: 574.261px; top: 202.408px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(87deg) scaleX(1.00041);">−0.2</div><div data-angle="54.0000118840185" data-canvas-width="15.601935715271646" style="left: 562.018px; top: 147.378px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(54deg) scaleX(1.00041);">−0.2</div><div data-angle="-9.999987517730311" data-canvas-width="15.601941271542813" style="left: 496.703px; top: 140.823px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-9.99999deg) scaleX(1.00041);">−0.2</div><div data-angle="90.00000114591559" style="left: 595.184px; top: 214.76px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(90deg);">0</div><div data-angle="-89.00000067360094" style="left: 584.605px; top: 164.152px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-89deg);">0</div><div data-angle="65.9999939570264" style="left: 606.684px; top: 108.344px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(66deg);">0</div><div data-angle="90.0000017188734" data-canvas-width="10.986167052450988" style="left: 616.095px; top: 200.969px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(90deg) scaleX(1.00038);">0.2</div><div data-angle="-72.99998790913061" data-canvas-width="10.986170564777465" style="left: 611.172px; top: 155.764px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-73deg) scaleX(1.00038);">0.2</div><div data-angle="22.999989942546467" data-canvas-width="10.986167982902389" style="left: 669.035px; top: 140.631px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(23deg) scaleX(1.00038);">0.2</div><div data-angle="90.0000005729578" data-canvas-width="10.986167052450982" style="left: 636.184px; top: 227.726px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(90deg) scaleX(1.00038);">0.4</div><div data-angle="-77.00000219887058" data-canvas-width="10.986166224648757" style="left: 629.841px; top: 182.725px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-77deg) scaleX(1.00038);">0.4</div><div data-angle="32.999984834966305" data-canvas-width="10.98617082379275" style="left: 678.813px; top: 152.722px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(33deg) scaleX(1.00038);">0.4</div><div data-angle="-84.99999823979162" data-canvas-width="10.986170411463574" style="left: 646.834px; top: 231.03px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-85deg) scaleX(1.00038);">0.6</div><div data-angle="-0.999999326399071" data-canvas-width="10.986170399769463" style="left: 668.566px; top: 173.265px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-0.999999deg) scaleX(1.00038);">0.6</div><div data-angle="-59.999988432423876" data-canvas-width="10.98616321072502" style="left: 674.498px; top: 217.311px; font-size: 7.90371px; font-family: sans-serif; transform: rotate(-60deg) scaleX(1.00038);">0.8</div><div style="left: 587.239px; top: 247.815px; font-size: 7.90372px; font-family: sans-serif;">x</div><div data-angle="-90" style="left: 467.119px; top: 173.841px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-90deg);">y</div><div style="left: 487.085px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif;">1</div><div style="left: 507.049px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif;">2</div><div style="left: 547.062px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif;">4</div><div style="left: 587.074px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif;">6</div><div style="left: 627.045px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif;">8</div><div data-canvas-width="8.788933641960785" style="left: 664.876px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.0002);">10</div><div data-canvas-width="8.788933641960785" style="left: 684.882px; top: 239.747px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.07121);">11</div><div style="left: 483.461px; top: 233.942px; font-size: 7.90372px; font-family: sans-serif;">1</div><div style="left: 483.461px; top: 220.522px; font-size: 7.90372px; font-family: sans-serif;">2</div><div style="left: 483.461px; top: 193.682px; font-size: 7.90372px; font-family: sans-serif;">4</div><div style="left: 483.461px; top: 166.842px; font-size: 7.90372px; font-family: sans-serif;">6</div><div style="left: 483.461px; top: 140.003px; font-size: 7.90372px; font-family: sans-serif;">8</div><div data-canvas-width="8.788933641960785" style="left: 479.057px; top: 113.163px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.0002);">10</div><div data-canvas-width="8.788933641960785" style="left: 479.057px; top: 99.784px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.07121);">11</div><div data-canvas-width="49.744495944180194" style="left: 423.484px; top: 278.221px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.02068);">Figure 7.</div><div data-canvas-width="268.0775271741408" style="left: 477.7px; top: 277.357px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.18368);">On-policy learning of target policy 1 on Grid-</div><div data-canvas-width="276.8384206294679" style="left: 423.484px; top: 292.564px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.1249);">world: the contour of the averaged learned policy.</div><div data-angle="55.00001902419409" data-canvas-width="15.601933487049195" style="left: 495.493px; top: 441.932px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(55deg) scaleX(1.00041);">−0.8</div><div data-angle="77.99998742852345" data-canvas-width="15.601945054075392" style="left: 526.717px; top: 439.348px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(78deg) scaleX(1.00041);">−0.6</div><div data-angle="46.00002321524" data-canvas-width="15.601936183719895" style="left: 493.839px; top: 390.506px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(46deg) scaleX(1.00041);">−0.6</div><div data-angle="85.9999982984376" data-canvas-width="15.601937204275892" style="left: 551.241px; top: 442.827px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(86deg) scaleX(1.00041);">−0.4</div><div data-angle="77.99998742852345" data-canvas-width="15.601945054075392" style="left: 540.26px; top: 388.178px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(78deg) scaleX(1.00041);">−0.4</div><div data-angle="0.999999326399071" data-canvas-width="15.601942711615047" style="left: 490.473px; top: 356.273px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(0.999999deg) scaleX(1.00041);">−0.4</div><div data-angle="89.99999770816882" data-canvas-width="15.601937957941185" style="left: 573.367px; top: 453.174px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(90deg) scaleX(1.00041);">−0.2</div><div data-angle="85.9999982984376" data-canvas-width="15.601937204275892" style="left: 569.93px; top: 398.039px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(86deg) scaleX(1.00041);">−0.2</div><div data-angle="65.9999706527215" data-canvas-width="15.601933700124922" style="left: 555.847px; top: 343.26px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(66deg) scaleX(1.00041);">−0.2</div><div data-angle="-89.00000067360094" style="left: 584.111px; top: 428.256px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-89deg);">0</div><div data-angle="-89.00000067360094" style="left: 584.111px; top: 373.383px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-89deg);">0</div><div data-angle="-12.000012571476542" style="left: 681.181px; top: 334.216px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-12deg);">0</div><div data-angle="-89.00000067360094" data-canvas-width="10.986170399769463" style="left: 604.941px; top: 466.169px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-89deg) scaleX(1.00038);">0.2</div><div data-angle="-85.00000394756509" data-canvas-width="10.98617031571284" style="left: 607.563px; top: 410.991px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-85deg) scaleX(1.00038);">0.2</div><div data-angle="-65.00001874831396" data-canvas-width="10.986167957645192" style="left: 617.165px; top: 354.99px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-65deg) scaleX(1.00038);">0.2</div><div data-angle="8.999976735956185" data-canvas-width="10.986162557459814" style="left: 678.01px; top: 344.102px; font-size: 7.90371px; font-family: sans-serif; transform: rotate(8.99998deg) scaleX(1.00038);">0.2</div><div data-angle="-85.00000394756509" data-canvas-width="10.98617031571284" style="left: 626.376px; top: 455.038px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-85deg) scaleX(1.00038);">0.4</div><div data-angle="-77.00000219887058" data-canvas-width="10.986166224648757" style="left: 635.563px; top: 400.147px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-77deg) scaleX(1.00038);">0.4</div><div data-angle="-0.0000022918311805232917" data-canvas-width="10.98616705245099" style="left: 675.908px; top: 356.355px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-2.29183e-06deg) scaleX(1.00038);">0.4</div><div data-angle="-77.00000219887058" data-canvas-width="10.986166224648757" style="left: 649.147px; top: 451.562px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-77deg) scaleX(1.00038);">0.6</div><div data-angle="-45" data-canvas-width="10.986170452108865" style="left: 676px; top: 399.506px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-45deg) scaleX(1.00038);">0.6</div><div data-angle="-54.0000118840185" data-canvas-width="10.986165473266258" style="left: 676.43px; top: 451.493px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-54deg) scaleX(1.00038);">0.8</div><div data-angle="12.999997801129435" style="left: 491.662px; top: 333.011px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(13deg);">0</div><div style="left: 587.239px; top: 480.879px; font-size: 7.90372px; font-family: sans-serif;">x</div><div data-angle="-90" style="left: 467.119px; top: 406.906px; font-size: 7.90372px; font-family: sans-serif; transform: rotate(-90deg);">y</div><div style="left: 487.085px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif;">1</div><div style="left: 507.049px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif;">2</div><div style="left: 547.062px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif;">4</div><div style="left: 587.074px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif;">6</div><div style="left: 627.045px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif;">8</div><div data-canvas-width="8.788933641960785" style="left: 664.876px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.0002);">10</div><div data-canvas-width="8.788933641960785" style="left: 684.882px; top: 472.812px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.07121);">11</div><div style="left: 483.461px; top: 467.007px; font-size: 7.90372px; font-family: sans-serif;">1</div><div style="left: 483.461px; top: 453.586px; font-size: 7.90372px; font-family: sans-serif;">2</div><div style="left: 483.461px; top: 426.747px; font-size: 7.90372px; font-family: sans-serif;">4</div><div style="left: 483.461px; top: 399.907px; font-size: 7.90372px; font-family: sans-serif;">6</div><div style="left: 483.461px; top: 373.068px; font-size: 7.90372px; font-family: sans-serif;">8</div><div data-canvas-width="8.788933641960785" style="left: 479.057px; top: 346.228px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.0002);">10</div><div data-canvas-width="8.788933641960785" style="left: 479.057px; top: 332.849px; font-size: 7.90372px; font-family: sans-serif; transform: scaleX(1.07121);">11</div><div data-canvas-width="49.744495944180194" style="left: 423.484px; top: 511.451px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.02068);">Figure 8.</div><div data-canvas-width="268.0825691203731" style="left: 477.7px; top: 510.587px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.1742);">Off-policy learning of target policy 1 on Grid-</div><div data-canvas-width="322.1347743907349" style="left: 423.484px; top: 525.629px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.11698);">world: the contour of the learned policy (averaged over 30</div><div data-canvas-width="32.55638835258813" style="left: 423.484px; top: 540.67px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.14358);">runs).</div><div data-canvas-width="219.3536052095845" style="left: 423.484px; top: 588.899px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09667);">regardless what algorithms are used.</div><div style="left: 648.779px; top: 587.758px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="322.3664007513316" style="left: 423.484px; top: 613.528px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10641);">The off-policy learning doesn’t have this problem. In</div><div data-canvas-width="38.854874193484314" style="left: 423.484px; top: 630.057px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div style="left: 469.766px; top: 630.057px; font-size: 13.723px; font-family: serif;">8</div><div data-canvas-width="269.30251684644696" style="left: 476.543px; top: 630.057px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19392);">, the 0-value boundary is sharply close to</div><div style="left: 423.483px; top: 646.421px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="308.4629754800663" style="left: 437.533px; top: 646.421px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18486);">= 6. Also, the learned values of the upper states</div><div data-canvas-width="322.5092767036059" style="left: 423.483px; top: 662.951px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07711);">are much more accurate than those by on-policy learn-</div><div data-canvas-width="322.5213927828929" style="left: 423.483px; top: 679.48px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07501);">ing. This leads to a much smaller RMSE for off-policy</div><div data-canvas-width="322.3607299074943" style="left: 423.483px; top: 695.844px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1003);">learning. The problem of on-policy learning becomes</div><div data-canvas-width="322.483288818241" style="left: 423.483px; top: 712.374px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12856);">much severe for those policies that rarely visit some</div><div data-canvas-width="322.3203187004654" style="left: 423.483px; top: 728.903px; font-size: 13.723px; font-family: serif; transform: scaleX(1.17384);">states. For the second policy, the agent goes to the</div><div data-canvas-width="322.3738676677223" style="left: 423.483px; top: 745.268px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09322);">lower part almost sure, leaving the learning of the up-</div><div data-canvas-width="322.48205453983655" style="left: 423.483px; top: 761.797px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1387);">per states almost a gap. This causes a large learning</div><div data-canvas-width="284.7061557000046" style="left: 423.483px; top: 778.161px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09727);">error for the value function, as shown in Figure</div><div style="left: 712.583px; top: 778.161px; font-size: 13.723px; font-family: serif;">9</div><div style="left: 719.525px; top: 778.161px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="224.76099709593026" style="left: 423.484px; top: 813.559px; font-size: 13.723px; font-family: serif; transform: scaleX(1.25483);">4.3. A Difficult Control Problem</div><div data-canvas-width="322.37018563665026" style="left: 423.484px; top: 838.493px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12951);">We studied the bicycle-riding-balancing task, which</div><div data-canvas-width="322.5212526294013" style="left: 423.484px; top: 855.022px; font-size: 13.723px; font-family: serif; transform: scaleX(1.24305);">is considered as a difficult problem in literature</div><div style="left: 423.484px; top: 871.552px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="114.57946210817946" style="left: 428.773px; top: 871.552px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0975);">Lagoudakis &amp; Parr</div><div style="left: 542.991px; top: 871.552px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="27.769508234501824" style="left: 555.554px; top: 871.552px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">2003</div><div data-canvas-width="162.81892037259215" style="left: 582.992px; top: 871.552px; font-size: 13.723px; font-family: serif; transform: scaleX(1.26822);">).   The state variable is</div><div style="left: 423.484px; top: 887.916px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="11.898190202557423" style="left: 428.773px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.974786);">θ,</div><div data-canvas-width="3.8048177716360945" style="left: 446.294px; top: 884.279px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div data-canvas-width="27.101997211459945" style="left: 442.988px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.02601);">θ,ω,</div><div data-canvas-width="3.8048177716360945" style="left: 475.056px; top: 887.916px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div data-canvas-width="12.88978584429092" style="left: 472.411px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.907155);">ω,</div><div data-canvas-width="6.942335031790236" style="left: 488.61px; top: 887.916px; font-size: 13.723px; font-family: serif; transform: scaleX(0.854323);"> ̈</div><div data-canvas-width="51.568738669720275" style="left: 487.618px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.11545);">ω,ψ,d,x</div><div style="left: 539.19px; top: 893.429px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="12.891966985577437" style="left: 544.81px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20804);">,y</div><div style="left: 557.703px; top: 893.429px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="13.894067058090075" style="left: 563.157px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.30194);">,x</div><div style="left: 577.042px; top: 893.429px; font-size: 9.60614px; font-family: sans-serif;">f</div><div data-canvas-width="12.891994431673908" style="left: 584.15px; top: 887.916px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20804);">,y</div><div style="left: 597.043px; top: 893.429px; font-size: 9.60614px; font-family: sans-serif;">f</div><div data-canvas-width="50.91076708642867" style="left: 604.15px; top: 887.916px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13274);">), where</div><div style="left: 661.012px; top: 887.916px; font-size: 13.723px; font-family: sans-serif;">θ</div><div data-canvas-width="71.9046417037309" style="left: 674.07px; top: 887.916px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15078);">is the angle</div><div data-canvas-width="322.54711633490297" style="left: 423.484px; top: 904.445px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09947);">of the handler (abusing notation from the weight vec-</div><div data-canvas-width="26.78838959117404" style="left: 423.484px; top: 920.809px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15271);">tor),</div><div style="left: 457.204px; top: 920.809px; font-size: 13.723px; font-family: sans-serif;">ω</div><div data-canvas-width="217.7048254130672" style="left: 472.742px; top: 920.809px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15451);">is the vertical angle of the bicycle,</div><div style="left: 697.377px; top: 920.809px; font-size: 13.723px; font-family: sans-serif;">d</div><div data-canvas-width="34.875532197334095" style="left: 710.931px; top: 920.809px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18857);">is the</div><div style="left: 440.674px; top: 946.702px; font-size: 8.23382px; font-family: sans-serif;">2</div><div data-canvas-width="299.63232270473867" style="left: 446.294px; top: 948.286px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.17569);">Function approximation may help this problem, but</div><div data-canvas-width="322.29834343609303" style="left: 423.483px; top: 962.005px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.15894);">this depends on if the chosen features can generalize ap-</div><div data-canvas-width="224.4459282169518" style="left: 423.483px; top: 975.725px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.12447);">propriately to those regions not covered.</div></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="159" style="width: 7.0326px; height: 8.352px; left: 85.5237px; top: 504.444px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -85.5237px -504.444px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.7" class="internalLink"></a></section><section class="annotLink" data-annotation-id="160" style="width: 7.0326px; height: 8.472px; left: 86.8437px; top: 516.324px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -86.8437px -516.324px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.8" class="internalLink"></a></section><section class="annotLink" data-annotation-id="161" style="width: 7.032px; height: 8.352px; left: 142.644px; top: 528.324px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -142.644px -528.324px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.9" class="internalLink"></a></section><section class="annotLink" data-annotation-id="162" style="width: 5.556px; height: 10.959px; left: 470.004px; top: 425.037px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -470.004px -425.037px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#Hfootnote.2" class="internalLink"></a></section><section class="annotLink" data-annotation-id="163" style="width: 6.912px; height: 8.472px; left: 340.044px; top: 457.404px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -340.044px -457.404px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.8" class="internalLink"></a></section><section class="annotLink" data-annotation-id="164" style="width: 7.032px; height: 8.352px; left: 516.324px; top: 565.044px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -516.324px -565.044px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.9" class="internalLink"></a></section><section class="annotLink" data-annotation-id="165" style="width: 84.156px; height: 10.959px; left: 310.284px; top: 630.237px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -310.284px -630.237px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lspi03" class="internalLink"></a></section><section class="annotLink" data-annotation-id="166" style="width: 21.156px; height: 10.959px; left: 402.324px; top: 630.237px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -402.324px -630.237px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#cite.lspi03" class="internalLink"></a></section></div></div><div id="pageContainer7" class="page" data-page-number="7" style="width: 843px; height: 1090px;" data-loaded="true"><div class="canvasWrapper" style="width: 843px; height: 1090px;"><canvas id="page7" width="843" height="1090" style="width: 843px; height: 1090px;"></canvas></div><div class="textLayer" style="width: 843px; height: 1090px;"><div data-canvas-width="195.55732606144917" style="left: 313.398px; top: 65.9021px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.24041);">Off-policy Learning with LAM</div><div data-canvas-width="9.687122152156864" style="left: 140.831px; top: 258.857px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div style="left: 150.51px; top: 256.389px; font-size: 5.80764px; font-family: sans-serif;">0</div><div data-canvas-width="9.687122152156864" style="left: 240.916px; top: 258.857px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div style="left: 250.595px; top: 256.389px; font-size: 5.80764px; font-family: sans-serif;">1</div><div data-canvas-width="9.687122152156864" style="left: 341.049px; top: 258.857px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div style="left: 350.728px; top: 256.389px; font-size: 5.80764px; font-family: sans-serif;">2</div><div data-canvas-width="9.687122152156864" style="left: 129.312px; top: 249.661px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div data-canvas-width="6.620705464705882" style="left: 138.991px; top: 247.193px; font-size: 5.80764px; font-family: sans-serif; transform: scaleX(1.0012);">−4</div><div data-canvas-width="9.687122152156864" style="left: 129.312px; top: 210.655px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div data-canvas-width="6.620705464705882" style="left: 138.991px; top: 208.186px; font-size: 5.80764px; font-family: sans-serif; transform: scaleX(1.0012);">−3</div><div data-canvas-width="9.687122152156864" style="left: 129.312px; top: 171.646px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div data-canvas-width="6.620705464705882" style="left: 138.991px; top: 169.178px; font-size: 5.80764px; font-family: sans-serif; transform: scaleX(1.0012);">−2</div><div data-canvas-width="9.687122152156864" style="left: 129.312px; top: 132.638px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div data-canvas-width="6.620705464705882" style="left: 138.991px; top: 130.17px; font-size: 5.80764px; font-family: sans-serif; transform: scaleX(1.0012);">−1</div><div data-canvas-width="9.687122152156864" style="left: 129.312px; top: 93.6786px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(0.999895);">10</div><div style="left: 138.991px; top: 91.2104px; font-size: 5.80764px; font-family: sans-serif;">0</div><div data-angle="-90" data-canvas-width="47.92163575450981" style="left: 116.003px; top: 201.168px; font-size: 8.71144px; font-family: sans-serif; transform: rotate(-90deg) scaleX(1.00008);">RMSE (Log)</div><div data-canvas-width="100.7042554666667" style="left: 196.971px; top: 267.908px; font-size: 8.71144px; font-family: sans-serif; transform: scaleX(1.00004);">Number of episodes (Log)</div><div data-canvas-width="78.24033803333333" style="left: 259.016px; top: 102.874px; font-size: 9.2922px; font-family: sans-serif; transform: scaleX(1.00897);">On−policy, policy 2</div><div data-canvas-width="78.24033803333333" style="left: 269.034px; top: 126.686px; font-size: 9.2922px; font-family: sans-serif; transform: scaleX(1.00897);">On−policy, policy 1</div><div data-canvas-width="78.24033803333333" style="left: 164.545px; top: 181.277px; font-size: 9.2922px; font-family: sans-serif; transform: scaleX(1.01116);">Off−policy, policy 2</div><div data-canvas-width="78.24033803333333" style="left: 155.882px; top: 144.98px; font-size: 9.2922px; font-family: sans-serif; transform: scaleX(1.01116);">Off−policy, policy 1</div><div data-canvas-width="49.744512889407716" style="left: 76.3656px; top: 304.503px; font-size: 12.3507px; font-family: sans-serif; transform: scaleX(1.02068);">Figure 9.</div><div data-canvas-width="268.08217940484184" style="left: 130.582px; top: 303.639px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.09885);">The averaged RMSE of on/off-policy learning on</div><div data-canvas-width="63.78353073659762" style="left: 76.3656px; top: 318.681px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.08752);">Grid-world.</div><div data-canvas-width="100.67023073871312" style="left: 76.3656px; top: 358.809px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12437);">distance to goal,</div><div style="left: 182.649px; top: 358.809px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div data-canvas-width="201.0077646990767" style="left: 197.691px; top: 358.809px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14947);">is the angle of the bicycle to the</div><div data-canvas-width="65.1455781183535" style="left: 76.3656px; top: 375.174px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11762);">goal, and (</div><div style="left: 141.491px; top: 375.174px; font-size: 13.723px; font-family: sans-serif;">x</div><div style="left: 149.261px; top: 380.687px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="12.89196382927634" style="left: 154.88px; top: 375.174px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20804);">,y</div><div style="left: 167.773px; top: 380.687px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="17.52426782368292" style="left: 173.228px; top: 375.174px; font-size: 13.723px; font-family: serif; transform: scaleX(1.35327);">)/(</div><div style="left: 190.749px; top: 375.174px; font-size: 13.723px; font-family: sans-serif;">x</div><div style="left: 198.518px; top: 380.687px; font-size: 9.60614px; font-family: sans-serif;">f</div><div data-canvas-width="12.89196382927634" style="left: 205.791px; top: 375.174px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20804);">,y</div><div style="left: 218.684px; top: 380.687px; font-size: 9.60614px; font-family: sans-serif;">f</div><div data-canvas-width="173.2518702773462" style="left: 225.626px; top: 375.174px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13398);">) is the back/front tyre posi-</div><div data-canvas-width="322.53699992331264" style="left: 76.3658px; top: 391.703px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16612);">tion. The actions are the torque applied to the han-</div><div data-canvas-width="26.788423363595747" style="left: 76.3658px; top: 408.233px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10615);">dler,</div><div style="left: 107.276px; top: 408.233px; font-size: 13.723px; font-family: sans-serif;">τ</div><div data-canvas-width="30.752485719872404" style="left: 118.681px; top: 408.233px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.50015);">∈{−</div><div style="left: 149.426px; top: 408.233px; font-size: 13.723px; font-family: serif;">2</div><div style="left: 156.368px; top: 408.233px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 162.483px; top: 408.233px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 169.425px; top: 408.233px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 175.541px; top: 408.233px; font-size: 13.723px; font-family: serif;">2</div><div style="left: 182.483px; top: 408.233px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="209.46433262828293" style="left: 189.425px; top: 408.233px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10057);">; and the displacement of the rider,</div><div style="left: 76.3657px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">v</div><div data-canvas-width="33.23188908872475" style="left: 90.0853px; top: 424.597px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.6211);">∈{−</div><div style="left: 123.309px; top: 424.597px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 130.251px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="13.884712193338553" style="left: 134.053px; top: 424.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">02</div><div style="left: 147.938px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 154.054px; top: 424.597px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 160.996px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 167.112px; top: 424.597px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 174.054px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="13.884703822279128" style="left: 177.856px; top: 424.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">02</div><div style="left: 191.741px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">}</div><div data-canvas-width="106.9485116519272" style="left: 198.683px; top: 424.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.22577);">. At least one of</div><div style="left: 311.909px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">τ</div><div data-canvas-width="22.16163973980279" style="left: 325.629px; top: 424.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11874);">and</div><div style="left: 353.894px; top: 424.597px; font-size: 13.723px; font-family: sans-serif;">v</div><div data-canvas-width="31.562367192983757" style="left: 367.283px; top: 424.597px; font-size: 13.723px; font-family: serif; transform: scaleX(1.135);">is re-</div><div data-canvas-width="293.91722626264453" style="left: 76.3652px; top: 441.126px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16521);">stricted to 0. This leads to 5 actions in total. If</div><div style="left: 375.382px; top: 441.126px; font-size: 13.723px; font-family: sans-serif;">ω</div><div data-canvas-width="9.253432624482741" style="left: 389.432px; top: 441.126px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01118);">is</div><div data-canvas-width="67.62702155555652" style="left: 76.3652px; top: 457.656px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08897);">bigger than</div><div data-canvas-width="15.206729729992626" style="left: 147.442px; top: 457.656px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.34077);">π/</div><div data-canvas-width="236.060454779727" style="left: 162.648px; top: 457.656px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05377);">15, the bicycle falls over and the episode</div><div data-canvas-width="294.75391823552434" style="left: 76.3652px; top: 474.02px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11152);">stops. The reward signal is updated according to</div><div style="left: 122.482px; top: 514.517px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 128.599px; top: 520.03px; font-size: 9.60614px; font-family: sans-serif;">t</div><div style="left: 137.194px; top: 514.517px; font-size: 13.723px; font-family: serif;">=</div><div data-canvas-width="13.884703822279128" style="left: 158.021px; top: 505.261px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">15</div><div style="left: 171.905px; top: 505.261px; font-size: 13.723px; font-family: sans-serif;">ω</div><div style="left: 180.501px; top: 510.773px; font-size: 9.60614px; font-family: sans-serif;">t</div><div style="left: 184.633px; top: 512.56px; font-size: 9.60614px; font-family: sans-serif;">−</div><div style="left: 193.228px; top: 511.062px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 174.385px; top: 523.938px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 205.295px; top: 501.805px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 214.552px; top: 514.517px; font-size: 13.723px; font-family: sans-serif;">−</div><div data-canvas-width="13.884703822279128" style="left: 234.552px; top: 505.26px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">15</div><div style="left: 248.437px; top: 505.26px; font-size: 13.723px; font-family: sans-serif;">ω</div><div style="left: 257.032px; top: 510.773px; font-size: 9.60614px; font-family: sans-serif;">t</div><div style="left: 243.809px; top: 523.938px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 267.777px; top: 501.805px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 277.033px; top: 514.517px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 292.406px; top: 505.26px; font-size: 13.723px; font-family: sans-serif;">d</div><div style="left: 299.513px; top: 510.773px; font-size: 9.60614px; font-family: sans-serif;">t</div><div style="left: 303.645px; top: 512.56px; font-size: 9.60614px; font-family: sans-serif;">−</div><div style="left: 312.24px; top: 511.061px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 321.497px; top: 505.26px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 335.217px; top: 505.26px; font-size: 13.723px; font-family: sans-serif;">d</div><div style="left: 342.324px; top: 510.773px; font-size: 9.60614px; font-family: sans-serif;">t</div><div data-canvas-width="20.82703871683888" style="left: 309.431px; top: 523.938px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">100</div><div style="left: 348.771px; top: 514.517px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="35.20325951684148" style="left: 76.3662px; top: 552.038px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05034);">where</div><div style="left: 117.028px; top: 552.038px; font-size: 13.723px; font-family: sans-serif;">d</div><div style="left: 124.136px; top: 557.552px; font-size: 9.60614px; font-family: sans-serif;">t</div><div data-canvas-width="264.4793585294795" style="left: 134.385px; top: 552.038px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13803);">is the distance from the bicycle to the goal</div><div data-canvas-width="36.698242147607466" style="left: 76.3661px; top: 568.568px; font-size: 13.723px; font-family: serif; transform: scaleX(1.2195);">at the</div><div style="left: 118.681px; top: 568.568px; font-size: 13.723px; font-family: sans-serif;">t</div><div data-canvas-width="215.87786448786508" style="left: 129.095px; top: 568.568px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15865);">time step. The discount factor is 0</div><div style="left: 344.969px; top: 568.568px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="49.919020642118106" style="left: 348.771px; top: 568.568px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19109);">80. The</div><div data-canvas-width="322.32185524273024" style="left: 76.3664px; top: 585.097px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10884);">state feature is the same as used for a single action in</div><div data-canvas-width="218.72118974339145" style="left: 76.3664px; top: 601.461px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07677);">LSPI, comprising 20 basis functions:</div><div data-canvas-width="10.747169682775661" style="left: 149.757px; top: 631.71px; font-size: 13.723px; font-family: serif; transform: scaleX(0.940356);">[1</div><div data-canvas-width="19.00849096709527" style="left: 160.501px; top: 631.71px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.0548);">,ω,</div><div data-canvas-width="3.8048177716360945" style="left: 184.303px; top: 631.71px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div data-canvas-width="23.62755935593987" style="left: 181.824px; top: 631.71px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.960228);">ω,ω</div><div style="left: 205.957px; top: 629.743px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 212.073px; top: 631.71px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="3.8048177716360945" style="left: 220.668px; top: 631.71px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div style="left: 218.189px; top: 631.71px; font-size: 13.723px; font-family: sans-serif;">ω</div><div style="left: 227.28px; top: 629.743px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="14.707794827160813" style="left: 233.231px; top: 631.71px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.0351);">,ω</div><div data-canvas-width="3.8048177716360945" style="left: 251.082px; top: 631.71px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div data-canvas-width="25.779378468062685" style="left: 248.438px; top: 631.71px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.975938);">ω,θ,</div><div data-canvas-width="3.8048177716360945" style="left: 279.183px; top: 628.074px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div data-canvas-width="19.33001089902524" style="left: 276.538px; top: 631.71px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.938348);">θ,θ</div><div style="left: 296.208px; top: 629.743px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 302.324px; top: 631.71px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="3.8048177716360945" style="left: 311.084px; top: 628.074px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div style="left: 308.44px; top: 631.71px; font-size: 13.723px; font-family: sans-serif;">θ</div><div style="left: 315.217px; top: 629.743px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 321.498px; top: 631.71px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 123.971px; top: 661.794px; font-size: 13.723px; font-family: sans-serif;">θ</div><div data-canvas-width="3.8048177716360945" style="left: 133.393px; top: 658.157px; font-size: 13.723px; font-family: serif; transform: scaleX(0.475671);"> ̇</div><div data-canvas-width="50.38954515732594" style="left: 130.748px; top: 661.794px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.940097);">θ,ωθ,ωθ</div><div style="left: 181.494px; top: 659.991px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="14.707794827160813" style="left: 187.61px; top: 661.794px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.0351);">,ω</div><div style="left: 202.816px; top: 659.991px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="37.345171768320554" style="left: 208.933px; top: 661.794px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.04217);">θ,ψ,ψ</div><div style="left: 246.785px; top: 659.991px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="26.110677553949508" style="left: 252.901px; top: 661.794px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.00713);">,ψθ,</div><div data-canvas-width="6.942335031790236" style="left: 284.141px; top: 658.157px; font-size: 13.723px; font-family: serif; transform: scaleX(0.843886);"> ̄</div><div data-canvas-width="13.386792109923743" style="left: 281.331px; top: 661.794px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.975716);">ψ,</div><div data-canvas-width="6.942335031790236" style="left: 299.679px; top: 658.157px; font-size: 13.723px; font-family: serif; transform: scaleX(0.843886);"> ̄</div><div style="left: 297.034px; top: 661.794px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div style="left: 306.456px; top: 659.991px; font-size: 9.60614px; font-family: sans-serif;">2</div><div style="left: 312.572px; top: 661.794px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="6.942335031790236" style="left: 321.498px; top: 658.157px; font-size: 13.723px; font-family: serif; transform: scaleX(0.843886);"> ̄</div><div data-canvas-width="15.856663476917946" style="left: 318.688px; top: 661.794px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(0.866379);">ψθ</div><div style="left: 334.887px; top: 661.794px; font-size: 13.723px; font-family: serif;">]</div><div style="left: 338.689px; top: 659.703px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 347.284px; top: 661.794px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="35.20325951684148" style="left: 76.3666px; top: 686.423px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05034);">where</div><div data-canvas-width="6.9423602821989885" style="left: 120.17px; top: 682.786px; font-size: 13.723px; font-family: serif; transform: scaleX(0.843889);"> ̄</div><div style="left: 117.36px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div style="left: 132.567px; top: 686.423px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 149.261px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 161.328px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 176.039px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div data-canvas-width="7.943285799013165" style="left: 191.246px; top: 686.423px; font-size: 13.723px; font-family: serif; transform: scaleX(0.947808);">if</div><div data-canvas-width="26.114431082102826" style="left: 204.966px; top: 686.423px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.20165);">ψ &gt;</div><div data-canvas-width="73.55280791531555" style="left: 236.868px; top: 686.423px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09684);">0, otherwise</div><div data-canvas-width="6.942335031790236" style="left: 318.853px; top: 682.786px; font-size: 13.723px; font-family: serif; transform: scaleX(0.843886);"> ̄</div><div style="left: 316.043px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div style="left: 331.416px; top: 686.423px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 347.945px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 358.689px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">π</div><div style="left: 370.921px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 385.467px; top: 686.423px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div style="left: 394.889px; top: 686.423px; font-size: 13.723px; font-family: serif;">.</div><div data-canvas-width="322.3459832982603" style="left: 76.367px; top: 702.952px; font-size: 13.723px; font-family: serif; transform: scaleX(1.15585);">The problem is difficult partially because there is a</div><div data-canvas-width="322.51574159046066" style="left: 76.367px; top: 719.481px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08522);">noise added to the displacement action, which follows</div><div data-canvas-width="168.67487012615874" style="left: 76.367px; top: 735.846px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10108);">a uniformly distribution in [</div><div style="left: 244.967px; top: 735.846px; font-size: 13.723px; font-family: sans-serif;">−</div><div style="left: 255.711px; top: 735.846px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 262.653px; top: 735.846px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="13.884703822279128" style="left: 266.455px; top: 735.846px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">02</div><div style="left: 280.34px; top: 735.846px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 286.456px; top: 735.846px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 293.398px; top: 735.846px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="21.49430559312961" style="left: 297.2px; top: 735.846px; font-size: 13.723px; font-family: serif; transform: scaleX(0.989663);">02].</div><div data-canvas-width="322.3250365472182" style="left: 76.3669px; top: 760.64px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11154);">We collected a data set of 2500 episodes using a uni-</div><div data-canvas-width="322.5063421669715" style="left: 76.3669px; top: 777.004px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04154);">formly random policy, each comprising 20 steps of sam-</div><div data-canvas-width="322.3435170880928" style="left: 76.3669px; top: 793.534px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0917);">ples. Five linear action models were learned using the</div><div data-canvas-width="322.3310219919366" style="left: 76.3669px; top: 810.063px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08033);">least-squares algorithm. We used LAM to evaluate the</div><div data-canvas-width="322.3584673610856" style="left: 76.3669px; top: 826.427px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09735);">following three policies: (1) policy 1, which takes the</div><div data-canvas-width="198.38722863049043" style="left: 76.3669px; top: 842.957px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14675);">five actions with probabilities 0</div><div style="left: 274.72px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">.</div><div style="left: 278.522px; top: 842.957px; font-size: 13.723px; font-family: serif;">4</div><div style="left: 285.464px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 291.58px; top: 842.957px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 298.522px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 304.637px; top: 842.957px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 311.58px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">.</div><div style="left: 315.382px; top: 842.957px; font-size: 13.723px; font-family: serif;">4</div><div style="left: 322.324px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 328.439px; top: 842.957px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 335.381px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">.</div><div style="left: 339.183px; top: 842.957px; font-size: 13.723px; font-family: serif;">1</div><div style="left: 346.126px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">,</div><div style="left: 352.241px; top: 842.957px; font-size: 13.723px; font-family: serif;">0</div><div style="left: 359.183px; top: 842.957px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="35.70964912255091" style="left: 362.985px; top: 842.957px; font-size: 13.723px; font-family: serif; transform: scaleX(1.18639);">1; (2)</div><div data-canvas-width="242.38416200167063" style="left: 76.3667px; top: 859.321px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16379);">policy 2 is coined.  With probability 0</div><div style="left: 318.688px; top: 859.321px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="76.18548621931866" style="left: 322.49px; top: 859.321px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16951);">1, select the</div><div data-canvas-width="322.5184545273123" style="left: 76.3669px; top: 875.85px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1272);">action that minimizes the predicted direction to goal</div><div style="left: 76.3669px; top: 892.38px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 81.6561px; top: 892.38px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div data-canvas-width="232.81509637221293" style="left: 91.0777px; top: 892.38px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10284);">), riding to the goal; with probability 0</div><div style="left: 323.812px; top: 892.38px; font-size: 13.723px; font-family: sans-serif;">.</div><div data-canvas-width="71.06146468483867" style="left: 327.614px; top: 892.38px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09085);">9, select the</div><div data-canvas-width="322.348469749924" style="left: 76.3667px; top: 908.744px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1297);">action that minimizes the predicted vertical angle of</div><div data-canvas-width="75.37449595135598" style="left: 76.3667px; top: 925.273px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11168);">the bicycle (</div><div style="left: 151.741px; top: 925.273px; font-size: 13.723px; font-family: sans-serif;">ω</div><div data-canvas-width="237.88779667047132" style="left: 160.832px; top: 925.273px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12923);">), balancing. The predictions are made</div><div data-canvas-width="199.21056740500802" style="left: 76.3667px; top: 941.803px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11256);">according to LAM. For a feature</div><div style="left: 280.67px; top: 941.803px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="110.08216203154964" style="left: 288.77px; top: 941.803px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09053);">, we have five fea-</div><div data-canvas-width="100.18657199010063" style="left: 76.3668px; top: 958.167px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12376);">ture projections,</div><div data-canvas-width="6.942351911139566" style="left: 183.974px; top: 954.53px; font-size: 13.723px; font-family: serif; transform: scaleX(0.83103);"> ̃</div><div style="left: 182.155px; top: 958.167px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 190.255px; top: 956.738px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 202.486px; top: 958.167px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 218.686px; top: 958.167px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 229.43px; top: 956.738px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 236.041px; top: 958.167px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="65.13082844887973" style="left: 244.141px; top: 958.167px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19555);">. For each</div><div style="left: 314.722px; top: 958.167px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 321.995px; top: 958.167px; font-size: 13.723px; font-family: serif;">,</div><div data-canvas-width="6.942335031790236" style="left: 333.565px; top: 954.53px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831028);"> ̃</div><div style="left: 331.746px; top: 958.167px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 339.846px; top: 956.738px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="52.3950883496359" style="left: 346.458px; top: 958.167px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0828);">(2) gives</div><div data-canvas-width="78.856290733035" style="left: 76.367px; top: 974.696px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10703);">the predicted</div><div style="left: 159.179px; top: 974.696px; font-size: 13.723px; font-family: sans-serif;">ω</div><div data-canvas-width="22.161622997683942" style="left: 172.238px; top: 974.696px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11873);">and</div><div data-canvas-width="6.942351911139566" style="left: 200.172px; top: 971.06px; font-size: 13.723px; font-family: serif; transform: scaleX(0.83103);"> ̃</div><div style="left: 198.354px; top: 974.696px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 206.454px; top: 973.267px; font-size: 9.60614px; font-family: sans-serif;">a</div><div data-canvas-width="140.34254624045897" style="left: 213.066px; top: 974.696px; font-size: 13.723px; font-family: serif; transform: scaleX(1.0803);">(15) gives the predicted</div><div style="left: 357.367px; top: 974.696px; font-size: 13.723px; font-family: sans-serif;">ψ</div><div data-canvas-width="27.94092145770406" style="left: 370.756px; top: 974.696px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11191);">after</div><div data-canvas-width="322.3732255662954" style="left: 423.485px; top: 95.8276px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09788);">taking the action; (3) policy 3 is the greedy policy. At</div><div data-canvas-width="53.06577516050039" style="left: 423.485px; top: 112.192px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11488);">a feature</div><div style="left: 481.008px; top: 112.192px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="147.74489994320396" style="left: 493.901px; top: 112.192px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08625);">in the samples, we select</div><div style="left: 423.651px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">a</div><div style="left: 430.923px; top: 148.088px; font-size: 9.60614px; font-family: sans-serif;">∗</div><div data-canvas-width="61.66054332498614" style="left: 441.007px; top: 148.391px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11108);">= arg max</div><div style="left: 486.793px; top: 160.186px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 504.81px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">Q</div><div style="left: 515.719px; top: 148.391px; font-size: 13.723px; font-family: serif;">(</div><div data-canvas-width="21.4991569788648" style="left: 521.009px; top: 148.391px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.00697);">φ,a</div><div data-canvas-width="70.91854942975428" style="left: 542.497px; top: 148.391px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11691);">) = arg max</div><div style="left: 597.54px; top: 160.186px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 623.657px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 631.756px; top: 146.301px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 640.516px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 648.781px; top: 146.301px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 658.368px; top: 148.391px; font-size: 13.723px; font-family: serif;">+</div><div style="left: 672.088px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">γ</div><div style="left: 680.022px; top: 148.391px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 685.312px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 696.055px; top: 146.301px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 702.667px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 710.766px; top: 148.391px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 716.056px; top: 146.301px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 724.816px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">θ</div><div style="left: 741.842px; top: 148.391px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="17.524402172325143" style="left: 728.288px; top: 169.549px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09543);">(1)</div><div data-canvas-width="40.494217335882674" style="left: 423.485px; top: 186.079px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06326);">(where</div><div style="left: 469.271px; top: 186.079px; font-size: 13.723px; font-family: sans-serif;">θ</div><div data-canvas-width="264.4930079535608" style="left: 481.503px; top: 186.079px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1418);">is the policy weight vector). Then the pro-</div><div data-canvas-width="117.18668469290493" style="left: 423.485px; top: 202.608px; font-size: 13.723px; font-family: serif; transform: scaleX(1.095);">jected experience, (</div><div data-canvas-width="21.4991569788648" style="left: 540.679px; top: 202.608px; font-size: 13.723px; font-family: sans-serif; transform: scaleX(1.00697);">φ,a</div><div style="left: 562.167px; top: 202.966px; font-size: 9.60614px; font-family: sans-serif;">∗</div><div style="left: 568.448px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="6.942368653258412" style="left: 575.225px; top: 202.608px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831032);"> ̃</div><div style="left: 574.564px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">r</div><div style="left: 585.639px; top: 202.608px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 600.845px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 608.945px; top: 201.179px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 617.706px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">f</div><div style="left: 625.97px; top: 201.179px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 631.921px; top: 200.619px; font-size: 6.86152px; font-family: monospace;">∗</div><div style="left: 638.202px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="6.942368653258412" style="left: 646.137px; top: 198.971px; font-size: 13.723px; font-family: serif; transform: scaleX(0.831032);"> ̃</div><div style="left: 644.319px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 656.881px; top: 202.608px; font-size: 13.723px; font-family: serif;">=</div><div style="left: 672.088px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">F</div><div style="left: 682.832px; top: 201.179px; font-size: 9.60614px; font-family: sans-serif;">a</div><div style="left: 688.782px; top: 200.619px; font-size: 6.86152px; font-family: monospace;">∗</div><div style="left: 695.229px; top: 202.608px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="42.485386074303705" style="left: 703.328px; top: 202.608px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11515);">) is fed</div><div data-canvas-width="322.36108931412747" style="left: 423.485px; top: 218.972px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10884);">to LSTD. Policies 1 and 2 can be evaluated using the</div><div data-canvas-width="322.3397919529261" style="left: 423.485px; top: 235.501px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09572);">deterministic or stochastic LAM-LSTD. We added an</div><div data-canvas-width="322.7281468075389" style="left: 423.485px; top: 252.031px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13053);">outer iteration loop for learning policy 3 for conver-</div><div data-canvas-width="322.36245364585994" style="left: 423.485px; top: 268.395px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12376);">gence (in a few iterations). After the value functions</div><div data-canvas-width="90.25068119843814" style="left: 423.485px; top: 284.924px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13371);">(or parameters</div><div style="left: 519.356px; top: 284.924px; font-size: 13.723px; font-family: sans-serif;">θ</div><div data-canvas-width="219.84849867471115" style="left: 526.133px; top: 284.924px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13389);">) of the three policies were learned,</div><div data-canvas-width="322.4904317746319" style="left: 423.485px; top: 301.289px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10074);">we used them for control, selecting actions online ac-</div><div data-canvas-width="68.94456111061787" style="left: 423.485px; top: 317.818px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07708);">cording to (</div><div style="left: 492.411px; top: 317.817px; font-size: 13.723px; font-family: serif;">1</div><div data-canvas-width="62.66662157195171" style="left: 499.354px; top: 317.817px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06106);">), in which</div><div style="left: 565.471px; top: 317.817px; font-size: 13.723px; font-family: sans-serif;">φ</div><div data-canvas-width="168.75945066559083" style="left: 577.207px; top: 317.817px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07264);">now takes real time features.</div><div data-canvas-width="38.854874193484314" style="left: 423.483px; top: 342.611px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div data-canvas-width="13.884703685048647" style="left: 470.096px; top: 342.611px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">10</div><div data-canvas-width="254.38124283645274" style="left: 491.585px; top: 342.611px; font-size: 13.723px; font-family: serif; transform: scaleX(1.19664);">shows the trajectories of the three con-</div><div data-canvas-width="322.692142496713" style="left: 423.483px; top: 358.975px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1159);">trollers. Notice that policy 1 is a poor one, according</div><div data-canvas-width="322.3737868526912" style="left: 423.483px; top: 375.504px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08479);">to which the bicycle fell over in less than one hundred</div><div data-canvas-width="322.501667108683" style="left: 423.483px; top: 391.868px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13202);">of steps most of the time. Surprisingly, action selec-</div><div data-canvas-width="322.3975314176384" style="left: 423.483px; top: 408.397px; font-size: 13.723px; font-family: serif; transform: scaleX(1.12525);">tion according to the value function of policy 1 (i.e.,</div><div style="left: 423.483px; top: 424.927px; font-size: 13.723px; font-family: sans-serif;">θ</div><div style="left: 429.93px; top: 430.728px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="154.0884921913935" style="left: 436.046px; top: 424.927px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11111);">) in the way of equation (</div><div style="left: 590.1px; top: 424.927px; font-size: 13.723px; font-family: serif;">1</div><div data-canvas-width="148.767669794476" style="left: 597.042px; top: 424.927px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09717);">) can balance the bicycle</div><div data-canvas-width="83.97369580959277" style="left: 423.484px; top: 441.291px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11889);">for at least 72</div><div style="left: 507.453px; top: 441.291px; font-size: 13.723px; font-family: sans-serif;">,</div><div data-canvas-width="232.2527210661867" style="left: 513.568px; top: 441.291px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10607);">000 steps, as shown in the figure. This</div><div data-canvas-width="322.6938910737962" style="left: 423.484px; top: 457.821px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08034);">is because the value function of policy 1 approximates</div><div data-canvas-width="322.38760977727156" style="left: 423.484px; top: 474.35px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07926);">the shape of the balancing policy well, though the pol-</div><div data-canvas-width="151.9290400453813" style="left: 423.484px; top: 490.714px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16229);">icy itself is poor. Figure</div><div data-canvas-width="13.884737306516824" style="left: 581.009px; top: 490.714px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05048);">11</div><div data-canvas-width="145.4655393697042" style="left: 600.348px; top: 490.714px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10672);">shows the learned value</div><div data-canvas-width="123.02020126973692" style="left: 423.484px; top: 507.244px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09443);">function of policy 1:</div><div style="left: 554.231px; top: 507.244px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 562.165px; top: 513.045px; font-size: 9.60614px; font-family: sans-serif;">1</div><div style="left: 568.447px; top: 507.244px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 573.736px; top: 507.244px; font-size: 13.723px; font-family: sans-serif;">s</div><div data-canvas-width="21.327664161982803" style="left: 580.183px; top: 507.244px; font-size: 13.723px; font-family: serif; transform: scaleX(1.35531);">) =</div><div style="left: 606.63px; top: 507.244px; font-size: 13.723px; font-family: sans-serif;">φ</div><div style="left: 614.729px; top: 507.244px; font-size: 13.723px; font-family: serif;">(</div><div style="left: 620.018px; top: 507.244px; font-size: 13.723px; font-family: sans-serif;">s</div><div style="left: 626.465px; top: 507.244px; font-size: 13.723px; font-family: serif;">)</div><div style="left: 631.754px; top: 505.814px; font-size: 9.60614px; font-family: sans-serif;">T</div><div style="left: 640.515px; top: 507.244px; font-size: 13.723px; font-family: sans-serif;">θ</div><div style="left: 646.961px; top: 513.045px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="44.62778596057878" style="left: 653.077px; top: 507.244px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1053);">, where</div><div style="left: 703.161px; top: 507.244px; font-size: 13.723px; font-family: sans-serif;">s</div><div data-canvas-width="30.923807135881944" style="left: 714.897px; top: 507.244px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06779);">(only</div><div data-canvas-width="19.01043305288153" style="left: 423.483px; top: 523.608px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13418);">the</div><div style="left: 446.79px; top: 523.608px; font-size: 13.723px; font-family: sans-serif;">ω</div><div data-canvas-width="285.6172287488384" style="left: 460.178px; top: 523.608px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08789);">is shown) takes the states in 100 episodes of the</div><div data-canvas-width="187.10121377028395" style="left: 423.483px; top: 540.137px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11346);">samples. For most trajectories,</div><div style="left: 615.059px; top: 540.137px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 622.993px; top: 545.938px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="69.89697470502995" style="left: 633.903px; top: 540.137px; font-size: 13.723px; font-family: serif; transform: scaleX(1.07309);">increases as</div><div style="left: 708.451px; top: 540.137px; font-size: 13.723px; font-family: sans-serif;">|</div><div style="left: 712.253px; top: 540.137px; font-size: 13.723px; font-family: sans-serif;">ω</div><div style="left: 721.344px; top: 540.137px; font-size: 13.723px; font-family: sans-serif;">|</div><div data-canvas-width="16.19283476640413" style="left: 729.774px; top: 540.137px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06341);">re-</div><div data-canvas-width="302.67579683405813" style="left: 423.483px; top: 556.667px; font-size: 13.723px; font-family: serif; transform: scaleX(1.122);">duces. Thus action selection through maximizing</div><div style="left: 731.591px; top: 556.667px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 739.525px; top: 562.468px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="322.3420043690396" style="left: 423.483px; top: 573.031px; font-size: 13.723px; font-family: serif; transform: scaleX(1.16333);">has the effect of balancing the bicycle. That on the</div><div data-canvas-width="132.88570764484447" style="left: 423.483px; top: 589.56px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09025);">few trajectories where</div><div style="left: 561.172px; top: 589.56px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 569.107px; top: 595.361px; font-size: 9.60614px; font-family: sans-serif;">1</div><div data-canvas-width="120.81496285944" style="left: 580.347px; top: 589.56px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10497);">does not increase as</div><div style="left: 705.971px; top: 589.56px; font-size: 13.723px; font-family: sans-serif;">|</div><div style="left: 709.773px; top: 589.56px; font-size: 13.723px; font-family: sans-serif;">ω</div><div style="left: 718.864px; top: 589.56px; font-size: 13.723px; font-family: sans-serif;">|</div><div data-canvas-width="18.343132541399576" style="left: 727.459px; top: 589.56px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04708);">de-</div><div data-canvas-width="322.3230545136385" style="left: 423.483px; top: 606.09px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10163);">creases is because the value function also depends on</div><div data-canvas-width="256.716111081607" style="left: 423.483px; top: 622.454px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11377);">other factors such as the angle to the goal.</div><div data-canvas-width="38.854874193484314" style="left: 423.483px; top: 647.248px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div data-canvas-width="13.884703685048647" style="left: 468.444px; top: 647.248px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">12</div><div data-canvas-width="67.1322869896055" style="left: 488.279px; top: 647.248px; font-size: 13.723px; font-family: serif; transform: scaleX(1.13668);">and Figure</div><div data-canvas-width="13.884737306516824" style="left: 561.504px; top: 647.248px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">13</div><div data-canvas-width="164.3364567645176" style="left: 581.505px; top: 647.248px; font-size: 13.723px; font-family: serif; transform: scaleX(1.1232);">show the value function of</div><div data-canvas-width="322.35076177344007" style="left: 423.484px; top: 663.611px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09443);">policy 2 versus the sampled back tyre positions of the</div><div data-canvas-width="322.37561295127375" style="left: 423.484px; top: 680.141px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14029);">bicycle on the domain. The left and right plots used</div><div data-canvas-width="322.47890991705646" style="left: 423.484px; top: 696.67px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14852);">the same colors and markers for values of the same</div><div data-canvas-width="322.28761736267313" style="left: 423.484px; top: 713.034px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10872);">states from samples, so there is a correspondence be-</div><div data-canvas-width="322.33190670313326" style="left: 423.484px; top: 729.564px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11848);">tween the two plots. For example, the largest values,</div><div data-canvas-width="322.5272585626306" style="left: 423.484px; top: 745.928px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11365);">on the top of both plots, corresponds to two episodes</div><div data-canvas-width="92.87735442004094" style="left: 423.484px; top: 762.458px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10796);">of states whose</div><div style="left: 521.834px; top: 762.458px; font-size: 13.723px; font-family: sans-serif;">x</div><div style="left: 529.603px; top: 767.97px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="119.03011534816979" style="left: 540.842px; top: 762.458px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10786);">is non-negative and</div><div style="left: 665.474px; top: 762.458px; font-size: 13.723px; font-family: sans-serif;">y</div><div style="left: 672.251px; top: 767.97px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="62.47096109482252" style="left: 683.326px; top: 762.458px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11531);">close to 0.</div><div data-canvas-width="38.854874193484314" style="left: 423.484px; top: 778.987px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08471);">Figure</div><div data-canvas-width="13.884703685048647" style="left: 467.452px; top: 778.987px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">12</div><div data-canvas-width="65.29153398923542" style="left: 486.461px; top: 778.987px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11973);">shows that</div><div style="left: 557.041px; top: 778.987px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 564.975px; top: 784.788px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="129.4101078588303" style="left: 576.546px; top: 778.987px; font-size: 13.723px; font-family: serif; transform: scaleX(1.08196);">generally increases as</div><div style="left: 711.095px; top: 778.987px; font-size: 13.723px; font-family: sans-serif;">x</div><div style="left: 718.864px; top: 784.5px; font-size: 9.60614px; font-family: sans-serif;">b</div><div data-canvas-width="16.038135941491518" style="left: 729.773px; top: 778.987px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05232);">in-</div><div data-canvas-width="90.07339230118046" style="left: 423.483px; top: 795.351px; font-size: 13.723px; font-family: serif; transform: scaleX(1.09463);">creases. Figure</div><div data-canvas-width="13.884703685048647" style="left: 517.866px; top: 795.351px; font-size: 13.723px; font-family: serif; transform: scaleX(1.01201);">13</div><div data-canvas-width="35.033425336184436" style="left: 536.049px; top: 795.351px; font-size: 13.723px; font-family: serif; transform: scaleX(1.02119);">shows</div><div style="left: 575.224px; top: 795.351px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 583.158px; top: 801.152px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="127.75750977509502" style="left: 593.902px; top: 795.351px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06814);">generally increases as</div><div style="left: 725.971px; top: 795.351px; font-size: 13.723px; font-family: sans-serif;">|</div><div style="left: 729.773px; top: 795.351px; font-size: 13.723px; font-family: sans-serif;">y</div><div style="left: 736.55px; top: 800.864px; font-size: 9.60614px; font-family: sans-serif;">b</div><div style="left: 742.005px; top: 795.351px; font-size: 13.723px; font-family: sans-serif;">|</div><div data-canvas-width="59.15268053605846" style="left: 423.483px; top: 811.881px; font-size: 13.723px; font-family: serif; transform: scaleX(1.05658);">decreases.</div><div style="left: 490.428px; top: 810.74px; font-size: 9.60614px; font-family: sans-serif;">3</div><div data-canvas-width="241.50635886396367" style="left: 504.478px; top: 811.881px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10427);">Thus action selection through maximiz-</div><div data-canvas-width="18.35678834669852" style="left: 423.484px; top: 828.41px; font-size: 13.723px; font-family: serif; transform: scaleX(1.04706);">ing</div><div style="left: 446.79px; top: 828.41px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 454.724px; top: 834.211px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="279.694246378356" style="left: 466.13px; top: 828.41px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11006);">has the effect of pushing the bicycle along the</div><div data-canvas-width="143.50326326054514" style="left: 423.483px; top: 844.774px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10446);">positive direction in the</div><div style="left: 571.752px; top: 844.774px; font-size: 13.723px; font-family: sans-serif;">x</div><div data-canvas-width="166.28934423650338" style="left: 579.521px; top: 844.774px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11356);">-axis. The balancing aspect</div><div data-canvas-width="322.55258372082733" style="left: 423.483px; top: 861.303px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10353);">of policy 2 is similar to policy 1, and thus not shown.</div><div data-canvas-width="78.35242195522508" style="left: 423.483px; top: 877.667px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10578);">The shape of</div><div style="left: 506.626px; top: 877.667px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 514.561px; top: 883.469px; font-size: 9.60614px; font-family: sans-serif;">3</div><div data-canvas-width="71.57417422084409" style="left: 525.635px; top: 877.667px; font-size: 13.723px; font-family: serif; transform: scaleX(1.10474);">is similar to</div><div style="left: 602.001px; top: 877.667px; font-size: 13.723px; font-family: sans-serif;">V</div><div style="left: 609.935px; top: 883.469px; font-size: 9.60614px; font-family: sans-serif;">2</div><div data-canvas-width="129.77445930436025" style="left: 616.217px; top: 877.667px; font-size: 13.723px; font-family: serif; transform: scaleX(1.14666);">, and thus omitted as</div><div data-canvas-width="27.108493277080036" style="left: 423.484px; top: 894.197px; font-size: 13.723px; font-family: serif; transform: scaleX(1.00211);">well.</div><div data-canvas-width="322.5128048993073" style="left: 423.484px; top: 918.826px; font-size: 13.723px; font-family: serif; transform: scaleX(1.06026);">Off-policy learning on complex control problems is ex-</div><div data-canvas-width="322.3603827006509" style="left: 423.484px; top: 935.355px; font-size: 13.723px; font-family: serif; transform: scaleX(1.11328);">clusively important because on-policy learning is of-</div><div style="left: 440.674px; top: 960.421px; font-size: 8.23382px; font-family: sans-serif;">3</div><div data-canvas-width="299.30345407895646" style="left: 446.294px; top: 962.005px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.12331);">Again there are exceptions for some episodes because</div><div data-canvas-width="195.54453364974614" style="left: 423.483px; top: 975.725px; font-size: 12.3507px; font-family: serif; transform: scaleX(1.127);">of the dependence on other factors.</div></div><div class="annotationLayer"><section class="annotLink" data-annotation-id="192" style="width: 7.032px; height: 8.352px; left: 356.484px; top: 230.844px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -356.484px -230.844px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#equation.4.1" class="internalLink"></a></section><section class="annotLink" data-annotation-id="193" style="width: 11.952px; height: 8.472px; left: 340.284px; top: 248.724px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -340.284px -248.724px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.10" class="internalLink"></a></section><section class="annotLink" data-annotation-id="194" style="width: 7.032px; height: 8.472px; left: 427.404px; top: 308.484px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -427.404px -308.484px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#equation.4.1" class="internalLink"></a></section><section class="annotLink" data-annotation-id="195" style="width: 11.952px; height: 8.352px; left: 420.804px; top: 356.364px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -420.804px -356.364px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.11" class="internalLink"></a></section><section class="annotLink" data-annotation-id="196" style="width: 11.952px; height: 8.472px; left: 339.084px; top: 469.884px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -339.084px -469.884px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.12" class="internalLink"></a></section><section class="annotLink" data-annotation-id="197" style="width: 11.952px; height: 8.472px; left: 406.644px; top: 469.884px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -406.644px -469.884px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.13" class="internalLink"></a></section><section class="annotLink" data-annotation-id="198" style="width: 11.952px; height: 8.472px; left: 338.364px; top: 565.524px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -338.364px -565.524px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.12" class="internalLink"></a></section><section class="annotLink" data-annotation-id="199" style="width: 11.952px; height: 8.352px; left: 374.964px; top: 577.524px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -374.964px -577.524px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#figure.13" class="internalLink"></a></section><section class="annotLink" data-annotation-id="200" style="width: 5.436px; height: 10.959px; left: 355.044px; top: 586.917px; position: absolute; transform: matrix(1.37745, 0, 0, 1.37745, 0, 0); transform-origin: -355.044px -586.917px 0px;"><a title="" href="http://docplayer.net/docview/55/37218908/#Hfootnote.3" class="internalLink"></a></section></div></div><div id="pageContainer8" class="page" data-page-number="8" style="width: 843px; height: 1090px;"><div class="loadingIcon"></div></div><div id="pageContainer9" class="page" data-page-number="9" style="width: 843px; height: 1090px;"><div class="loadingIcon"></div></div></div>
        </div>

        <div id="errorWrapper" hidden="true">
          <div id="errorMessageLeft">
            <span id="errorMessage"></span>
            <button id="errorShowMore" data-l10n-id="error_more_info">More Information</button>
            <button id="errorShowLess" data-l10n-id="error_less_info" hidden="true">Less Information</button>
          </div>
          <div id="errorMessageRight">
            <button id="errorClose" data-l10n-id="error_close">Close</button>
          </div>
          <div class="clearBoth"></div>
          <textarea id="errorMoreInfo" hidden="true" readonly="readonly"></textarea>
        </div>
      </div> <!-- mainContainer -->

      <div id="overlayContainer" class="hidden">
        <div id="passwordOverlay" class="container hidden">
          <div class="dialog">
            <div class="row">
              <p id="passwordText" data-l10n-id="password_label">Enter the password to open this PDF file.</p>
            </div>
            <div class="row">
              <input type="password" id="password" class="toolbarField">
            </div>
            <div class="buttonRow">
              <button id="passwordCancel" class="overlayButton"><span data-l10n-id="password_cancel">Cancel</span></button>
              <button id="passwordSubmit" class="overlayButton"><span data-l10n-id="password_ok">OK</span></button>
            </div>
          </div>
        </div>
        <div id="documentPropertiesOverlay" class="container hidden">
          <div class="dialog">
            <div class="row">
              <span data-l10n-id="document_properties_file_name">File name:</span> <p id="fileNameField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_file_size">File size:</span> <p id="fileSizeField">-</p>
            </div>
            <div class="separator"></div>
            <div class="row">
              <span data-l10n-id="document_properties_title">Title:</span> <p id="titleField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_author">Author:</span> <p id="authorField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_subject">Subject:</span> <p id="subjectField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_keywords">Keywords:</span> <p id="keywordsField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_creation_date">Creation Date:</span> <p id="creationDateField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_modification_date">Modification Date:</span> <p id="modificationDateField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_creator">Creator:</span> <p id="creatorField">-</p>
            </div>
            <div class="separator"></div>
            <div class="row">
              <span data-l10n-id="document_properties_producer">PDF Producer:</span> <p id="producerField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_version">PDF Version:</span> <p id="versionField">-</p>
            </div>
            <div class="row">
              <span data-l10n-id="document_properties_page_count">Page Count:</span> <p id="pageCountField">-</p>
            </div>
            <div class="buttonRow">
              <button id="documentPropertiesClose" class="overlayButton"><span data-l10n-id="document_properties_close">Close</span></button>
            </div>
          </div>
        </div>
      </div>  <!-- overlayContainer -->

    </div> <!-- outerContainer -->
    <div id="printContainer"></div>
<div id="mozPrintCallback-shim" hidden="">
  <style>
@media print {
  #printContainer div {
    page-break-after: always;
    page-break-inside: avoid;
  }
}
  </style>
  <style scoped="">
#mozPrintCallback-shim {
  position: fixed;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  z-index: 9999999;

  display: block;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.5);
}
#mozPrintCallback-shim[hidden] {
  display: none;
}
@media print {
  #mozPrintCallback-shim {
    display: none;
  }
}

#mozPrintCallback-shim .mozPrintCallback-dialog-box {
  display: inline-block;
  margin: -50px auto 0;
  position: relative;
  top: 45%;
  left: 0;
  min-width: 220px;
  max-width: 400px;

  padding: 9px;

  border: 1px solid hsla(0, 0%, 0%, .5);
  border-radius: 2px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);

  background-color: #474747;

  color: hsl(0, 0%, 85%);
  font-size: 16px;
  line-height: 20px;
}
#mozPrintCallback-shim .progress-row {
  clear: both;
  padding: 1em 0;
}
#mozPrintCallback-shim progress {
  width: 100%;
}
#mozPrintCallback-shim .relative-progress {
  clear: both;
  float: right;
}
#mozPrintCallback-shim .progress-actions {
  clear: both;
}
  </style>
  <div class="mozPrintCallback-dialog-box">
    <!-- TODO: Localise the following strings -->
    Preparing document for printing...
    <div class="progress-row">
      <progress value="0" max="100"></progress>
      <span class="relative-progress">0%</span>
    </div>
    <div class="progress-actions">
      <input type="button" value="Cancel" class="mozPrintCallback-cancel">
    </div>
  </div>
</div>
<script>
    function getPageSize() {
        var xScroll, yScroll, pageHeight, pageWidth;

        if (window.innerHeight && window.scrollMaxY) {
            xScroll = document.body.scrollWidth;
            yScroll = window.innerHeight + window.scrollMaxY;
        } else if (document.body.scrollHeight > document.body.offsetHeight){
            xScroll = document.body.scrollWidth;
            yScroll = document.body.scrollHeight;
        } else if (document.documentElement && document.documentElement.scrollHeight > document.documentElement.offsetHeight){
            xScroll = document.documentElement.scrollWidth;
            yScroll = document.documentElement.scrollHeight;
        } else {
            if (typeof(document.body.offsetWidth)=='undefined' || typeof(document.body.offsetHeight)=='undefined') {
                xScroll = 0;
                yScroll = 0;
            } else {
                xScroll = document.body.offsetWidth;
                yScroll = document.body.offsetHeight;
            }
        }

        var windowWidth, windowHeight;
        if (self.innerHeight) {
            windowWidth = self.innerWidth;
            windowHeight = self.innerHeight;
        } else if (document.documentElement && document.documentElement.clientHeight) {
            windowWidth = document.documentElement.clientWidth;
            windowHeight = document.documentElement.clientHeight;
        } else if (document.body) {
            windowWidth = document.body.clientWidth;
            windowHeight = document.body.clientHeight;
        }

        if(yScroll < windowHeight){
            pageHeight = windowHeight;
        } else {
            pageHeight = yScroll;
        }

        if(xScroll < windowWidth){
            pageWidth = windowWidth;
        } else {
            pageWidth = xScroll;
        }

        return {
            pageWidth : pageWidth,
            pageHeight : pageHeight,
            windowWidth : windowWidth,
            windowHeight : windowHeight
        };
    };

    var offset = function (element){
        var body = document.body,
                win = document.defaultView,
                docElem = document.documentElement,
                box = document.createElement('div');
        box.style.paddingLeft = box.style.width = "1px";
        body.appendChild(box);
        var isBoxModel = box.offsetWidth == 2;
        body.removeChild(box);
        box = element.getBoundingClientRect();
        var clientTop  = docElem.clientTop  || body.clientTop  || 0,
                clientLeft = docElem.clientLeft || body.clientLeft || 0,
                scrollTop  = win.pageYOffset || isBoxModel && docElem.scrollTop  || body.scrollTop,
                scrollLeft = win.pageXOffset || isBoxModel && docElem.scrollLeft || body.scrollLeft;
        return {
            top : box.top  + scrollTop  - clientTop,
            left: box.left + scrollLeft - clientLeft};
    };


var doc_ads = {
    page_size: null,

    ads: ['9574338674', '6481271478', '4864937476', '9295137074', '3248603470'],


    init : function() {
        if (document.domain.toString()=='docplayer.ru') {
            return;
        }
        doc_ads.wait_active_view_page(2, doc_ads.show_banner_between_pages);
        doc_ads.wait_active_view_page(3, doc_ads.show_banner_between_pages);
        doc_ads.wait_active_view_page(4, doc_ads.show_banner_between_pages);
        doc_ads.wait_active_view_page(5, doc_ads.show_banner_between_pages);
        doc_ads.wait_active_view_page(6, doc_ads.show_banner_between_pages);
        setInterval(function(){
            doc_ads.page_size = getPageSize();
        }, 1000);
    },

    create_ad_block : function(max_width, marginTop){
        var script_tag = document.createElement('script');
        var script_code = document.createElement('script');
        var div = document.createElement('div');
        var prov_banner_id = doc_ads.ads.shift();
//            div.setAttribute('id', service.mapper('to_place_', place_id));
        div.style.verticalAlign = 'top';
        div.style.textAlign = 'center';
        div.style.width = '100%';
        if (marginTop) {
            div.style.marginTop = marginTop;
        }

//            var label;
        var tag_ins = document.createElement('ins');
        script_tag.type = 'text/javascript';
        script_code.type = 'text/javascript';
        script_tag.src = '//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
        script_code.text = '(adsbygoogle = window.adsbygoogle || []).push({});';

        tag_ins.style.display = 'block';

        if (typeof(tag_ins.className)=='undefined') {
            window.onerror("browser not support .className", '[system]');
        }
        if (typeof(tag_ins.setAttribute)=='undefined') {
            window.onerror("browser not support .setAttribute", '[system]');
        }
        tag_ins.className = 'adsbygoogle';
        tag_ins.setAttribute('data-ad-client', 'ca-pub-8693394182295906');
        tag_ins.setAttribute('data-ad-slot', prov_banner_id);
        tag_ins.setAttribute('data-ad-format', 'auto');
        div.appendChild(script_tag);
        div.appendChild(tag_ins);
        div.appendChild(script_code);
        div.style.zIndex = 1000;
        return div;
    },

    show_banner_between_pages: function(page_num) {
        var page_obj = document.getElementById('pageContainer'+page_num);
        var div = doc_ads.create_ad_block('100%', '10px');
        var parent_obj = page_obj.parentNode;
        parent_obj.insertBefore(div, page_obj);
//        console.log('show_banner_between_pages before: '+page_num);
    },

    wait_active_view_page : function(page_num, callback) {
        var next = function(){
            setTimeout(function() {
                doc_ads.wait_active_view_page(page_num, callback)
            }, 100);
        };
        var obj = document.getElementById('pageContainer'+page_num);
        if (! obj) {
            next();
            return;
        }
        var distance = Math.abs(offset(obj).top);
//        console.log(distance);
        if (distance - doc_ads.page_size.windowHeight > doc_ads.page_size.windowHeight) {
            next();
            return;
        }
        callback(page_num);
    }
};
    doc_ads.page_size = getPageSize();
    doc_ads.init();

</script>
  


<input id="fileInput" class="fileInput" type="file"></body></html>